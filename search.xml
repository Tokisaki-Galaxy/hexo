<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>DLL Proxy 项目详解：高兼容性 version.dll 劫持与隐匿型 Payload 启动器</title>
      <link href="/blog/dll-proxy/"/>
      <url>/blog/dll-proxy/</url>
      
        <content type="html"><![CDATA[<div class="note note-error">            <p>该项目可能涉及安全研究和渗透测试等敏感领域，请确保在合法授权的环境中使用。未经授权的使用可能违反法律法规。</p>           </div><h2 id="项目简介"><a href="#项目简介" class="headerlink" title="项目简介"></a>项目简介</h2><p><a href="https://github.com/Tokisaki-Galaxy/dll-proxy">项目链接</a></p><p>本项目使用C语言开发高度兼容的 version.dll 劫持用动态链接库（DLL Proxy）。核心目标如下：</p><ul><li><strong>无缝转发</strong>：所有标准 version.dll API 调用均透明转发到系统原版 DLL。</li><li><strong>隐匿触发</strong>：DLL 加载时异步启动线程，解密并执行隐藏 Payload（如启动系统计算器）。</li></ul><p>适用平台为 Windows 7&#x2F;8&#x2F;10&#x2F;11 x64，兼顾兼容性、隐匿性与体积控制。适合安全研究、渗透测试等场景。</p><h2 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h2><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs text">.<br>├── .gitignore<br>├── build.bat<br>├── LICENSE<br>├── README.md<br>├── .github/<br>│   └── workflows/<br>│       ├── build.yml<br>│       └── copilot-setup-steps.yml<br>└── src/<br>    ├── proxy.c<br>    ├── version.rc<br>    └── vm_engine.h<br></code></pre></td></tr></table></figure><ul><li><code>proxy.c</code>：主代理逻辑，实现 API 转发与 Payload 启动</li><li><code>vm_engine.h</code>：虚拟机引擎，用于动态生成&#x2F;还原加密命令字符串</li><li><code>version.rc</code>：资源脚本，伪装 DLL 版本信息</li><li><code>build.bat</code>：本地构建脚本</li><li><code>build.yml</code>：GitHub Actions 自动化构建与打包</li><li><code>README.md</code>：详细设计文档</li></ul><h2 id="核心功能与实现细节"><a href="#核心功能与实现细节" class="headerlink" title="核心功能与实现细节"></a>核心功能与实现细节</h2><h3 id="1-绝对路径-API-转发"><a href="#1-绝对路径-API-转发" class="headerlink" title="1. 绝对路径 API 转发"></a>1. 绝对路径 API 转发</h3><p>通过 <code>#pragma comment(linker, &quot;/export:...&quot;)</code>，将 17 个标准 version.dll 导出函数全部转发到系统目录下原版 DLL。<br>采用绝对路径，避免再次被劫持，提升兼容性和稳定性。</p><h3 id="2-字符串难读化与动态还原"><a href="#2-字符串难读化与动态还原" class="headerlink" title="2. 字符串难读化与动态还原"></a>2. 字符串难读化与动态还原</h3><p>避免明文存储 “calc.exe” 字符串，避免对抗时通过 strings 或类似工具直接发现。通过自定义虚拟机（见 <code>vm_engine.h</code>）动态生成命令。<br>字节码运行时还原目标命令，避免静态分析直接发现敏感字符串。</p><h3 id="3-异步-Payload-启动"><a href="#3-异步-Payload-启动" class="headerlink" title="3. 异步 Payload 启动"></a>3. 异步 Payload 启动</h3><p>在 DllMain 的 DLL_PROCESS_ATTACH 阶段，立即用 CreateThread 启动新线程，避免 Loader Lock 和主线程阻塞。<br>新线程中调用 CreateProcessW 启动计算器，命令行参数由虚拟机还原。<br>命令使用后，调用 SecureWipe 和 SecureZeroMemory 立即清除内存，防止敏感数据残留。</p><h3 id="4-资源伪装与体积控制"><a href="#4-资源伪装与体积控制" class="headerlink" title="4. 资源伪装与体积控制"></a>4. 资源伪装与体积控制</h3><p><code>version.rc</code> 仿造微软官方 version.dll 的资源描述，提升伪装性。<br>构建参数优化，关闭调试符号，启用链接器优化，确保 DLL 体积小于 50KB。</p><h2 id="构建与自动化"><a href="#构建与自动化" class="headerlink" title="构建与自动化"></a>构建与自动化</h2><h3 id="本地构建"><a href="#本地构建" class="headerlink" title="本地构建"></a>本地构建</h3><p>直接运行 <code>build.bat</code>：</p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bat">rc.exe /v src/version.rc<br>cl.exe /c /O1 /GL /GS- /MT src/proxy.c /Fo:proxy.obj<br>link.exe /DLL /OUT:version.dll /ENTRY:DllMain /NODEFAULTLIB /SUBSYSTEM:WINDOWS ^<br>/LTCG /OPT:REF /OPT:ICF ^<br>proxy.obj src/version.res kernel32.lib user32.lib<br></code></pre></td></tr></table></figure><h3 id="CI-CD-自动化"><a href="#CI-CD-自动化" class="headerlink" title="CI&#x2F;CD 自动化"></a>CI&#x2F;CD 自动化</h3><p><code>build.yml</code> 支持主分支和 Tag 自动构建、打包、发布 Release。<br>自动 strip 符号、打包 zip 并上传 Release。</p><h2 id="关键代码片段"><a href="#关键代码片段" class="headerlink" title="关键代码片段"></a>关键代码片段</h2><p><strong>API 转发声明：</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">pragma</span> comment(linker, <span class="hljs-string">&quot;/export:GetFileVersionInfoA=C:\\Windows\\System32\\version.GetFileVersionInfoA,@1&quot;</span>)</span><br><span class="hljs-comment">// ...其余16个API同理...</span><br></code></pre></td></tr></table></figure><p><strong>虚拟机动态还原命令：</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">static</span> <span class="hljs-type">void</span> <span class="hljs-title function_">ExecuteVM</span><span class="hljs-params">(WCHAR* output)</span> &#123;<br>    <span class="hljs-comment">// ...虚拟机解释字节码，动态生成 &quot;calc.exe&quot; ...</span><br>&#125;<br></code></pre></td></tr></table></figure><p><strong>异步 Payload 启动与内存擦除：</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c">DWORD WINAPI <span class="hljs-title function_">ExecutePayload</span><span class="hljs-params">(LPVOID lpParam)</span> &#123;<br>    WCHAR command[<span class="hljs-number">64</span>];<br>    ExecuteVM(command);<br>    <span class="hljs-comment">// ...CreateProcessW 启动 calc.exe...</span><br>    SecureWipe(command, <span class="hljs-keyword">sizeof</span>(command));<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>本项目通过 DLL Proxy 技术，实现了对系统 version.dll 的无缝转发，并集成隐匿型 Payload 启动机制。设计兼顾兼容性、隐匿性与安全性，适合安全研究、红队测试等场景。详细设计与实现细节请参考 README.md 及源码注释。</p>]]></content>
      
      
      
        <tags>
            
            <tag> DLL Proxy </tag>
            
            <tag> Windows </tag>
            
            <tag> 安全研究 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>自动化开发模板仓库：Github Actions 与高效项目模版实践</title>
      <link href="/blog/template-github/"/>
      <url>/blog/template-github/</url>
      
        <content type="html"><![CDATA[<div class="note note-info">            <p>该项目所涉及Copilot Agent的自动化编程功能需要开启Github Copilot服务，并且可能会产生相关费用。</p>           </div><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>在现代软件学习与开发中，“环境配置”往往是消磨开发热情的元凶。最近我沉迷于 <strong>Github Actions</strong>，利用云端工具直接构建、测试和部署项目，彻底告别了在本地电脑反复折腾环境的痛苦。通过简单的 <code>.yml</code> 工作流配置，我可以针对不同的系统、不同的编译器版本进行构建，实现真正的“环境无关”。相比以往安装一个依赖库就要耗费半天，Actions 提供的纯净、隔离且即用即走的运行环境，确保了每次构建都是从零开始，完全规避了历史遗留问题引发的“玄学 Bug”。</p><p>不仅如此，结合当下流行的 <strong>Vibe Coding</strong> 模式，我通过预设 <code>copilot-setup-steps.yml</code> 和 <code>copilot-instructions.md</code>，让 Github Copilot Agent 在云端实现全自动编程。这种“开箱即用”的体验，意味着我只需要清晰地描述需求，剩下的代码实现、单元测试、甚至是多平台部署，都可以放心地交给 AI Agent 和自动化流水线去完成。</p><p>即使面对一些不熟悉的高性能语言或框架，我也不再有“心理负担”。借助于这套自动化链路，我能跳过繁琐的本地搭建过程，直接进入核心逻辑的开发，开发效率得到了量级提升。为了方便自己和大家快速开启新项目，我将常用的开发环境封装成了几个通用的 <strong>项目模版</strong>。</p><hr><h2 id="核心原理"><a href="#核心原理" class="headerlink" title="核心原理"></a>核心原理</h2><h3 id="1-Github-Actions：云端的“执行肌肉”"><a href="#1-Github-Actions：云端的“执行肌肉”" class="headerlink" title="1. Github Actions：云端的“执行肌肉”"></a>1. Github Actions：云端的“执行肌肉”</h3><p>Github Actions 允许我们将开发工作流（Workflow）代码化。无论是代码推送（Push）、发起 PR，还是定时任务，都能触发预设的任务序列。其强大的生态插件（Actions Marketplace）让你可以像搭积木一样，轻松实现从“交叉编译 Rust”到“自动化 UI 测试”的复杂操作。</p><h3 id="2-Github-Copilot-Agent：云端的“调度大脑”"><a href="#2-Github-Copilot-Agent：云端的“调度大脑”" class="headerlink" title="2. Github Copilot Agent：云端的“调度大脑”"></a>2. Github Copilot Agent：云端的“调度大脑”</h3><p>如果说 Actions 是执行者，那么 <strong>Github Copilot Agent</strong> 就是大脑。通过在项目中配置引导文件，我们可以：</p><ul><li><strong>定制 Agent 环境</strong>：预装特定版本的编译器（如 Zig&#x2F;Rust）或特定的 CLI 工具。</li><li><strong>注入领域知识</strong>：通过指令文件告知 AI 你的架构偏好、注释风格以及必须通过的测试标准。<br>这种“AI 编排 + CI&#x2F;CD 执行”的组合，让AI自动化从简单的“尝试理解”进化到了“编写-&gt;测试闭环”的层面。</li></ul><hr><h2 id="项目模版推荐"><a href="#项目模版推荐" class="headerlink" title="项目模版推荐"></a>项目模版推荐</h2><p>以下模版均集成了 CI&#x2F;CD 流程以及通过tag推送一键构建Release。为了保持长期演进，模版中默认包含 <code>sync-template.yml</code> 以实现与上游仓库同步。如果你希望项目完全独立，可以直接删除该文件。</p><div class="note note-info">            <p>由于个人目前没有 MacOS 的开发需求，这些模版对 MacOS 的适配优先级较低，部分模版可能暂不支持 MacOS 环境。</p>           </div><h3 id="1-Zig-项目模版：高性能开发的先锋"><a href="#1-Zig-项目模版：高性能开发的先锋" class="headerlink" title="1. Zig 项目模版：高性能开发的先锋"></a>1. Zig 项目模版：高性能开发的先锋</h3><p><a href="https://github.com/Tokisaki-Galaxy/zig-template">zig-template</a> </p><ul><li><strong>核心逻辑</strong>：针对 Zig 语言精巧的构建系统（build.zig）进行优化，支持跨平台交叉编译。</li><li><strong>自动化优势</strong>：内置自动化测试与静态分析。即便你本地没有安装 Zig 编译器，也可以通过云端 Action 验证代码的内存安全与性能表现。</li></ul><h3 id="2-Rust-项目模版：广范围平台-架构的全能选手"><a href="#2-Rust-项目模版：广范围平台-架构的全能选手" class="headerlink" title="2. Rust 项目模版：广范围平台&#x2F;架构的全能选手"></a>2. Rust 项目模版：广范围平台&#x2F;架构的全能选手</h3><p><a href="https://github.com/Tokisaki-Galaxy/rust-template">rust-template</a> </p><ul><li><strong>核心逻辑</strong>：深度集成 <code>cargo</code> &#x2F; <code>cross</code> 工具链，热门平台使用<code>cargo</code>，冷门平台使用<code>cross</code>。支持近乎所有架构&#x2F;平台的构建能力（包括riscv&#x2F;龙芯等平台）。</li><li><strong>自动化优势</strong>：Rust 的编译速度通常较慢，但在云端 Actions 中，模板使用缓存机制加速构建。</li></ul><p>示例项目：<br><a href="https://github.com/Tokisaki-Galaxy/webauthn-helper">webauthn-helper</a></p><h3 id="3-Web-前端模版：极速-Vibe-Coding-起点"><a href="#3-Web-前端模版：极速-Vibe-Coding-起点" class="headerlink" title="3. Web 前端模版：极速 Vibe Coding 起点"></a>3. Web 前端模版：极速 Vibe Coding 起点</h3><p><a href="https://github.com/Tokisaki-Galaxy/web-template">web-template</a> </p><ul><li><strong>核心逻辑</strong>：playwright + mock 的组合，赋予agent闭环检测能力，为构建现代 Web 应用设计。</li><li><strong>自动化优势</strong>：内置多环境配置（Dev&#x2F;Prod），支持一键部署至 GitHub Pages。由于配置了详尽的类型定义，Copilot Agent 在该模版下的代码生成准确率极高。</li></ul><h3 id="4-OpenWrt-插件模版：嵌入式开发的“降维打击”"><a href="#4-OpenWrt-插件模版：嵌入式开发的“降维打击”" class="headerlink" title="4. OpenWrt 插件模版：嵌入式开发的“降维打击”"></a>4. OpenWrt 插件模版：嵌入式开发的“降维打击”</h3><p><a href="https://github.com/Tokisaki-Galaxy/openwrt-template">openwrt-template</a> </p><ul><li><strong>核心逻辑</strong>：专为 LuCI 插件设计，支持 <strong>ucode&#x2F;Lua</strong> （注意，现在luci社区由Lua全面转向ucode）。包含了 OpenWrt 插件开发的标准目录结构和示例代码，极大降低了入门门槛。带有开发、构建、签名到发布全流程模板代码。在本地打完tag再推送之后，会自动发布Release并支持发布到自定义opkg源（Github Pages）。</li><li><strong>自动化Agent优势</strong>：集成了 <strong>Playwright + Docker</strong> 自动化 UI 测试。在 OpenWrt 极其碎片化的固件环境下，手动测试极其痛苦，而通过云端模拟环境，可以实现AI自主修改-&gt;调试。</li></ul><p>示例项目：<br><a href="https://github.com/tokisaki-galaxy/luci-app-tailscale-community">luci-app-tailscale-community</a><br><a href="https://github.com/tokisaki-galaxy/luci-app-2fa">luci-app-2fa</a><br><a href="https://github.com/tokisaki-galaxy/luci-app-webauthn">luci-app-webauthn</a></p><hr><h2 id="如何快速开始？"><a href="#如何快速开始？" class="headerlink" title="如何快速开始？"></a>如何快速开始？</h2><p>只需三步，即可开启你的自动化开发之旅：</p><ol><li><strong>Use this template</strong>：点击模版仓库右上角的绿色按钮，创建一个属于你的新仓库。</li><li><strong>唤醒 AI Agent</strong>：如果你想尝试“只写需求，不写代码”，确保已开启 Copilot 功能，在 GitHub 页面唤起 Copilot Agent 对话框，输入你的功能设想。Agent 会自动根据 <code>copilot-instructions.md</code> 开始构建代码。</li><li><strong>监控 Actions</strong>：每当你或 Agent 提交代码后，Github Actions 就会自动触发。你只需在 <code>Actions</code> 标签页观察绿色的对勾，剩下的交给云端。</li></ol><hr><p>自动化和vibe coding并不是为了“偷懒”，而是为了将有限的精力从重复的劳动中释放出来，投入到真正的核心逻辑和创造性工作中。</p>]]></content>
      
      
      
        <tags>
            
            <tag> CI/CD </tag>
            
            <tag> Github </tag>
            
            <tag> Agent </tag>
            
            <tag> Template </tag>
            
            <tag> vibe coding </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>现代化 LuCI 插件开发方案：AI Agent 集成 Playwright 和 Docker 全自动开发</title>
      <link href="/blog/openwrt-template/"/>
      <url>/blog/openwrt-template/</url>
      
        <content type="html"><![CDATA[<p>OpenWrt 的 LuCI 插件开发一直存在环境搭建复杂、UI 调试效率低、跨平台编译繁琐等问题，导致开发周期极长。</p><p>最近发现 GitHub Copilot 可以预装测试环境软件包，更改<code>copilot-instrument.md</code>来实现自定义agent行为，于是尝试将其与 Playwright 和 Docker 结合，打造了一套现代化的 LuCI 插件开发方案。</p><p>该方案集成 AI 辅助代码生成（playwright docker）、自动化 UI 测试和全自动 CI&#x2F;CD 构建发布流水线，大幅提升开发效率</p><p>已经成功运用于多个 LuCI 插件项目中，如 <a href="https://github.com/tokisaki-galaxy/luci-app-2fa">luci-app-2fa</a> 和 <a href="https://github.com/tokisaki-galaxy/luci-app-tailscale-community">luci-app-tailscale-community</a>。</p><h2 id="AI-辅助开发：让-Copilot-理解-OpenWrt"><a href="#AI-辅助开发：让-Copilot-理解-OpenWrt" class="headerlink" title="AI 辅助开发：让 Copilot 理解 OpenWrt"></a>AI 辅助开发：让 Copilot 理解 OpenWrt</h2><p>在编写 LuCI 后端代码（如 ucode 或 Lua）时，AI 生成内容容易出现理解偏差。通过在项目目录下配置 <code>copilot-instructions.md</code>，可以为 AI 预设一套开发规范。</p><p>这份指令集包括：</p><ul><li>全自动调试指令：告诉 AI 如何在 Docker 容器中编译、部署和测试插件。</li><li>服务启动顺序：明确 <code>ubusd</code>、<code>procd</code>、<code>rpcd</code>、<code>uhttpd</code> 的依赖关系，避免页面报错。</li><li>路径映射：帮助 AI 理解源码与 OpenWrt 文件系统（如 <code>/www/luci-static</code>）的对应关系。</li><li>开发规范：定义代码风格与openwrt&#x2F;luci类似、注释要求和最佳实践。</li></ul><h2 id="自动化-UI-测试：Playwright-Docker"><a href="#自动化-UI-测试：Playwright-Docker" class="headerlink" title="自动化 UI 测试：Playwright + Docker"></a>自动化 UI 测试：Playwright + Docker</h2><p>为了确保插件在不同 OpenWrt 版本下的 UI 渲染一致，引入 Playwright 进行端到端测试。通过 Docker 容器模拟完整的 LuCI 环境，Agent 可自动登录、截图并验证页面效果，大幅减少手动测试时间。</p><table><thead><tr><th>Login Page</th><th>2FA Verification</th><th>Invalid OTP</th></tr></thead><tbody><tr><td><img src="https://github.com/user-attachments/assets/7b8e4cfb-1f06-4c3f-b63a-1ba23a01be86" alt="login"></td><td><img src="https://github.com/user-attachments/assets/a95d879e-b404-423b-95ca-2230b696a243" alt="2fa"></td><td><img src="https://github.com/user-attachments/assets/56399325-ebfb-46c9-aeb4-f162e27b99ce" alt="error"></td></tr><tr><td><a href="https://github.com/Tokisaki-Galaxy/luci-app-2fa/pull/3">来源自 luci-app-2fa #3</a></td><td></td><td></td></tr></tbody></table><p>相关配置可在 <code>copilot-instructions.md</code> 中定义，适用于如 <code>luci-app-tailscale-community</code> 这类复杂应用。</p><h2 id="全自动-CI-CD-构建流水线"><a href="#全自动-CI-CD-构建流水线" class="headerlink" title="全自动 CI&#x2F;CD 构建流水线"></a>全自动 CI&#x2F;CD 构建流水线</h2><p>本项目模板内置 GitHub Actions 配置文件 <code>build.yml</code>，实现：</p><ul><li>多格式并行编译：同时支持 IPK 和 APK 格式。</li><li>动态版本管理：基于 Git Tag 或 Commit Hash 自动注入 <code>PKG_VERSION</code>。</li><li>自动签名与托管：构建后自动使用 <code>usign</code> 签名，并部署至 GitHub Pages，生成可直接用于 OpenWrt 的 OPKG 软件源。</li></ul><h2 id="快速开始"><a href="#快速开始" class="headerlink" title="快速开始"></a>快速开始</h2><p>你可以直接使用本模板快速创建项目：</p><p>👉 <a href="https://github.com/Tokisaki-Galaxy/openwrt-template">Tokisaki-Galaxy&#x2F;openwrt-template</a></p><p>核心配置文件：</p><ul><li>构建逻辑：<code>build.yml</code></li><li>AI 指令集：<code>copilot-instructions.md</code></li><li>测试 Mock：<code>handlers.js</code></li></ul><p>通过结合 AI Agent 的生成能力与端到端测试的验证能力，LuCI 插件的开发协作与分发效率将显著提升。欢迎在 GitHub Discussion 参与交流。</p><h2 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h2><ul><li><a href="https://github.com/tokisaki-galaxy/luci-app-2fa">luci-app-2fa</a></li><li><a href="https://github.com/tokisaki-galaxy/luci-app-tailscale-community">luci-app-tailscale-community</a></li></ul><h3 id="PR-示例"><a href="#PR-示例" class="headerlink" title="PR 示例"></a>PR 示例</h3><ul><li><a href="https://github.com/Tokisaki-Galaxy/luci-app-2fa/pull/3">Integrate 2FA verification into LuCI login flow #3</a></li><li><a href="https://github.com/Tokisaki-Galaxy/luci-app-2fa/pull/4">Add LuCI auth plugin mechanism for 2FA login enforcement #4</a></li><li><a href="https://github.com/Tokisaki-Galaxy/luci-app-2fa/pull/1">feat: Revive luci-app-2fa from openwrt&#x2F;luci PR #7069 #1</a></li></ul><h2 id="技术细节"><a href="#技术细节" class="headerlink" title="技术细节"></a>技术细节</h2><ul><li>SDK 环境：基于 <code>openwrt/rootfs:x86-64-23.05.5</code> 镜像</li><li>主要工具：ucode、ubus、rpcd、Playwright</li></ul>]]></content>
      
      
      <categories>
          
          <category> openwrt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> openwrt </tag>
            
            <tag> luci </tag>
            
            <tag> github-copilot </tag>
            
            <tag> playwright </tag>
            
            <tag> agent </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>基于大语言模型的 Hexo 博客自动化翻译方案</title>
      <link href="/blog/hexo-translate-llm/"/>
      <url>/blog/hexo-translate-llm/</url>
      
        <content type="html"><![CDATA[<div class="note note-success">            <p>该项目已在 GitHub 开源。您可以访问 <a href="https://github.com/Tokisaki-Galaxy/hexo-translate-llm">Tokisaki-Galaxy&#x2F;hexo-translate-llm</a> 获取更多信息。</p>           </div><p>跨语言的信息传播在数字化时代愈发重要。手动翻译文章不仅耗时，也难以保证更新频率。<strong>Hexo LLM Translate</strong> 插件为此提供了自动化解决方案。它利用大语言模型（LLM）实现博客内容的高质量翻译。</p><h2 id="核心特性"><a href="#核心特性" class="headerlink" title="核心特性"></a>核心特性</h2><p>智能双语切换提升了读者的阅读体验。插件会识别浏览器的语言偏好。读者无需手动点击即可阅读对应版本。</p><p>缓存机制保障了翻译效率。插件通过内容哈希识别变更。只有在正文或标题变动时才会触发接口调用。这有效降低了 API 的使用成本。</p><p>多端同步支持远程数据库。通过 <strong>Neon PostgreSQL</strong>，不同设备间的构建缓存可以实时共享。（可选）</p><p>稳定性是插件设计的核心。内置限流器防止并发过高导致接口熔断。自动重试机制能有效应对网络波动。</p><p>SEO 优化确保了搜索权重的留存。翻译后的内容直接注入 HTML 结构。搜索引擎可以完整抓取双语信息。Hexo 特有的标签也得到了妥善保护，避免了页面结构的破坏。</p><p>对于不想被翻译的文章，可以通过 Front-matter 设置 <code>no_translate: true</code> 来排除在外。</p><h2 id="快速上手"><a href="#快速上手" class="headerlink" title="快速上手"></a>快速上手</h2><h3 id="安装插件"><a href="#安装插件" class="headerlink" title="安装插件"></a>安装插件</h3><p>在 Hexo 根目录下执行安装指令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm install hexo-translate-llm<br></code></pre></td></tr></table></figure><h3 id="配置参数"><a href="#配置参数" class="headerlink" title="配置参数"></a>配置参数</h3><p>在 <code>_config.yml</code> 中加入以下配置。建议选用性价比更高的模型：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">llm_translation:</span><br>  <span class="hljs-attr">enable:</span> <span class="hljs-literal">true</span><br>  <span class="hljs-attr">model:</span> <span class="hljs-string">deepseek-ai/DeepSeek-V3.2</span><br>  <span class="hljs-attr">endpoint:</span> <span class="hljs-string">https://api.siliconflow.cn/v1/chat/completions</span><br>  <span class="hljs-attr">max_concurrency:</span> <span class="hljs-number">4</span><br>  <span class="hljs-attr">single_timeout:</span> <span class="hljs-number">120</span><br></code></pre></td></tr></table></figure><div class="note note-info">            <p>如果不想使用远程数据库，可以跳过 Neon PostgreSQL 的配置步骤。插件会自动使用本地缓存。</p>           </div><h3 id="安全设置"><a href="#安全设置" class="headerlink" title="安全设置"></a>安全设置</h3><p>本项目通过环境变量管理敏感信息。</p><h4 id="Vercel-部署"><a href="#Vercel-部署" class="headerlink" title="Vercel 部署"></a>Vercel 部署</h4><p>在 Vercel 仪表盘的项目设置中，添加<code>LLM_API_KEY</code>环境变量。<br>设置 Storage 连接，连接到neon PostgreSQL数据库。vercel会自动注入<code>DATABASE_URL</code>环境变量。</p><h4 id="本地构建"><a href="#本地构建" class="headerlink" title="本地构建"></a>本地构建</h4><p>在根目录创建 <code>.env</code> 文件：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs env">LLM_API_KEY=您的密钥<br>DATABASE_URL=数据库连接地址<br></code></pre></td></tr></table></figure><h2 id="使用技巧"><a href="#使用技巧" class="headerlink" title="使用技巧"></a>使用技巧</h2><p>特定文章可以排除在翻译范围之外。只需在 Front-matter 中设置 <code>no_translate: true</code>。插件会自动同步页面的 <code>title</code> 标签，确保浏览器标签页的语言一致性。</p>]]></content>
      
      
      <categories>
          
          <category> 开发工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
            <tag> AI </tag>
            
            <tag> 翻译 </tag>
            
            <tag> DeepSeek </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Kindle 浏览器 User-Agent 切换工具</title>
      <link href="/blog/kindle-modify-browserua/"/>
      <url>/blog/kindle-modify-browserua/</url>
      
        <content type="html"><![CDATA[<div class="note note-danger">            <p>修改系统文件存在潜在风险。操作前请务必备份重要数据。</p>           </div><div class="note note-info">            <p>开源仓库：<a href="https://github.com/Tokisaki-Galaxy/kindle-modify-browserUA">Tokisaki-Galaxy&#x2F;kindle-modify-browserUA</a></p>           </div><h2 id="开发背景"><a href="#开发背景" class="headerlink" title="开发背景"></a>开发背景</h2><p>Kindle 内置浏览器在访问现代网页被识别为移动设备。这导致页面功能缺失或强制重定向至简陋的移动版。<br>亚马逊在 5.16.4 版本固件中引入了 Chromium 内核。在新的浏览器内核下，基本上可以获得与电脑浏览器相似的体验。我购买KPW5原本就是为了在kindle上看小说，但是没想到贴吧居然强制跳转到移动版，导致无法正常使用。于是找了好久，找到了修改为电脑版User-Agent的方法，以便访问完整的网页内容。</p><h2 id="核心特性"><a href="#核心特性" class="headerlink" title="核心特性"></a>核心特性</h2><h3 id="桌面模式伪装"><a href="#桌面模式伪装" class="headerlink" title="桌面模式伪装"></a>桌面模式伪装</h3><p>系统支持一键将 UA 修改为 Windows 10 Edge 字符串。网页服务端将识别设备为桌面电脑。用户可直接访问完整的桌面版布局。</p><h3 id="状态实时监测"><a href="#状态实时监测" class="headerlink" title="状态实时监测"></a>状态实时监测</h3><p>集成 <code>status.sh</code> 脚本。用户可通过 KUAL 界面直接查看当前生效的 UA 类型。确保修改状态透明可查。</p><h3 id="无损还原机制"><a href="#无损还原机制" class="headerlink" title="无损还原机制"></a>无损还原机制</h3><p>系统保留原始 UA 配置。用户可随时通过菜单恢复 Kindle 默认设置。操作过程安全可逆。</p><h2 id="工作原理"><a href="#工作原理" class="headerlink" title="工作原理"></a>工作原理</h2><p>插件通过修改系统路径 <code>/usr/bin/browser</code> 实现。脚本在执行时自动获取 <code>mntroot rw</code> 读写权限。修改完成后系统将自动重启。新配置将在浏览器启动时生效。</p><h2 id="安装与操作"><a href="#安装与操作" class="headerlink" title="安装与操作"></a>安装与操作</h2><h3 id="前提条件"><a href="#前提条件" class="headerlink" title="前提条件"></a>前提条件</h3><ul><li>设备已完成越狱。</li><li>已安装 KUAL (Kindle Unified Application Launcher)。</li><li>固件版本不低于 5.16.4。</li></ul><h3 id="部署步骤"><a href="#部署步骤" class="headerlink" title="部署步骤"></a>部署步骤</h3><ol><li>下载项目压缩包。</li><li>将 <code>modify-browserUA</code> 文件夹拷贝至 Kindle 的 <code>extensions</code> 目录。</li><li>在 KUAL 菜单中找到 <code>modify browserUA</code> 选项。</li></ol><h3 id="功能菜单"><a href="#功能菜单" class="headerlink" title="功能菜单"></a>功能菜单</h3><ul><li>Change to Desktop UA：切换至桌面模式。</li><li>Status：查询当前 UA 状态。</li><li>Restore：还原系统默认设置。</li></ul>]]></content>
      
      
      <categories>
          
          <category> Kindle </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Kindle </tag>
            
            <tag> KUAL </tag>
            
            <tag> 浏览器 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>住理生活自动记账工具开发实践</title>
      <link href="/blog/statistics-zhulishenghuo/"/>
      <url>/blog/statistics-zhulishenghuo/</url>
      
        <content type="html"><![CDATA[<div class="note note-info">            <p>项目在线地址：<a href="https://zhulishenghuo-statis.tokisaki.top/">住理生活 · 记账助手</a><br>开源仓库：<a href="https://github.com/Tokisaki-Galaxy/statistics-zhulishenghuo">Tokisaki-Galaxy&#x2F;statistics-zhulishenghuo</a></p>           </div><p><img src="https://raw.githubusercontent.com/Tokisaki-Galaxy/statistics-zhulishenghuo/refs/heads/master/image/0.jpg" alt="项目图片"></p><h2 id="开发背景"><a href="#开发背景" class="headerlink" title="开发背景"></a>开发背景</h2><p>校园生活中的水费、接水及洗衣支出呈现零碎且频繁的特点。住理生活 App 目前缺乏直观的财务统计功能。手动记录此类微小支出效率低下。本项目旨在利用浏览器端技术实现消费记录的自动化提取与分析。</p><h2 id="核心特性"><a href="#核心特性" class="headerlink" title="核心特性"></a>核心特性</h2><h3 id="图像识别录入"><a href="#图像识别录入" class="headerlink" title="图像识别录入"></a>图像识别录入</h3><p>系统集成 OCR 技术。用户上传消费记录长截图即可完成数据采集。无需手动输入金额与时间。</p><h3 id="本地化隐私保护"><a href="#本地化隐私保护" class="headerlink" title="本地化隐私保护"></a>本地化隐私保护</h3><p>所有图像识别逻辑均在浏览器本地运行。数据存储于客户端 IndexedDB。信息不上传至任何服务器。隐私安全性得到底层保障。</p><h3 id="多维度数据可视化"><a href="#多维度数据可视化" class="headerlink" title="多维度数据可视化"></a>多维度数据可视化</h3><p>系统提供月度账单汇总。消费时段热力图展示生活规律。GitHub 风格的贡献图直观反映消费频次。</p><h2 id="技术架构"><a href="#技术架构" class="headerlink" title="技术架构"></a>技术架构</h2><h3 id="前端框架"><a href="#前端框架" class="headerlink" title="前端框架"></a>前端框架</h3><p>选用轻量级的 Alpine.js。逻辑层级清晰。适合小型单页应用的快速开发。</p><h3 id="文字识别"><a href="#文字识别" class="headerlink" title="文字识别"></a>文字识别</h3><p>集成 Tesseract.js 引擎。在浏览器端实现高性能 OCR 识别。支持复杂长图的文本解析。</p><h3 id="数据持久化与可视化"><a href="#数据持久化与可视化" class="headerlink" title="数据持久化与可视化"></a>数据持久化与可视化</h3><p>利用 IndexedDB 实现大容量本地存储。确保页面刷新后数据不丢失。采用 Chart.js 绘制动态统计图表。</p><h2 id="操作流程"><a href="#操作流程" class="headerlink" title="操作流程"></a>操作流程</h2><ol><li><strong>获取截图</strong>：在住理生活 App 中截取消费记录长图。</li><li><strong>上传解析</strong>：将截图上传至记账助手界面。</li><li><strong>查阅报表</strong>：系统自动解析并生成统计图表。</li><li><strong>数据导出</strong>：支持导出 CSV 或 JSON 格式文件进行二次分析。</li></ol><h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><ul><li>建议使用 PC 端浏览器以获得更佳的体验。</li></ul>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
          <category> 开发笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> OCR </tag>
            
            <tag> 财务管理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>KOReader 自定义翻译后端插件</title>
      <link href="/blog/kindle-koreader-custom-translator/"/>
      <url>/blog/kindle-koreader-custom-translator/</url>
      
        <content type="html"><![CDATA[<p>项目地址 <a href="https://github.com/Tokisaki-Galaxy/kindle-koreader-custom-translator">https://github.com/Tokisaki-Galaxy/kindle-koreader-custom-translator</a></p><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>KOReader 原生 Google 翻译接口在部分网络环境下不可达。为保持自动检测、拼音&#x2F;罗马音等原生体验，提供自定义后端替换方案。</p><p>默认使用Cloudflare Worker 上的AI模型<code>@cf/meta/m2m100-1.2b</code>进行翻译，如果需要可以通过自建方式，自行更换成其他模型，或提升速率限制。</p><h2 id="核心思路"><a href="#核心思路" class="headerlink" title="核心思路"></a>核心思路</h2><ul><li>自定义端点：<code>CUSTOM_ENDPOINT</code> 指向 <code>translate.api.tokisaki.top</code>，可选代理 <code>translate-proxy.api.tokisaki.top</code>，但是代理可能会有延迟。</li><li>语言映射：<code>SUPPORTED_LANGUAGES</code> 覆盖 249 种语言。</li><li>配置入口：KUAL 动态菜单在 <code>menu.json</code>，插件元数据在 <code>config.xml</code>。</li><li>安装与恢复：<code>bin/install.sh</code>、<code>bin/use_proxy.sh</code>、<code>bin/restore.sh</code> 负责部署、切换与回滚。</li></ul><h2 id="文件结构"><a href="#文件结构" class="headerlink" title="文件结构"></a>文件结构</h2><ul><li><code>translator.lua</code>：请求改写与展示逻辑，向自定义端点发送 <code>{ text, targetLanguage, sourceLanguage }</code>。</li><li><code>menu.json</code>：KUAL 菜单项，支持直连与代理安装。</li><li><code>config.xml</code>：插件元信息。</li><li><code>bin/install.sh</code>：安装并自动备份原版文件。</li><li><code>bin/use_proxy.sh</code>：切换代理端点。</li><li><code>bin/restore.sh</code>：恢复官方 translator。</li></ul><h2 id="安装与使用"><a href="#安装与使用" class="headerlink" title="安装与使用"></a>安装与使用</h2><h3 id="Kindle-KUAL"><a href="#Kindle-KUAL" class="headerlink" title="Kindle + KUAL"></a>Kindle + KUAL</h3><ol><li>将项目放入 <code>/mnt/us/extensions/koreader-custom-translator/</code>。</li><li>KUAL → “KOReader Custom Translator” → <strong>Install</strong>。</li><li>若直连受限，选择 <strong>Install (Use Proxy API)</strong>。</li></ol><h3 id="手动部署（Kobo-Android-Linux）"><a href="#手动部署（Kobo-Android-Linux）" class="headerlink" title="手动部署（Kobo&#x2F;Android&#x2F;Linux）"></a>手动部署（Kobo&#x2F;Android&#x2F;Linux）</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">cd</span> bin<br>sh install.sh                 <span class="hljs-comment"># 自动检测 KOReader 路径</span><br>KO_DIR=/path/to/koreader sh install.sh  <span class="hljs-comment"># 手动指定路径</span><br></code></pre></td></tr></table></figure><h2 id="代理与恢复"><a href="#代理与恢复" class="headerlink" title="代理与恢复"></a>代理与恢复</h2><ul><li>切换代理：<code>sh bin/use_proxy.sh</code>。</li><li>恢复官方：KUAL 选择 <strong>Restore</strong>，或运行 <code>sh bin/restore.sh</code>。</li></ul><h2 id="使用提示"><a href="#使用提示" class="headerlink" title="使用提示"></a>使用提示</h2><ul><li>升级 KOReader 后需重新执行安装脚本，避免官方更新覆盖 <code>translator.lua</code>。</li><li>确认设备可访问自定义端点；若不可达，可先试代理端点。</li><li>发生异常可使用自动生成的 <code>translator.lua.bak</code> 回滚。</li></ul><h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>该插件在受限网络下提供稳定的翻译后端，同时保持 KOReader 原生语言检测与罗马音展示能力。直连与代理可按环境自由切换，更新与恢复均可一键完成。</p>]]></content>
      
      
      <categories>
          
          <category> Kindle </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 翻译 </tag>
            
            <tag> KOReader </tag>
            
            <tag> Kindle </tag>
            
            <tag> Cloudflare Worker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Google AI Studio 对话导出工具</title>
      <link href="/blog/aistudio-dump-script/"/>
      <url>/blog/aistudio-dump-script/</url>
      
        <content type="html"><![CDATA[<h2 id="背景与动机"><a href="#背景与动机" class="headerlink" title="背景与动机"></a>背景与动机</h2><p>Google AI Studio 提供了优秀的对话体验。但在科研或日常记录中，我们常面临数据留存的难题。原生界面并未提供导出选项。</p><p>若要保存灵感、整理代码片段或备份团队协作内容，逐条复制粘贴显然过于低效。这种重复性劳动不应占据宝贵的时间。</p><p>为此，编写了一款基于 Tampermonkey 的用户脚本：<strong>AI Studio Chat Exporter</strong>。它旨在解决这一痛点，实现对话内容的一键打包。</p><h2 id="功能概述"><a href="#功能概述" class="headerlink" title="功能概述"></a>功能概述</h2><p>该脚本主要实现了以下几项功能，旨在简化数据获取流程：</p><ul><li><p><strong>一键导出</strong><br>页面加载完成后，屏幕上会出现一个悬浮的 “Export JSON” 按钮。点击它，即可将当前的聊天内容打包成 JSON 文件并下载。</p></li><li><p><strong>完整抓取</strong><br>脚本会自动处理页面的滚动加载。这确保了每一轮对话——无论是用户的输入还是模型的回复——都能被完整收录，避免了手动复制可能产生的遗漏。</p></li><li><p><strong>系统提示词提取</strong><br>System Prompt 往往定义了对话的基调和规则。即使侧边栏处于折叠状态，脚本也会自动展开并捕获这部分关键信息。</p></li><li><p><strong>Markdown 格式支持</strong><br>模型输出中的标题、列表、代码块等元素，会被转换为标准的 Markdown 格式。这使得导出的内容可以直接粘贴到笔记软件或博客中，无需二次排版。</p></li><li><p><strong>多语言适配</strong><br>界面提示词支持简体中文、英文、德语等多种语言，会根据浏览器的语言设置自动切换。</p></li></ul><h2 id="部署方法"><a href="#部署方法" class="headerlink" title="部署方法"></a>部署方法</h2><p>使用该脚本需要浏览器扩展程序的支持。</p><ol><li><p><strong>环境准备</strong><br>在 Chrome、Edge 或 Brave 等浏览器中安装 <strong>Tampermonkey</strong> (油猴) 扩展。</p></li><li><p><strong>脚本安装</strong><br>获取 <code>script.js</code> 脚本文件或链接。Tampermonkey 会自动识别并弹出安装界面，点击 “Install” 即可。<br><a href="https://greasyfork.org/zh-CN/scripts/557864-ai-studio-chat-exporter-markdown-code-block-support">点此安装</a></p></li><li><p><strong>权限确认</strong><br>确保脚本的匹配规则覆盖了 <code>https://aistudio.google.com/prompts/*</code> 这一域名。</p></li><li><p><strong>生效验证</strong><br>刷新 AI Studio 的对话页面。若页面顶部出现一个可拖拽的蓝色按钮，即表示安装成功。</p></li></ol><h2 id="使用说明"><a href="#使用说明" class="headerlink" title="使用说明"></a>使用说明</h2><p>操作流程非常直观：</p><ol><li>打开任意一个 AI Studio 对话项目。</li><li>找到悬浮按钮，将其拖动到不遮挡视线的位置。</li><li>点击按钮。脚本将自动执行以下操作：<ul><li>获取系统提示词 (System Instruction)。</li><li>滚动并加载所有历史对话。</li><li>将内容格式化为 Markdown。</li><li>生成并下载 JSON 文件。</li></ul></li></ol><p>文件默认以当前项目的标题命名，例如 <code>My_Project.json</code>。</p><h2 id="数据结构"><a href="#数据结构" class="headerlink" title="数据结构"></a>数据结构</h2><p>导出的 JSON 文件结构清晰，便于程序二次处理或人工阅读：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;system_instruction&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;项目的系统提示词&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;messages&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>    <span class="hljs-punctuation">&#123;</span> <span class="hljs-attr">&quot;role&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;user&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;content&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;用户输入的 Markdown 文本&quot;</span> <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-punctuation">&#123;</span> <span class="hljs-attr">&quot;role&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;assistant&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;content&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;模型输出的 Markdown 文本&quot;</span> <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">]</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><p>在使用过程中，可能会遇到一些细微的情况：</p><ul><li><strong>按钮未显示</strong>：请检查 Tampermonkey 扩展是否已启用，或者尝试刷新页面。</li><li><strong>导出内容为空</strong>：脚本依赖于页面的 DOM 结构。请确保对话区域已正常加载，且能够滚动。</li><li><strong>System Prompt 字段为空</strong>：并非所有对话都设置了系统提示词。若原项目未设置，该字段自然为空。</li><li><strong>权限提示</strong>：脚本更新时，Tampermonkey 可能会请求新的地址权限，允许即可。</li></ul><h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><h2 id="AI-Studio-Chat-Exporter-将繁琐的备份工作简化为一个点击动作。这不仅节省了时间，也让知识管理变得-filepath-x-GitHub-hexo-source-posts-aistudio-dump-script-md"><a href="#AI-Studio-Chat-Exporter-将繁琐的备份工作简化为一个点击动作。这不仅节省了时间，也让知识管理变得-filepath-x-GitHub-hexo-source-posts-aistudio-dump-script-md" class="headerlink" title="AI Studio Chat Exporter 将繁琐的备份工作简化为一个点击动作。这不仅节省了时间，也让知识管理变得&#x2F;&#x2F; filepath: x:\GitHub\hexo\source_posts\aistudio-dump-script.md"></a>AI Studio Chat Exporter 将繁琐的备份工作简化为一个点击动作。这不仅节省了时间，也让知识管理变得&#x2F;&#x2F; filepath: x:\GitHub\hexo\source_posts\aistudio-dump-script.md</h2><h2 id="title-Google-AI-Studio-对话导出工具date-2025-12-04-15-11-53author-Tokisaki-Galaxyexcerpt-针对-Google-AI-Studio-缺少原生导出功能的问题，开发了一款基于-Tampermonkey-的用户脚本。该脚本可将对话内容完整抓取并导出为-JSON-格式，支持-Markdown-渲染，便于后续的资料整理与归档。tags-Tampermonkey-Google-AI-Studio-效率工具-JavaScriptcategories-效率工具"><a href="#title-Google-AI-Studio-对话导出工具date-2025-12-04-15-11-53author-Tokisaki-Galaxyexcerpt-针对-Google-AI-Studio-缺少原生导出功能的问题，开发了一款基于-Tampermonkey-的用户脚本。该脚本可将对话内容完整抓取并导出为-JSON-格式，支持-Markdown-渲染，便于后续的资料整理与归档。tags-Tampermonkey-Google-AI-Studio-效率工具-JavaScriptcategories-效率工具" class="headerlink" title="title: Google AI Studio 对话导出工具date: 2025-12-04 15:11:53author: Tokisaki Galaxyexcerpt: 针对 Google AI Studio 缺少原生导出功能的问题，开发了一款基于 Tampermonkey 的用户脚本。该脚本可将对话内容完整抓取并导出为 JSON 格式，支持 Markdown 渲染，便于后续的资料整理与归档。tags: - Tampermonkey - Google AI Studio - 效率工具 - JavaScriptcategories: - 效率工具"></a>title: Google AI Studio 对话导出工具<br>date: 2025-12-04 15:11:53<br>author: Tokisaki Galaxy<br>excerpt: 针对 Google AI Studio 缺少原生导出功能的问题，开发了一款基于 Tampermonkey 的用户脚本。该脚本可将对话内容完整抓取并导出为 JSON 格式，支持 Markdown 渲染，便于后续的资料整理与归档。<br>tags:<br> - Tampermonkey<br> - Google AI Studio<br> - 效率工具<br> - JavaScript<br>categories:<br> - 效率工具</h2><h2 id="背景与动机-1"><a href="#背景与动机-1" class="headerlink" title="背景与动机"></a>背景与动机</h2><p>Google AI Studio 提供了优秀的对话体验。但在科研或日常记录中，我们常面临数据留存的难题。原生界面并未提供导出选项。</p><p>若要保存灵感、整理代码片段或备份团队协作内容，逐条复制粘贴显然过于低效。这种重复性劳动不应占据宝贵的时间。</p><p>为此，编写了一款基于 Tampermonkey 的用户脚本：<strong>AI Studio Chat Exporter</strong>。它旨在解决这一痛点，实现对话内容的一键打包。</p><h2 id="功能概述-1"><a href="#功能概述-1" class="headerlink" title="功能概述"></a>功能概述</h2><p>该脚本主要实现了以下几项功能，旨在简化数据获取流程：</p><ul><li><p><strong>一键导出</strong><br>页面加载完成后，屏幕上会出现一个悬浮的 “Export JSON” 按钮。点击它，即可将当前的聊天内容打包成 JSON 文件并下载。</p></li><li><p><strong>完整抓取</strong><br>脚本会自动处理页面的滚动加载。这确保了每一轮对话——无论是用户的输入还是模型的回复——都能被完整收录，避免了手动复制可能产生的遗漏。</p></li><li><p><strong>系统提示词提取</strong><br>System Prompt 往往定义了对话的基调和规则。即使侧边栏处于折叠状态，脚本也会自动展开并捕获这部分关键信息。</p></li><li><p><strong>Markdown 格式支持</strong><br>模型输出中的标题、列表、代码块等元素，会被转换为标准的 Markdown 格式。这使得导出的内容可以直接粘贴到笔记软件或博客中，无需二次排版。</p></li><li><p><strong>多语言适配</strong><br>界面提示词支持简体中文、英文、德语等多种语言，会根据浏览器的语言设置自动切换。</p></li></ul><h2 id="部署方法-1"><a href="#部署方法-1" class="headerlink" title="部署方法"></a>部署方法</h2><p>使用该脚本需要浏览器扩展程序的支持。</p><ol><li><p><strong>环境准备</strong><br>在 Chrome、Edge 或 Brave 等浏览器中安装 <strong>Tampermonkey</strong> (油猴) 扩展。</p></li><li><p><strong>脚本安装</strong><br>获取 <code>script.js</code> 脚本文件或链接。Tampermonkey 会自动识别并弹出安装界面，点击 “Install” 即可。</p></li><li><p><strong>权限确认</strong><br>确保脚本的匹配规则覆盖了 <code>https://aistudio.google.com/prompts/*</code> 这一域名。</p></li><li><p><strong>生效验证</strong><br>刷新 AI Studio 的对话页面。若页面顶部出现一个可拖拽的蓝色按钮，即表示安装成功。</p></li></ol><h2 id="使用说明-1"><a href="#使用说明-1" class="headerlink" title="使用说明"></a>使用说明</h2><p>操作流程非常直观：</p><ol><li>打开任意一个 AI Studio 对话项目。</li><li>找到悬浮按钮，将其拖动到不遮挡视线的位置。</li><li>点击按钮。脚本将自动执行以下操作：<ul><li>获取系统提示词 (System Instruction)。</li><li>滚动并加载所有历史对话。</li><li>将内容格式化为 Markdown。</li><li>生成并下载 JSON 文件。</li></ul></li></ol><p>文件默认以当前项目的标题命名，例如 <code>My_Project.json</code>。</p><h2 id="数据结构-1"><a href="#数据结构-1" class="headerlink" title="数据结构"></a>数据结构</h2><p>导出的 JSON 文件结构清晰，便于程序二次处理或人工阅读：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;system_instruction&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;项目的系统提示词&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;messages&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>    <span class="hljs-punctuation">&#123;</span> <span class="hljs-attr">&quot;role&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;user&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;content&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;用户输入的 Markdown 文本&quot;</span> <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-punctuation">&#123;</span> <span class="hljs-attr">&quot;role&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;assistant&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;content&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;模型输出的 Markdown 文本&quot;</span> <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">]</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><h2 id="注意事项-1"><a href="#注意事项-1" class="headerlink" title="注意事项"></a>注意事项</h2><p>在使用过程中，可能会遇到一些细微的情况：</p><ul><li><strong>按钮未显示</strong>：请检查 Tampermonkey 扩展是否已启用，或者尝试刷新页面。</li><li><strong>导出内容为空</strong>：脚本依赖于页面的 DOM 结构。请确保对话区域已正常加载，且能够滚动。</li><li><strong>System Prompt 字段为空</strong>：并非所有对话都设置了系统提示词。若原项目未设置，该字段自然为空。</li><li><strong>权限提示</strong>：脚本更新时，Tampermonkey 可能会请求新的地址权限，允许即可。</li></ul><h2 id="结语-1"><a href="#结语-1" class="headerlink" title="结语"></a>结语</h2><p>AI Studio Chat Exporter 将繁琐的备份工作简化为一个点击动作。这不仅节省了时间，也让知识管理变得更加有序。希望这个小工具能为各位的研究与工作带来便利。</p>]]></content>
      
      
      <categories>
          
          <category> 效率工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Tampermonkey </tag>
            
            <tag> Google AI Studio </tag>
            
            <tag> 效率工具 </tag>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>POPUCOM 三消棋：网页的多人联机小游戏</title>
      <link href="/blog/popucom-chess/"/>
      <url>/blog/popucom-chess/</url>
      
        <content type="html"><![CDATA[<p><a href="https://pop.tokisaki.top/">在线试玩（Vercel）</a><br><a href="https://github.com/Tokisaki-Galaxy/POPUCOM-Chess-Multiplayer">项目地址（GitHub）</a></p><div class="note note-info">            <p>复刻自yj的小游戏，现在改为浏览器的轻量棋类游戏。规则简洁。决策空间充足。支持房间对战与本地练习。</p>           </div><h2 id="玩法概要"><a href="#玩法概要" class="headerlink" title="玩法概要"></a>玩法概要</h2><ul><li>棋盘：9×9。</li><li>落子：只能落在中立或己方领地。不可落在对方领地。</li><li>三消：横、竖、两条对角线。出现连续 3 子即消除这三子，格点清空。</li><li>领地：三消所在直线归属当前玩家。自该直线两端向外延伸，遇到对方棋子或下一格为对方棋子即停止。领地可被覆盖。</li><li>回合与胜负：双方共 50 步即结算。比较己方领地格数。多者胜，持平为和。</li></ul><p>屏幕截图与录屏见仓库 README。</p><h2 id="形态"><a href="#形态" class="headerlink" title="形态"></a>形态</h2><ul><li>Serverless（推荐）：前端 + API 全托管在 Vercel。数据落在 Supabase。支持限流中间件。</li><li>Python（Legacy）：Flask REST 服务 + Pygame 客户端。本地或自建服务器可用。</li></ul><h2 id="架构与核心文件"><a href="#架构与核心文件" class="headerlink" title="架构与核心文件"></a>架构与核心文件</h2><ul><li>前端与规则引擎<ul><li>页面与样式：index.html、styles.css。</li><li>交互与本地规则引擎：main.js。</li><li>关键类：BaseGame。核心算法在 BaseGame.calculateNextState。处理三连消与领地扩张，并推进回合与胜负。</li><li>模式：<ul><li>LocalGame：本地单机。</li><li>OnlineGame：基于轮询同步房间状态。</li></ul></li></ul></li><li>Serverless API（Vercel）<ul><li>入口：api&#x2F;game.js，导出 handler。</li><li>路由：<ul><li>GET &#x2F;api&#x2F;game?roomId&#x3D;… 查询房间状态。</li><li>POST &#x2F;api&#x2F;game 创建或确保房间存在。</li><li>PUT &#x2F;api&#x2F;game 写入局面（棋盘、领地、当前手、胜负、最后一步）。</li></ul></li></ul></li><li>数据与运维（Supabase &#x2F; PostgreSQL）<ul><li>表结构初始化与 Realtime 发布：database-init.sql。</li><li>定时清理 48 小时未活跃房间（pg_cron）：cron-cleandata.sql。</li></ul></li><li>频控（Edge Middleware）<ul><li>文件：middleware.js。</li><li>依赖：@upstash&#x2F;redis、@upstash&#x2F;ratelimit、@vercel&#x2F;edge。</li></ul></li></ul><h2 id="规则实现要点"><a href="#规则实现要点" class="headerlink" title="规则实现要点"></a>规则实现要点</h2><ul><li>三消检测：以每个落子点为起点，同时检测四个方向是否形成长度为 3 的连续同色。</li><li>消除与归零：命中三消的格点清零。可并发命中多线。</li><li>领地扩张：记录三消线段归属后，从线段两端向外扫描。遇到对手棋子或“下一格是对手棋子”即停止。被覆盖的领地以最新归属为准。</li><li>结算：总步数到 $50$ 即统计两侧领地格数。多者胜，持平为和局。</li></ul><p>实现对应：</p><ul><li>JS：BaseGame.calculateNextState（落子 → 扫描 → 清子 → 领地扩张 → 回合推进 → 胜负判定）。</li><li>Python：process_eliminations、remove_elimination_tiles、claim_line，统一由 GameEngine 驱动。</li></ul><h2 id="Serverless-快速开始"><a href="#Serverless-快速开始" class="headerlink" title="Serverless 快速开始"></a>Serverless 快速开始</h2><ol><li>准备 Supabase</li></ol><ul><li>新建项目。执行 database-init.sql 初始化表与策略。  </li><li>可选：执行 cron-cleandata.sql，启用 pg_cron 清理过期房间。</li></ul><ol start="2"><li>配置 Vercel 环境变量</li></ol><ul><li>SUPABASE_URL：项目 REST URL。  </li><li>SUPABASE_KEY：建议使用 Legacy API Key。  </li><li>可选限流：配置 Upstash Redis（URL、TOKEN）。</li></ul><ol start="3"><li>部署</li></ol><ul><li>将仓库导入 Vercel。完成后访问根路径即可游玩。</li></ul><h3 id="数据表（Supabase-PostgreSQL）"><a href="#数据表（Supabase-PostgreSQL）" class="headerlink" title="数据表（Supabase &#x2F; PostgreSQL）"></a>数据表（Supabase &#x2F; PostgreSQL）</h3><ul><li>表 games（JSON 持久化局面 + 元数据）：<ul><li>room_id（PK）</li><li>board（int[][]）</li><li>territory（int[][]）</li><li>current_player（int）</li><li>winner（int）</li><li>last_move_pos（int[2]）</li><li>updated_at（timestamptz）</li></ul></li></ul><p>示例（节选）：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create table</span> if <span class="hljs-keyword">not</span> <span class="hljs-keyword">exists</span> public.games (<br>  room_id text <span class="hljs-keyword">primary key</span>,<br>  board jsonb <span class="hljs-keyword">not null</span>,<br>  territory jsonb <span class="hljs-keyword">not null</span>,<br>  current_player <span class="hljs-type">int</span> <span class="hljs-keyword">not null</span> <span class="hljs-keyword">default</span> <span class="hljs-number">1</span>,<br>  winner <span class="hljs-type">int</span> <span class="hljs-keyword">not null</span> <span class="hljs-keyword">default</span> <span class="hljs-number">0</span>,<br>  last_move_pos jsonb,<br>  updated_at timestamptz <span class="hljs-keyword">not null</span> <span class="hljs-keyword">default</span> now()<br>);<br><br><span class="hljs-keyword">create</span> index if <span class="hljs-keyword">not</span> <span class="hljs-keyword">exists</span> idx_games_updated_at <span class="hljs-keyword">on</span> public.games(updated_at <span class="hljs-keyword">desc</span>);<br></code></pre></td></tr></table></figure><h2 id="Python-版本（Legacy）"><a href="#Python-版本（Legacy）" class="headerlink" title="Python 版本（Legacy）"></a>Python 版本（Legacy）</h2><ul><li>服务端（Flask）<ul><li>GameEngine：维护棋面与回合、胜负。</li><li>process_eliminations &#x2F; remove_elimination_tiles &#x2F; claim_line：规则的三阶段实现。</li><li>MatchState：对局调度与并发安全。</li><li>server.py：加入、查询、落子、重置的 REST 路由。</li></ul></li><li>客户端（Pygame）<ul><li>LocalGame：本地对局。</li><li>RemoteGame：轮询 Flask 服务。</li><li>client.py：渲染与事件循环。</li></ul></li></ul><p>启动步骤：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 进入 python 子目录（若有）</span><br>pip install -r python/requirements.txt<br>python python/server.py<br>python python/client.py  <span class="hljs-comment"># 选择本地或在线模式</span><br></code></pre></td></tr></table></figure><h2 id="频控与稳定性"><a href="#频控与稳定性" class="headerlink" title="频控与稳定性"></a>频控与稳定性</h2><ul><li>middleware.js 基于 Upstash Redis 实现节流。  </li><li>按 IP 与路径维度限速。边缘执行，开销低。  </li><li>与 Supabase Realtime 可并用，减少轮询压力。</li></ul><h2 id="可扩展方向"><a href="#可扩展方向" class="headerlink" title="可扩展方向"></a>可扩展方向</h2><ul><li>实时联动：由轮询迁移至 Supabase Realtime 或 WebSocket &#x2F; Edge Functions。</li><li>观战与复盘：为非玩家提供只读视角。持久化历史步谱并可回放。</li><li>防作弊：IP&#x2F;设备指纹&#x2F;节流策略结合服务器侧校验。</li><li>体验优化：房间分享卡片。一键截图（已在 main.js 集成 html2canvas）。移动端触控适配（styles.css 已适配基础尺寸）。</li></ul><h2 id="许可证与致谢"><a href="#许可证与致谢" class="headerlink" title="许可证与致谢"></a>许可证与致谢</h2><ul><li>参见仓库 LICENSE。  </li><li>感谢 Vercel、Supabase、Upstash 提供的云端基础设施。  </li><li>感谢社区对规则与可用性的建议。</li></ul><div class="note note-success">            <p>服务已就绪即可直接游玩。欢迎提交 Issue 与 PR。</p>           </div>]]></content>
      
      
      <categories>
          
          <category> 项目 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 三消 </tag>
            
            <tag> 棋类 </tag>
            
            <tag> Multiplayer </tag>
            
            <tag> Serverless </tag>
            
            <tag> Supabase </tag>
            
            <tag> Vercel </tag>
            
            <tag> Upstash </tag>
            
            <tag> Python </tag>
            
            <tag> Flask </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在 OpenWrt 上优雅地管理 Tailscale：luci-app-tailscale-community</title>
      <link href="/blog/openwrt-luci-app-tailscale-community/"/>
      <url>/blog/openwrt-luci-app-tailscale-community/</url>
      
        <content type="html"><![CDATA[<h2 id="2026-1-23"><a href="#2026-1-23" class="headerlink" title="2026&#x2F;1&#x2F;23"></a>2026&#x2F;1&#x2F;23</h2><p>经过两三个月的代码审查<a href="https://github.com/openwrt/luci/pull/8018">PR#8018</a>，<code>luci-app-tailscale-community</code> 已正式合并到 OpenWrt 主线 LuCI 仓库中，未来的发行版可以直接通过官方源安装该插件，无需额外操作。</p><p>另外，这是我第一次将个人项目成功合并到 OpenWrt 主线，感到非常荣幸！</p><hr><h2 id="项目地址"><a href="#项目地址" class="headerlink" title="项目地址"></a>项目地址</h2><p><a href="https://github.com/tokisaki-galaxy/luci-app-tailscale-community">https://github.com/tokisaki-galaxy/luci-app-tailscale-community</a></p><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>Tailscale 作为一种基于 WireGuard 的零配置 VPN，极大地简化了设备之间的安全连接。对于在 OpenWrt 路由器上运行 Tailscale 的用户来说，通过命令行进行管理虽然可行，但远不如图形化界面来得直观和高效。为了解决这一问题，我开发了 <code>luci-app-tailscale-community</code>，一个专为 OpenWrt LuCI 界面设计的 Tailscale 管理插件。</p><p><code>luci-app-tailscale-community</code> 旨在提供一个原生集成、功能全面的 Web 界面，让用户可以轻松地监控 Tailscale 网络状态并调整各项配置，而无需登录 SSH。</p><h3 id="核心功能概览"><a href="#核心功能概览" class="headerlink" title="核心功能概览"></a>核心功能概览</h3><p>该插件将 Tailscale 的核心功能无缝集成到 LuCI 的“服务”菜单下，主要分为“状态”和“设置”两个部分。</p><h4 id="1-状态仪表盘"><a href="#1-状态仪表盘" class="headerlink" title="1. 状态仪表盘"></a>1. 状态仪表盘</h4><p>提供对 Tailscale 网络健康状况的即时洞察：</p><ul><li><strong>服务状态</strong>: 清晰地显示 <code>tailscaled</code> 守护进程是“运行中”还是“未运行”。</li><li><strong>设备 IP</strong>: 展示当前设备的 Tailscale IPv4 和 IPv6 地址。</li><li><strong>网络设备列表</strong>: 以表格形式详尽列出 Tailnet 中的所有对等节点（Peers），包含以下关键信息：<ul><li><strong>在线状态</strong>: 通过颜色标识节点是在线还是离线。</li><li><strong>主机名与 DNS</strong>: 显示设备的主机名和完整的 Tailscale DNS 名称。</li><li><strong>连接类型</strong>: 指明连接是“直连 (Direct)”还是通过“中继 (Relay)”，并显示中继服务器信息。</li><li><strong>操作系统</strong> 和 <strong>Tailscale IP</strong>。</li><li><strong>最后在线时间</strong>: 对于离线设备，显示其最后一次活跃的时间。</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Tokisaki-Galaxy/luci-app-tailscale-community/refs/heads/master/image/status.png" alt="状态页面截图"></p><h4 id="2-强大的设置管理"><a href="#2-强大的设置管理" class="headerlink" title="2. 强大的设置管理"></a>2. 强大的设置管理</h4><p>设置页面通过两个标签页，区分了即时生效的节点设置和需要重启服务的守护进程设置。</p><ul><li><p><strong>节点设置 (Node Settings)</strong><br>这些设置通过调用 <code>tailscale set</code> 命令实现，更改会立即生效，无需中断服务。支持的配置项包括：</p><ul><li>接受&#x2F;通告路由 (<code>Accept Routes</code> &#x2F; <code>Advertise Routes</code>)</li><li>作为或使用出口节点 (<code>Advertise as Exit Node</code> &#x2F; <code>Use Exit Node</code>)</li><li>为子网路由启用 SNAT</li><li>启用内置 SSH 服务器</li><li>切换 <code>Shields Up</code> 模式以增强安全性</li><li>设置自定义主机名</li></ul></li><li><p><strong>守护进程环境设置 (Daemon Environment Settings)</strong><br>这些高级选项通过修改 <code>tailscaled</code> 启动时的环境变量来实现，因此在保存后需要重启服务。</p><ul><li><strong>自定义 MTU</strong>: 解决特定网络环境下的连接问题。</li><li><strong>减少内存使用</strong>: 针对内存有限的设备进行优化，通过设置 <code>GOGC=10</code> 环境变量，以少量 CPU 开销换取更低的内存占用。</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Tokisaki-Galaxy/luci-app-tailscale-community/refs/heads/master/image/setting.png" alt="设置页面截图"></p><h3 id="技术实现"><a href="#技术实现" class="headerlink" title="技术实现"></a>技术实现</h3><p><code>luci-app-tailscale-community</code> 主要使用 Lua 编写，并遵循 LuCI 的 MVC 架构。</p><ul><li><strong>数据模型</strong>: <code>luasrc/model/tailscale_data.lua</code> 是核心数据加载器。它通过执行 <code>tailscale status --json</code> 和 <code>tailscale ip</code> 命令获取实时状态，并解析 <code>/etc/tailscale/tailscaled.state</code> 文件以获取更详细的运行时配置。</li><li><strong>CBI 界面</strong>: <code>luasrc/model/cbi/tailscale_status.lua</code> 和 <code>tailscale_settings.lua</code> 文件使用 LuCI 的 CBI (Configuration Binding Interface) 框架来构建用户界面，并将前端选项与后端配置和命令关联起来。</li><li><strong>配置应用</strong>: 对于守护进程设置，插件会动态创建或更新位于 <code>/etc/profile.d/</code> 的一个 shell 脚本，确保在 <code>tailscaled</code> 服务启动时能加载正确的环境变量。</li></ul><h3 id="安装与使用"><a href="#安装与使用" class="headerlink" title="安装与使用"></a>安装与使用</h3><p>安装过程非常简单：</p><ol><li><strong>前提条件</strong>: 确保您的 OpenWrt 设备已安装 <code>tailscale</code> 和 <code>coreutils-base64</code>。<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">opkg update<br>opkg install tailscale coreutils-base64<br></code></pre></td></tr></table></figure></li><li><strong>安装插件</strong>: 从项目的 <a href="https://github.com/Tokisaki-Galaxy/luci-app-tailscale-community/releases">GitHub Release</a> 页面下载最新的 <code>.ipk</code> 软件包，上传到路由器并使用 <code>opkg</code> 安装。<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">opkg install luci-app-tailscale-community_*.ipk<br></code></pre></td></tr></table></figure><strong>也可以从项目的action下载</strong><br>安装完成后，刷新 LuCI 页面，即可在“服务”菜单下找到“Tailscale”入口。</li></ol>]]></content>
      
      
      <categories>
          
          <category> openwrt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> OpenWrt </tag>
            
            <tag> Tailscale </tag>
            
            <tag> Network </tag>
            
            <tag> LuCI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Github云编译Openwrt软件包，再也不用本地配环境</title>
      <link href="/blog/github-action-openwrt-package-builder/"/>
      <url>/blog/github-action-openwrt-package-builder/</url>
      
        <content type="html"><![CDATA[<h2 id="项目地址"><a href="#项目地址" class="headerlink" title="项目地址"></a>项目地址</h2><p><a href="https://github.com/Tokisaki-Galaxy/openwrt-package-builder-action">https://github.com/Tokisaki-Galaxy/openwrt-package-builder-action</a></p><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>对于许多 OpenWrt 爱好者和开发者来说，为不同的目标架构编译软件包可能是一项重复且耗时的工作。为了每次搭建不同环境非常麻烦，我开发并开源了 OpenWrt Package Builder，这是一个基于 GitHub Actions 的自动化工作流，旨在让 OpenWrt 软件包的编译过程变得前所未有的简单和高效。</p><p>你只需要将软件包源码上传至 GitHub 仓库，选择一个预设的工作流，修改两个配置变量，即可自动为多个目标平台编译出 .ipk 文件。<br>下面是项目的README.md</p><hr><p>一个简单、通用且开箱即用的 GitHub Actions 工作流，用于自动编译任何 OpenWrt 软件包。本项目提供了两种编译模式：<strong>SDK 模式（推荐）</strong> 和 <strong>源码模式</strong>，以满足不同需求。</p><p>你只需要将你的软件包源码放在仓库中，选择一个工作流文件，修改两个变量，即可为多个目标架构自动编译出 <code>.ipk</code> 文件。</p><h2 id="✨-特性"><a href="#✨-特性" class="headerlink" title="✨ 特性"></a>✨ 特性</h2><ul><li><strong>🚀 简单易用</strong>: 只需复制粘贴工作流文件，修改两个环境变量即可。</li><li><strong>⚡️ 极速编译 (SDK 模式)</strong>: 利用官方预编译的 SDK，将编译时间从 30+ 分钟缩短至 5 分钟以内。</li><li><strong>💡 灵活强大 (源码模式)</strong>: 可编译包括内核模块在内的任何软件包，并支持 <code>master</code> 等开发分支。</li><li><strong>⚙️ 高度通用</strong>: 可用于编译 LuCI 应用、命令行工具、内核模块等任何类型的 OpenWrt 软件包。</li><li><strong>🎯 多目标编译</strong>: 默认配置为 <code>x86_64</code>, <code>armv8</code>, <code>mips_mt7621</code> 等常用架构，可轻松自定义。</li><li><strong>📦 自动发布</strong>: 编译成功后，自动将 <code>.ipk</code> 文件上传为构建产物 (Artifacts)，方便下载。</li><li><strong>💬 提交评论</strong>: (可选) 所有构建任务成功后，会在对应的 Commit 下自动发表评论，提供产物下载链接。</li></ul><h2 id="🤔-如何选择编译模式？"><a href="#🤔-如何选择编译模式？" class="headerlink" title="🤔 如何选择编译模式？"></a>🤔 如何选择编译模式？</h2><p>本项目提供两种工作流，请根据你的需求选择其一。</p><table><thead><tr><th align="left">特性 &#x2F; 场景</th><th align="left">✅ SDK 模式 (推荐)</th><th align="left">⚠️ 源码模式</th></tr></thead><tbody><tr><td align="left"><strong>编译速度</strong></td><td align="left"><strong>极快</strong> (通常 &lt; 1 分钟)</td><td align="left">慢 (首次编译 &gt; 40 分钟，后续有缓存)</td></tr><tr><td align="left"><strong>适用包类型</strong></td><td align="left">大多数 <strong>LuCI 应用</strong> 和 <strong>普通软件包</strong></td><td align="left"><strong>所有软件包</strong>，特别是<strong>内核模块 (<code>kmod-xxx</code>)</strong></td></tr><tr><td align="left"><strong>支持的 OpenWrt 版本</strong></td><td align="left">仅支持<strong>官方正式发布版</strong> (如 <code>v23.05.3</code>)</td><td align="left">支持<strong>所有版本</strong>，包括 <code>master</code> 开发分支</td></tr><tr><td align="left"><strong>工作流文件</strong></td><td align="left"><code>build-with-sdk.yml</code></td><td align="left"><code>build-from-source.yml</code></td></tr></tbody></table><p><strong>总而言之：如果不确定，或者你只是编译一个 LuCI 应用，请优先选择 <code>SDK 模式</code>。</strong></p><h2 id="🚀-如何使用"><a href="#🚀-如何使用" class="headerlink" title="🚀 如何使用"></a>🚀 如何使用</h2><h4 id="举个例子"><a href="#举个例子" class="headerlink" title="举个例子"></a>举个例子</h4><p>如果有不明白地方，可以参考<a href="https://github.com/Tokisaki-Galaxy/luci-app-tailscale-community/.github/workflows/build.yml">这里</a>。</p><h4 id="步骤-1-选择并创建工作流文件"><a href="#步骤-1-选择并创建工作流文件" class="headerlink" title="步骤 1: 选择并创建工作流文件"></a>步骤 1: 选择并创建工作流文件</h4><p>根据上方的选择，在你的仓库根目录下创建对应的 <code>.github/workflows/</code> 目录和 YAML 文件。</p><ul><li><strong>对于 SDK 模式</strong>: 创建 <code>.github/workflows/build.yml</code></li><li><strong>对于源码模式</strong>: 创建 <code>.github/workflows/build-nonSDK.yml</code></li></ul><h4 id="步骤-2-复制工作流代码"><a href="#步骤-2-复制工作流代码" class="headerlink" title="步骤 2: 复制工作流代码"></a>步骤 2: 复制工作流代码</h4><p>根据你在上一步的选择，将本仓库中对应文件的完整代码复制过去。</p><ul><li>➡️ <a href="build.yml"><strong><code>build-with-sdk.yml</code> 的代码</strong></a></li><li>➡️ <a href="build-nonSDK.yml"><strong><code>build-from-source.yml</code> 的代码</strong></a></li></ul><h4 id="步骤-3-修改配置"><a href="#步骤-3-修改配置" class="headerlink" title="步骤 3: 修改配置"></a>步骤 3: 修改配置</h4><p>打开你创建的 YAML 文件，你只需要修改 <code>env</code> 部分的 <strong>两个</strong> 变量：</p><ol><li><p><strong><code>PACKAGE_NAME</code></strong>:<br>将其值修改为你的软件包的目录名。<strong>非常重要</strong>，这个名字必须和你的软件包在仓库中的文件夹名称完全一致。</p></li><li><p><strong><code>OPENWRT_VERSION</code></strong>:<br>设置你想要基于哪个 OpenWrt 版本进行编译。</p><ul><li><strong>使用 SDK 模式时</strong>: <strong>必须</strong>是一个官方发布的标签，例如 <code>v23.05.3</code>。</li><li><strong>使用源码模式时</strong>: 可以是任何标签或分支名，例如 <code>v23.05.3</code> 或 <code>master</code>。</li></ul></li></ol><blockquote><p><strong>提示:</strong> 别忘了更新 <code>README.md</code> 文件顶部的徽章链接，将 <code>Tokisaki-Galaxy/openwrt-package-builder-action</code> 替换成你自己的！</p></blockquote><h4 id="步骤-4-检查-Makefile-重要"><a href="#步骤-4-检查-Makefile-重要" class="headerlink" title="步骤 4: 检查 Makefile (重要)"></a>步骤 4: 检查 Makefile (重要)</h4><p>确保你的软件包目录下的 <code>Makefile</code> 文件中正确定义了所有依赖项。本工作流依赖 <code>make defconfig</code> 来自动解析并选中这些依赖。</p><p>例如:</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-keyword">define</span> Package/my-cool-package<br>  <span class="hljs-comment"># ...</span><br>  DEPENDS:=+libcurl +libjson-c +some-other-package<br><span class="hljs-keyword">endef</span><br></code></pre></td></tr></table></figure><h4 id="步骤-5-提交并运行"><a href="#步骤-5-提交并运行" class="headerlink" title="步骤 5: 提交并运行"></a>步骤 5: 提交并运行</h4><p>将你的代码和 <code>.github/workflows/</code> 下的 YAML 文件提交并推送到 GitHub。GitHub Actions 会自动开始运行。</p><p>你可以在仓库的 <code>Actions</code> 标签页查看编译进度。编译完成后，可以在对应的运行记录页面找到并下载 <code>Artifacts</code>。</p><h2 id="🔧-自定义"><a href="#🔧-自定义" class="headerlink" title="🔧 自定义"></a>🔧 自定义</h2><h3 id="修改编译目标"><a href="#修改编译目标" class="headerlink" title="修改编译目标"></a>修改编译目标</h3><p>如果你需要为其他架构编译，可以修改工作流文件中的 <code>jobs.build.strategy.matrix.target</code> 部分。只需按照现有格式添加或修改条目即可。</p><blockquote><p><strong>请注意</strong>：两种模式的 <code>matrix</code> 结构略有不同，请参照各自文件中的格式进行修改。</p></blockquote><h3 id="修改触发条件"><a href="#修改触发条件" class="headerlink" title="修改触发条件"></a>修改触发条件</h3><p>你可以修改文件顶部的 <code>on</code> 部分来更改触发工作流的条件，例如改为 <code>pull_request</code> 或定时运行 (<code>schedule</code>)。</p><hr><h2 id="协议"><a href="#协议" class="headerlink" title="协议"></a>协议</h2><p>本项目使用MIT授权。</p>]]></content>
      
      
      <categories>
          
          <category> 技术分享 </category>
          
          <category> 小玩具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> OpenWrt </tag>
            
            <tag> GitHub Actions </tag>
            
            <tag> CI/CD </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在 Linux 上使用 ipset 高效屏蔽特定国家 IP（中国等）</title>
      <link href="/blog/use-ipset-ban-chinaip/"/>
      <url>/blog/use-ipset-ban-chinaip/</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>从Google Cloud白嫖了个服务器，但是最近时不时总是发现偷偷跑钱，每个月一两块钱，虽然少但是与白嫖相悖。</p><p>因为虽然每个月有200G免费流量，但是中国不属于免费流量范围，所以每次访问中国IP都会扣钱。于是就想办法封中国IP。</p><p>一开始看到网上很多ufw的脚步，比如这种</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash for ip in $(cat cn.zone); do sudo ufw deny from $ip done</span><br></code></pre></td></tr></table></figure><p>用一堆for循环塞到ufw里面，当一个网络数据包到达时，内核需要从上到下逐一检查这个长长的规则列表。时间复杂度是O(n)，当规则数量很多时，性能会显著下降。</p><p>而ipset是专门为处理大量IP地址而设计的，它使用哈希表来存储IP地址，查询时间复杂度接近O(1)。所以使用ipset代替ufw可以显著提高性能。</p><p>一开始是用ipset-persistent，netfilter-persistent进行持久化，但是这两个工具会保存所有规则，容易导致ipset规则积累过多。所以采用服务的方式绕开持久化。</p><h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2><h3 id="systemed-Service"><a href="#systemed-Service" class="headerlink" title="systemed Service"></a>systemed Service</h3><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-comment"># /etc/systemd/system/china-ip-blocker.service</span><br><span class="hljs-section">[Unit]</span><br><span class="hljs-attr">Description</span>=Update and apply China IP blocklist using ipset<br><span class="hljs-attr">After</span>=network-<span class="hljs-literal">on</span>line.target<br><span class="hljs-attr">Wants</span>=network-<span class="hljs-literal">on</span>line.target<br><br><span class="hljs-section">[Service]</span><br><span class="hljs-attr">Type</span>=<span class="hljs-literal">on</span>eshot<br><span class="hljs-comment"># 脚本绝对路径</span><br><span class="hljs-attr">ExecStart</span>=/usr/local/bin/update_china_blocklist.sh<br><span class="hljs-attr">PrivateTmp</span>=<span class="hljs-literal">true</span><br><span class="hljs-attr">ProtectSystem</span>=strict<br><span class="hljs-attr">ReadWritePaths</span>=/var/run<br><span class="hljs-attr">ProtectHome</span>=<span class="hljs-literal">true</span><br><span class="hljs-attr">NoNewPrivileges</span>=<span class="hljs-literal">true</span><br><span class="hljs-attr">SupplementaryGroups</span>=systemd-resolve<br></code></pre></td></tr></table></figure><h3 id="systemed-Timer"><a href="#systemed-Timer" class="headerlink" title="systemed Timer"></a>systemed Timer</h3><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-comment"># /etc/systemd/system/china-ip-blocker.timer</span><br><span class="hljs-section">[Unit]</span><br><span class="hljs-attr">Description</span>=Run china-ip-blocker service <span class="hljs-literal">on</span> boot and daily<br><span class="hljs-section">[Timer]</span><br><span class="hljs-attr">OnBootSec</span>=<span class="hljs-number">2</span>min<br><span class="hljs-attr">OnUnitActiveSec</span>=<span class="hljs-number">12</span>h<br><span class="hljs-attr">Unit</span>=china-ip-blocker.service<br><span class="hljs-section">[Install]</span><br><span class="hljs-attr">WantedBy</span>=timers.target<br></code></pre></td></tr></table></figure><h3 id="主程序"><a href="#主程序" class="headerlink" title="主程序"></a>主程序</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br><span class="hljs-comment"># =================================================================</span><br><span class="hljs-comment">#  High-Performance, Low-Resource IP Blocklist Update Script</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment">#  Designed for execution via systemd timer or cron.</span><br><span class="hljs-comment">#  This script is non-persistent and relies on being run on boot</span><br><span class="hljs-comment">#  and periodically to maintain firewall rules.</span><br><span class="hljs-comment"># =================================================================</span><br><br><span class="hljs-built_in">set</span> -o errexit   <span class="hljs-comment"># Exit immediately if a command exits with a non-zero status.</span><br><span class="hljs-built_in">set</span> -o nounset   <span class="hljs-comment"># Exit immediately if it tries to use an undeclared variable.</span><br><span class="hljs-built_in">set</span> -o pipefail  <span class="hljs-comment"># The return value of a pipeline is the status of the last command to exit with a non-zero status.</span><br><br><span class="hljs-comment"># --- Configuration ---</span><br><span class="hljs-built_in">readonly</span> IPSET_NAME=<span class="hljs-string">&quot;chinablock&quot;</span><br><span class="hljs-built_in">readonly</span> IP_LIST_URL=<span class="hljs-string">&quot;https://www.ipdeny.com/ipblocks/data/countries/cn.zone&quot;</span><br><span class="hljs-built_in">readonly</span> TMP_FILE=<span class="hljs-string">&quot;/dev/shm/<span class="hljs-variable">$&#123;IPSET_NAME&#125;</span>.zone&quot;</span><br><span class="hljs-built_in">readonly</span> LOCK_FILE=<span class="hljs-string">&quot;/var/run/<span class="hljs-variable">$&#123;IPSET_NAME&#125;</span>.lock&quot;</span><br><span class="hljs-built_in">readonly</span> MIN_IP_COUNT=100 <span class="hljs-comment"># Minimum expected number of IP ranges</span><br><br><span class="hljs-comment"># Efficient logging function using bash printf built-in (&gt;= bash 4.2)</span><br><span class="hljs-function"><span class="hljs-title">log</span></span>() &#123;<br>    <span class="hljs-comment"># %-1s prints a single space. Using it to get printf to evaluate the format string.</span><br>    <span class="hljs-built_in">printf</span> <span class="hljs-string">&#x27;%(%Y-%m-%d %H:%M:%S)T - %s\n&#x27;</span> -1 <span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span><br>&#125;<br><br><span class="hljs-comment"># Centralized error-handling function</span><br><span class="hljs-function"><span class="hljs-title">die</span></span>() &#123;<br>    <span class="hljs-built_in">log</span> <span class="hljs-string">&quot;FATAL: <span class="hljs-variable">$1</span>&quot;</span> &gt;&amp;2<br>    <span class="hljs-built_in">exit</span> 1<br>&#125;<br><br><span class="hljs-function"><span class="hljs-title">main</span></span>() &#123;<br>    <span class="hljs-comment"># --- Prerequisite Checks ---</span><br>    <span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$&#123;EUID:-$(id -u)&#125;</span> -ne 0 ]]; <span class="hljs-keyword">then</span><br>        die <span class="hljs-string">&quot;This script must be run as root.&quot;</span><br>    <span class="hljs-keyword">fi</span><br><br>    <span class="hljs-keyword">for</span> cmd <span class="hljs-keyword">in</span> ipset wget iptables flock awk <span class="hljs-built_in">head</span> <span class="hljs-built_in">tail</span>; <span class="hljs-keyword">do</span><br>        <span class="hljs-keyword">if</span> ! <span class="hljs-built_in">command</span> -v <span class="hljs-string">&quot;<span class="hljs-variable">$cmd</span>&quot;</span> &amp;&gt;/dev/null; <span class="hljs-keyword">then</span><br>            die <span class="hljs-string">&quot;Required command &#x27;<span class="hljs-variable">$cmd</span>&#x27; is not found.&quot;</span><br>        <span class="hljs-keyword">fi</span><br>    <span class="hljs-keyword">done</span><br>    <br>    <span class="hljs-comment"># Ensure temporary file is cleaned up on any exit</span><br>    <span class="hljs-built_in">trap</span> <span class="hljs-string">&#x27;rm -f &quot;$TMP_FILE&quot;&#x27;</span> EXIT<br><br>    <span class="hljs-built_in">log</span> <span class="hljs-string">&quot;Starting IP blocklist update for set &#x27;<span class="hljs-variable">$IPSET_NAME</span>&#x27;...&quot;</span><br><br>    <span class="hljs-comment"># --- Download IP List ---</span><br>    <span class="hljs-built_in">log</span> <span class="hljs-string">&quot;Downloading IP list from <span class="hljs-variable">$IP_LIST_URL</span>...&quot;</span><br>    <span class="hljs-keyword">if</span> ! wget -q --<span class="hljs-built_in">timeout</span>=60 --tries=3 -O <span class="hljs-string">&quot;<span class="hljs-variable">$TMP_FILE</span>&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$IP_LIST_URL</span>&quot;</span>; <span class="hljs-keyword">then</span><br>        die <span class="hljs-string">&quot;Download failed from <span class="hljs-variable">$IP_LIST_URL</span>.&quot;</span><br>    <span class="hljs-keyword">fi</span><br><br>    <span class="hljs-comment"># --- Create and Load Temporary IPSet ---</span><br>    <span class="hljs-built_in">local</span> temp_ipset_name=<span class="hljs-string">&quot;<span class="hljs-variable">$&#123;IPSET_NAME&#125;</span>_temp&quot;</span><br>    ipset create <span class="hljs-string">&quot;<span class="hljs-variable">$temp_ipset_name</span>&quot;</span> <span class="hljs-built_in">hash</span>:net -exist<br>    ipset flush <span class="hljs-string">&quot;<span class="hljs-variable">$temp_ipset_name</span>&quot;</span><br><br>    <span class="hljs-built_in">log</span> <span class="hljs-string">&quot;Validating list and preparing for bulk load...&quot;</span><br>    <span class="hljs-comment"># Use a single awk pass to validate and generate restore data.</span><br>    <span class="hljs-comment"># It exits with an error code if the line count is too low.</span><br>    <span class="hljs-comment"># The last line of its output is the total count.</span><br>    <span class="hljs-built_in">local</span> awk_output<br>    awk_output=$(awk -v set_name=<span class="hljs-string">&quot;<span class="hljs-variable">$temp_ipset_name</span>&quot;</span> \<br>        <span class="hljs-string">&#x27;&#123; print &quot;add &quot; set_name &quot; &quot; $1 &#125; END &#123; if (NR &lt; &#x27;</span><span class="hljs-variable">$MIN_IP_COUNT</span><span class="hljs-string">&#x27;) exit 1; print NR &#125;&#x27;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$TMP_FILE</span>&quot;</span>) \<br>        || die <span class="hljs-string">&quot;IP list validation failed (expected &gt;<span class="hljs-variable">$MIN_IP_COUNT</span> lines, found <span class="hljs-subst">$(wc -l &lt; <span class="hljs-string">&quot;<span class="hljs-variable">$TMP_FILE</span>&quot;</span> | awk &#x27;&#123;print $1&#125;&#x27;)</span>).&quot;</span><br>    <br>    <span class="hljs-comment"># Pipe all but the last line (the count) to ipset restore for high-speed loading.</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$awk_output</span>&quot;</span> | <span class="hljs-built_in">head</span> -n -1 | ipset restore || die <span class="hljs-string">&quot;ipset restore command failed.&quot;</span><br>    <br>    <span class="hljs-built_in">local</span> final_count<br>    final_count=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$awk_output</span>&quot;</span> | <span class="hljs-built_in">tail</span> -n 1)<br>    <br>    <span class="hljs-built_in">log</span> <span class="hljs-string">&quot;Loaded <span class="hljs-variable">$final_count</span> IP blocks into temporary set &#x27;<span class="hljs-variable">$temp_ipset_name</span>&#x27;.&quot;</span><br><br>    <span class="hljs-comment"># --- Atomically Activate the New IPSet ---</span><br>    ipset create <span class="hljs-string">&quot;<span class="hljs-variable">$IPSET_NAME</span>&quot;</span> <span class="hljs-built_in">hash</span>:net -exist<br>    ipset swap <span class="hljs-string">&quot;<span class="hljs-variable">$temp_ipset_name</span>&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$IPSET_NAME</span>&quot;</span><br>    ipset destroy <span class="hljs-string">&quot;<span class="hljs-variable">$temp_ipset_name</span>&quot;</span><br>    <span class="hljs-built_in">log</span> <span class="hljs-string">&quot;Successfully updated and activated ipset &#x27;<span class="hljs-variable">$IPSET_NAME</span>&#x27;.&quot;</span><br><br>    <span class="hljs-comment"># --- Ensure IPTables Rule Exists ---</span><br>    <span class="hljs-comment"># This check is crucial because the rule is lost on reboot.</span><br>    <span class="hljs-keyword">if</span> ! iptables -C INPUT -m <span class="hljs-built_in">set</span> --match-set <span class="hljs-string">&quot;<span class="hljs-variable">$IPSET_NAME</span>&quot;</span> src -j DROP &amp;&gt;/dev/null; <span class="hljs-keyword">then</span><br>        <span class="hljs-built_in">log</span> <span class="hljs-string">&quot;iptables rule not found. Inserting it at the top of the INPUT chain...&quot;</span><br>        <span class="hljs-comment"># -I INPUT 1 ensures it&#x27;s one of the first rules evaluated, which is critical for performance.</span><br>        iptables -I INPUT 1 -m <span class="hljs-built_in">set</span> --match-set <span class="hljs-string">&quot;<span class="hljs-variable">$IPSET_NAME</span>&quot;</span> src -j DROP<br>        <span class="hljs-built_in">log</span> <span class="hljs-string">&quot;iptables rule for &#x27;<span class="hljs-variable">$IPSET_NAME</span>&#x27; added.&quot;</span><br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-built_in">log</span> <span class="hljs-string">&quot;iptables rule for &#x27;<span class="hljs-variable">$IPSET_NAME</span>&#x27; already exists.&quot;</span><br>    <span class="hljs-keyword">fi</span><br><br>    <span class="hljs-built_in">log</span> <span class="hljs-string">&quot;Update completed successfully.&quot;</span><br>&#125;<br><br><span class="hljs-comment"># --- Execution Wrapper ---</span><br><span class="hljs-comment"># Use flock for robust concurrency control. The lock is held on file descriptor 200.</span><br>(<br>    flock -n 200 || die <span class="hljs-string">&quot;Script is already running. Another instance holds the lock.&quot;</span><br>    main<br>) 200&gt;<span class="hljs-string">&quot;<span class="hljs-variable">$LOCK_FILE</span>&quot;</span><br><br><span class="hljs-built_in">exit</span> 0<br></code></pre></td></tr></table></figure><h2 id="使用方式"><a href="#使用方式" class="headerlink" title="使用方式"></a>使用方式</h2><h3 id="创建-systemd-Service-文件"><a href="#创建-systemd-Service-文件" class="headerlink" title="创建 systemd Service 文件"></a>创建 <code>systemd</code> Service 文件</h3><p>在 <code>/etc/systemd/system/</code> 目录下创建 <code>china-ip-blocker.service</code>。</p><h3 id="创建-systemd-Timer-文件"><a href="#创建-systemd-Timer-文件" class="headerlink" title="创建 systemd Timer 文件"></a>创建 <code>systemd</code> Timer 文件</h3><p>这个文件定义了触发上述 <code>service</code> 的时间和频率。</p><p>在 <code>/etc/systemd/system/</code> 目录下创建一个与 <code>service</code> 文件同名（但后缀不同）的 <code>china-ip-blocker.timer</code> 文件。</p><h3 id="部署和启用"><a href="#部署和启用" class="headerlink" title="部署和启用"></a>部署和启用</h3><ol><li><p><strong>放置脚本</strong>：将脚本（例如 <code>update_china_blocklist.sh</code>）放置到一个合适的位置，比如 <code>/usr/local/bin/</code>，并确保它有可执行权限。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> <span class="hljs-built_in">chmod</span> +x /usr/local/bin/update_china_blocklist.sh<br></code></pre></td></tr></table></figure></li><li><p><strong>重载 <code>systemd</code> 配置</strong>：让 <code>systemd</code> 知道你创建了新的单元文件。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> systemctl daemon-reload<br></code></pre></td></tr></table></figure></li><li><p><strong>启用并启动定时器</strong>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> systemctl <span class="hljs-built_in">enable</span> china-ip-blocker.timer<br><span class="hljs-built_in">sudo</span> systemctl start china-ip-blocker.timer<br></code></pre></td></tr></table></figure><ul><li><code>enable</code> 会让定时器开机自启。</li><li><code>start</code> 会立即激活定时器，让它开始计时。</li><li><strong>注意</strong>：你只需要 <code>enable</code> 和 <code>start</code> <code>.timer</code> 文件，它会自动管理 <code>.service</code> 文件。</li></ul></li></ol><h3 id="管理和调试"><a href="#管理和调试" class="headerlink" title="管理和调试"></a>管理和调试</h3><ul><li><p><strong>查看定时器状态</strong>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">systemctl status china-ip-blocker.timer<br></code></pre></td></tr></table></figure><p>输出会显示 <code>NEXT</code>（下一次运行时间）。</p></li><li><p><strong>查看服务运行日志</strong>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">journalctl -u china-ip-blocker.service<br></code></pre></td></tr></table></figure><p>这会显示脚本的所有输出和错误信息，比传统的日志文件管理更方便。</p></li><li><p><strong>手动触发一次任务</strong>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> systemctl start china-ip-blocker.service<br></code></pre></td></tr></table></figure></li></ul><h2 id="检查生效"><a href="#检查生效" class="headerlink" title="检查生效"></a>检查生效</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@nagasaki-soyo:/home/tokisaki# <span class="hljs-built_in">sudo</span> ipset list chinablock<br>Name: chinablock<br>Type: <span class="hljs-built_in">hash</span>:net<br>Revision: 7<br>Header: family inet hashsize 2048 maxelem 65536 bucketsize 12 initval 0xc19a419f<br>Size <span class="hljs-keyword">in</span> memory: 233664<br>References: 1<br>Number of entries: 8711<br>Members:<br>58.240.0.0/15<br>103.3.100.0/22<br>...<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@nagasaki-soyo:/home/tokisaki# <span class="hljs-built_in">sudo</span> iptables -L INPUT -n -v<br>Chain INPUT (policy DROP 619 packets, 41086 bytes)<br> pkts bytes target     prot opt <span class="hljs-keyword">in</span>     out     <span class="hljs-built_in">source</span>               destination<br> 5345  916K DROP       0    --  *      *       0.0.0.0/0            0.0.0.0/0            match-set chinablock src<br> 492K  168M ts-input   0    --  *      *       0.0.0.0/0            0.0.0.0/0<br> 355K  138M ufw-before-logging-input  0    --  *      *       0.0.0.0/0            0.0.0.0/0<br> 355K  138M ufw-before-input  0    --  *      *       0.0.0.0/0            0.0.0.0/0<br>  627 41710 ufw-after-input  0    --  *      *       0.0.0.0/0            0.0.0.0/0<br>  619 41086 ufw-after-logging-input  0    --  *      *       0.0.0.0/0            0.0.0.0/0<br>  619 41086 ufw-reject-input  0    --  *      *       0.0.0.0/0            0.0.0.0/0<br>  619 41086 ufw-track-input  0    --  *      *       0.0.0.0/0            0.0.0.0/0<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 服务器运维 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> iptables </tag>
            
            <tag> ipset </tag>
            
            <tag> systemd </tag>
            
            <tag> Google Cloud </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Resolving Routing Conflicts Between Tailscale and ZeroTier on OpenWrt/Linux (IPProto-44)</title>
      <link href="/blog/resolve-route-conflict-zerotier-tailscale/"/>
      <url>/blog/resolve-route-conflict-zerotier-tailscale/</url>
      
        <content type="html"><![CDATA[<script>window._zh_title = "Openwrt或Linux上Tailscale与ZeroTier的路由冲突IPProto-44";window._en_title = "Resolving Routing Conflicts Between Tailscale and ZeroTier on OpenWrt/Linux (IPProto-44)";</script><div class="hexo-llm-zh"><p>因为有时候tailscale和zerotier都不太稳定，所以我在OpenWrt上同时使用了这两个VPN。平时主要用tailscale，zerotier作为应急有时候有奇效。</p><h3 id="问题的浮现：神秘的丢包日志"><a href="#问题的浮现：神秘的丢包日志" class="headerlink" title="问题的浮现：神秘的丢包日志"></a>问题的浮现：神秘的丢包日志</h3><p>一切始于一个看似无关的现象。在检查 OpenWrt 的系统日志时，我反复看到由 <code>tailscaled</code>（Tailscale 的守护进程）打印出的错误信息：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs log">Fri Jul 11 21:10:43 2025 daemon.err tailscaled[3274]: Drop: IPProto-44&#123;[fd7a:...] &gt; [fd7a:...]&#125; ... unknown-protocol-44<br>Fri Jul 11 21:10:53 2025 daemon.err tailscaled[3274]: [RATELIMIT] format(&quot;%s: %s %d %s\n%s&quot;) (8 dropped)<br></code></pre></td></tr></table></figure><p>日志显示 Tailscale 正在丢弃一种它不认识的协议（<code>IPProto-44</code>）的数据包，来源和目的地都是我网络内的设备。更奇怪的是，这些流量似乎与 Tailscale 本身无关。经过排查，元凶很快就锁定了——这些“异常流量”正是我的 ZeroTier 客户端为了连接其 Moon 中继服务器而发出的。</p><h3 id="深入分析，路由表？"><a href="#深入分析，路由表？" class="headerlink" title="深入分析，路由表？"></a>深入分析，路由表？</h3><p>为什么 ZeroTier 的流量会跑到 Tailscale 的地盘上呢？答案藏在路由规则里。</p><p>通过 SSH 登录到 OpenWrt 并执行 <code>ip rule show</code>，我们看到了问题的关键：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ImmortalWrt:~# ip rule show<br>0:      from all lookup <span class="hljs-built_in">local</span><br>...<br>5270:   from all lookup 52<br>32766:  from all lookup main<br>...<br></code></pre></td></tr></table></figure><p>Linux 的路由规则是按优先级（<code>prio</code>，数字越小优先级越高）执行的。这段输出告诉我们：<br>系统会先检查是不是发给路由器自己的流量 (<code>lookup local</code>)。如果不是，它会去检查一个优先级为 <code>5270</code> 的规则，这条规则说：“<strong>所有流量，都先去查阅路由表 <code>52</code></strong>”。路由表 <code>52</code> 是 Tailscale 安装时创建的专属路由表，里面只有通往其他 Tailscale 节点的路由。只有在路由表 <code>52</code> 里也找不到路时，流量才会继续往下，去查询优先级更低的 <code>main</code> 主路由表（我们正常的互联网出口就在这里）。</p><p><strong>结论显而易见：Tailscale 设置了一条过于“霸道”的高优先级规则，把所有从路由器发出的流量（包括 ZeroTier 的）都“劫持”了。当 ZeroTier 的特殊数据包被导向 Tailscale 的网络时，不认识它的 Tailscale 自然就选择丢弃。</strong></p><h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3><p>要解决这个问题，我们不能粗暴地修改 Tailscale 的规则，而是应该为 ZeroTier 建立一条优先级更高的“专属通道”。</p><p><strong>我们的策略是：</strong> 创建一条新的路由规则，明确告诉系统：“<strong>凡是从 ZeroTier 虚拟网卡发出的流量，请直接走 <code>main</code> 主路由表</strong>”，并确保这条规则的优先级高于 Tailscale 的 <code>5270</code>。</p><h4 id="Openwrt脚本与使用"><a href="#Openwrt脚本与使用" class="headerlink" title="Openwrt脚本与使用"></a>Openwrt脚本与使用</h4><h5 id="第一步：（推荐）安装完整版-ip-工具"><a href="#第一步：（推荐）安装完整版-ip-工具" class="headerlink" title="第一步：（推荐）安装完整版 ip 工具"></a>第一步：（推荐）安装完整版 <code>ip</code> 工具</h5><p>OpenWrt 自带的 <code>ip</code> 命令功能可能不全。安装 <code>ip-full</code> 可以避免很多疑难杂症。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">opkg update<br>opkg install ip-full<br></code></pre></td></tr></table></figure><h5 id="第二步：创建服务脚本"><a href="#第二步：创建服务脚本" class="headerlink" title="第二步：创建服务脚本"></a>第二步：创建服务脚本</h5><p>使用 <code>vi</code> 或 <code>nano</code> 创建一个新的服务文件。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nano /etc/init.d/zerotier-policy-route<br></code></pre></td></tr></table></figure><p>将下面的完整脚本代码粘贴到你打开的文件中。</p><div class="note note-warning">            <p>请根据你的实际情况，修改 <code>ZT_IFACE</code> 变量的值。你可以通过 <code>ifconfig | grep zt</code> 命令找到你的 ZeroTier 网卡名称。</p>           </div><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-meta">#!/bin/sh /etc/rc.common</span><br><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># This script creates policy routing rules for ZeroTier to coexist with Tailscale.</span><br><span class="hljs-comment"># It prevents ZeroTier&#x27;s traffic from being intercepted by Tailscale&#x27;s high-priority rule.</span><br><span class="hljs-comment"># Version 3: Intelligently handles IPv4 and IPv6 addresses.</span><br><span class="hljs-comment">#</span><br><br>START=99<br>STOP=15<br><br><span class="hljs-comment"># --- CONFIGURATION ---</span><br><span class="hljs-comment"># The name of your ZeroTier virtual network interface. Find it with `ifconfig | grep zt`.</span><br>ZT_IFACE=<span class="hljs-string">&quot;ztypia4gba&quot;</span><br><br><span class="hljs-comment"># The priority for the new routing rule. Must be lower (higher priority) than Tailscale&#x27;s (usually 5270).</span><br>RULE_PRIO=<span class="hljs-string">&quot;5260&quot;</span><br><br><span class="hljs-comment"># Tag for system log entries.</span><br>LOG_TAG=<span class="hljs-string">&quot;zerotier-policy-route&quot;</span><br><span class="hljs-comment"># --- END CONFIGURATION ---</span><br><br><span class="hljs-function"><span class="hljs-title">add_rules</span></span>() &#123;<br>    <span class="hljs-comment"># Get all global/unique IP addresses (v4 and v6), excluding link-local (fe80::) addresses.</span><br>    IP_LIST=$(ip addr show dev <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;ZT_IFACE&#125;</span>&quot;</span> | grep -E <span class="hljs-string">&#x27;inet|inet6&#x27;</span> | grep -v <span class="hljs-string">&#x27; fe80::&#x27;</span> | awk <span class="hljs-string">&#x27;&#123;print $2&#125;&#x27;</span> | <span class="hljs-built_in">cut</span> -d<span class="hljs-string">&#x27;/&#x27;</span> -f1)<br><br>    <span class="hljs-keyword">if</span> [ -z <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;IP_LIST&#125;</span>&quot;</span> ]; <span class="hljs-keyword">then</span><br>        logger -t <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;LOG_TAG&#125;</span>&quot;</span> <span class="hljs-string">&quot;Warning: No usable IP addresses found on interface <span class="hljs-variable">$&#123;ZT_IFACE&#125;</span>.&quot;</span><br>        <span class="hljs-built_in">return</span><br>    <span class="hljs-keyword">fi</span><br><br>    <span class="hljs-keyword">for</span> ip <span class="hljs-keyword">in</span> <span class="hljs-variable">$&#123;IP_LIST&#125;</span>; <span class="hljs-keyword">do</span><br>        <span class="hljs-comment"># Check if a rule for this IP already exists to avoid duplication.</span><br>        <span class="hljs-keyword">if</span> ! ip rule | grep -q <span class="hljs-string">&quot;from <span class="hljs-variable">$&#123;ip&#125;</span> lookup main&quot;</span>; <span class="hljs-keyword">then</span><br>            logger -t <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;LOG_TAG&#125;</span>&quot;</span> <span class="hljs-string">&quot;Adding rule for <span class="hljs-variable">$&#123;ip&#125;</span> with priority <span class="hljs-variable">$&#123;RULE_PRIO&#125;</span>.&quot;</span><br>            <br>            <span class="hljs-comment"># CRITICAL FIX: Use the &#x27;-6&#x27; flag for IPv6 addresses.</span><br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;ip&#125;</span>&quot;</span> | grep -q <span class="hljs-string">&quot;:&quot;</span>; <span class="hljs-keyword">then</span><br>                ip -6 rule add from <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;ip&#125;</span>&quot;</span> lookup main prio <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;RULE_PRIO&#125;</span>&quot;</span><br>            <span class="hljs-keyword">else</span><br>                ip rule add from <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;ip&#125;</span>&quot;</span> lookup main prio <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;RULE_PRIO&#125;</span>&quot;</span><br>            <span class="hljs-keyword">fi</span><br>        <span class="hljs-keyword">else</span><br>            logger -t <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;LOG_TAG&#125;</span>&quot;</span> <span class="hljs-string">&quot;Rule for <span class="hljs-variable">$&#123;ip&#125;</span> already exists. Skipping.&quot;</span><br>        <span class="hljs-keyword">fi</span><br>    <span class="hljs-keyword">done</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-title">remove_rules</span></span>() &#123;<br>    IP_LIST=$(ip addr show dev <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;ZT_IFACE&#125;</span>&quot;</span> | grep -E <span class="hljs-string">&#x27;inet|inet6&#x27;</span> | grep -v <span class="hljs-string">&#x27; fe80::&#x27;</span> | awk <span class="hljs-string">&#x27;&#123;print $2&#125;&#x27;</span> | <span class="hljs-built_in">cut</span> -d<span class="hljs-string">&#x27;/&#x27;</span> -f1)<br>    <span class="hljs-keyword">if</span> [ -z <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;IP_LIST&#125;</span>&quot;</span> ]; <span class="hljs-keyword">then</span> <span class="hljs-built_in">return</span>; <span class="hljs-keyword">fi</span><br><br>    <span class="hljs-keyword">for</span> ip <span class="hljs-keyword">in</span> <span class="hljs-variable">$&#123;IP_LIST&#125;</span>; <span class="hljs-keyword">do</span><br>        <span class="hljs-keyword">if</span> ip rule | grep -q <span class="hljs-string">&quot;from <span class="hljs-variable">$&#123;ip&#125;</span> lookup main&quot;</span>; <span class="hljs-keyword">then</span><br>            logger -t <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;LOG_TAG&#125;</span>&quot;</span> <span class="hljs-string">&quot;Removing rule for <span class="hljs-variable">$&#123;ip&#125;</span>.&quot;</span><br><br>            <span class="hljs-comment"># Use the &#x27;-6&#x27; flag for deletion of IPv6 rules as well.</span><br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;ip&#125;</span>&quot;</span> | grep -q <span class="hljs-string">&quot;:&quot;</span>; <span class="hljs-keyword">then</span><br>                ip -6 rule del from <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;ip&#125;</span>&quot;</span> lookup main prio <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;RULE_PRIO&#125;</span>&quot;</span><br>            <span class="hljs-keyword">else</span><br>                ip rule del from <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;ip&#125;</span>&quot;</span> lookup main prio <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;RULE_PRIO&#125;</span>&quot;</span><br>            <span class="hljs-keyword">fi</span><br>        <span class="hljs-keyword">fi</span><br>    <span class="hljs-keyword">done</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-title">start</span></span>() &#123;<br>    logger -t <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;LOG_TAG&#125;</span>&quot;</span> <span class="hljs-string">&quot;Service starting, applying rules...&quot;</span><br>    add_rules<br>&#125;<br><br><span class="hljs-function"><span class="hljs-title">stop</span></span>() &#123;<br>    logger -t <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;LOG_TAG&#125;</span>&quot;</span> <span class="hljs-string">&quot;Service stopping, removing rules...&quot;</span><br>    remove_rules<br>&#125;<br><br><span class="hljs-function"><span class="hljs-title">reload</span></span>() &#123;<br>    logger -t <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;LOG_TAG&#125;</span>&quot;</span> <span class="hljs-string">&quot;Service reloading...&quot;</span><br>    stop<br>    start<br>&#125;<br></code></pre></td></tr></table></figure><h5 id="第三步：授权并启用服务"><a href="#第三步：授权并启用服务" class="headerlink" title="第三步：授权并启用服务"></a>第三步：授权并启用服务</h5><p>保存文件后，在终端执行以下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 赋予脚本执行权限</span><br><span class="hljs-built_in">chmod</span> +x /etc/init.d/zerotier-policy-route<br><br><span class="hljs-comment"># 启用服务，让它开机自启</span><br>/etc/init.d/zerotier-policy-route <span class="hljs-built_in">enable</span><br><br><span class="hljs-comment"># 立即启动服务以应用规则</span><br>/etc/init.d/zerotier-policy-route start<br></code></pre></td></tr></table></figure><h5 id="第四步：验证成果"><a href="#第四步：验证成果" class="headerlink" title="第四步：验证成果"></a>第四步：验证成果</h5><p>执行 <code>ip rule show</code>，你将看到类似下面的输出，我们为 ZeroTier 的每个 IP 添加的 <code>5260</code> 规则已经稳稳地待在了 Tailscale 的规则之上。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">0</span>:      <span class="hljs-keyword">from</span> <span class="hljs-keyword">all</span> lookup <span class="hljs-keyword">local</span><br>...<br><span class="hljs-number">5260</span>:   <span class="hljs-keyword">from</span> <span class="hljs-number">172.27</span><span class="hljs-number">.72</span><span class="hljs-number">.251</span> lookup main<br><span class="hljs-number">5260</span>:   <span class="hljs-keyword">from</span> fddd:ec77:... lookup main<br><span class="hljs-number">5260</span>:   <span class="hljs-keyword">from</span> fce1:<span class="hljs-number">9571</span>:... lookup main<br><span class="hljs-number">5270</span>:   <span class="hljs-keyword">from</span> <span class="hljs-keyword">all</span> lookup <span class="hljs-number">52</span><br>...<br></code></pre></td></tr></table></figure><h4 id="Linux服务器脚本与使用"><a href="#Linux服务器脚本与使用" class="headerlink" title="Linux服务器脚本与使用"></a>Linux服务器脚本与使用</h4><p>由于Openwrt出现这个提示，必然tailscale虚拟局域网中有另一台Linux服务器也安装了Tailscale和ZeroTier。我们可以将上面的脚本稍作修改，适用于其他Linux发行版。</p><h5 id="策略路由脚本"><a href="#策略路由脚本" class="headerlink" title="策略路由脚本"></a>策略路由脚本</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> nano /usr/local/sbin/zerotier-policy-route.sh<br></code></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-meta">#!/bin/bash</span><br><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># This script creates policy routing rules for all ZeroTier interfaces</span><br><span class="hljs-comment"># to coexist with Tailscale on a Debian-based system.</span><br><span class="hljs-comment">#</span><br><br><span class="hljs-built_in">set</span> -e <span class="hljs-comment"># Exit immediately if a command exits with a non-zero status.</span><br><br><span class="hljs-comment"># --- CONFIGURATION ---</span><br><span class="hljs-comment"># The priority for the new routing rule.</span><br><span class="hljs-comment"># This MUST be a lower number (higher priority) than Tailscale&#x27;s rule (usually 5270).</span><br>RULE_PRIO=<span class="hljs-string">&quot;5260&quot;</span><br>LOG_TAG=<span class="hljs-string">&quot;zerotier-policy-route&quot;</span><br><span class="hljs-comment"># --- END CONFIGURATION ---</span><br><br><span class="hljs-comment"># Find all ZeroTier network interfaces (names starting with &#x27;zt&#x27;).</span><br><span class="hljs-comment"># We use `ip -o link show` for a stable, one-line-per-interface output.</span><br>ZT_INTERFACES=$(ip -o <span class="hljs-built_in">link</span> show | awk -F<span class="hljs-string">&#x27;: &#x27;</span> <span class="hljs-string">&#x27;&#123;print $2&#125;&#x27;</span> | grep <span class="hljs-string">&#x27;^zt&#x27;</span>)<br><br><span class="hljs-keyword">if</span> [ -z <span class="hljs-string">&quot;<span class="hljs-variable">$ZT_INTERFACES</span>&quot;</span> ]; <span class="hljs-keyword">then</span><br>    logger -t <span class="hljs-string">&quot;<span class="hljs-variable">$LOG_TAG</span>&quot;</span> <span class="hljs-string">&quot;No ZeroTier interfaces found. Exiting.&quot;</span><br>    <span class="hljs-built_in">exit</span> 0<br><span class="hljs-keyword">fi</span><br><br><span class="hljs-comment"># Function to add rules for all found interfaces</span><br><span class="hljs-function"><span class="hljs-title">add_rules</span></span>() &#123;<br>    logger -t <span class="hljs-string">&quot;<span class="hljs-variable">$LOG_TAG</span>&quot;</span> <span class="hljs-string">&quot;Applying policy routing rules...&quot;</span><br>    <span class="hljs-keyword">for</span> iface <span class="hljs-keyword">in</span> <span class="hljs-variable">$ZT_INTERFACES</span>; <span class="hljs-keyword">do</span><br>        <span class="hljs-comment"># Get all global/unique IP addresses (v4 and v6), excluding link-local (fe80::)</span><br>        IP_LIST=$(ip addr show dev <span class="hljs-string">&quot;<span class="hljs-variable">$iface</span>&quot;</span> | grep -E <span class="hljs-string">&#x27;inet|inet6&#x27;</span> | grep -v <span class="hljs-string">&#x27;fe80::&#x27;</span> | awk <span class="hljs-string">&#x27;&#123;print $2&#125;&#x27;</span> | <span class="hljs-built_in">cut</span> -d<span class="hljs-string">&#x27;/&#x27;</span> -f1)<br>        <br>        <span class="hljs-keyword">if</span> [ -z <span class="hljs-string">&quot;<span class="hljs-variable">$IP_LIST</span>&quot;</span> ]; <span class="hljs-keyword">then</span><br>            logger -t <span class="hljs-string">&quot;<span class="hljs-variable">$LOG_TAG</span>&quot;</span> <span class="hljs-string">&quot;No usable IP addresses on interface <span class="hljs-variable">$iface</span>. Skipping.&quot;</span><br>            <span class="hljs-built_in">continue</span><br>        <span class="hljs-keyword">fi</span><br><br>        <span class="hljs-keyword">for</span> ip <span class="hljs-keyword">in</span> <span class="hljs-variable">$IP_LIST</span>; <span class="hljs-keyword">do</span><br>            <span class="hljs-comment"># Only add the rule if it doesn&#x27;t already exist.</span><br>            <span class="hljs-keyword">if</span> ! ip rule | grep -q <span class="hljs-string">&quot;from <span class="hljs-variable">$ip</span> lookup main&quot;</span>; <span class="hljs-keyword">then</span><br>                logger -t <span class="hljs-string">&quot;<span class="hljs-variable">$LOG_TAG</span>&quot;</span> <span class="hljs-string">&quot;Adding rule for <span class="hljs-variable">$ip</span> (on <span class="hljs-variable">$iface</span>) with priority <span class="hljs-variable">$RULE_PRIO</span>.&quot;</span><br>                <span class="hljs-comment"># Use the &#x27;-6&#x27; flag for IPv6 addresses.</span><br>                <span class="hljs-keyword">if</span> [[ <span class="hljs-string">&quot;<span class="hljs-variable">$ip</span>&quot;</span> == *<span class="hljs-string">&quot;:&quot;</span>* ]]; <span class="hljs-keyword">then</span><br>                    ip -6 rule add from <span class="hljs-string">&quot;<span class="hljs-variable">$ip</span>&quot;</span> lookup main prio <span class="hljs-string">&quot;<span class="hljs-variable">$RULE_PRIO</span>&quot;</span><br>                <span class="hljs-keyword">else</span><br>                    ip rule add from <span class="hljs-string">&quot;<span class="hljs-variable">$ip</span>&quot;</span> lookup main prio <span class="hljs-string">&quot;<span class="hljs-variable">$RULE_PRIO</span>&quot;</span><br>                <span class="hljs-keyword">fi</span><br>            <span class="hljs-keyword">fi</span><br>        <span class="hljs-keyword">done</span><br>    <span class="hljs-keyword">done</span><br>&#125;<br><br><span class="hljs-comment"># Function to remove rules for all found interfaces</span><br><span class="hljs-function"><span class="hljs-title">remove_rules</span></span>() &#123;<br>    logger -t <span class="hljs-string">&quot;<span class="hljs-variable">$LOG_TAG</span>&quot;</span> <span class="hljs-string">&quot;Removing policy routing rules...&quot;</span><br>    <span class="hljs-comment"># We need to find all possible IPs that could have had rules.</span><br>    <span class="hljs-comment"># It&#x27;s safer to just try deleting any rule with our priority.</span><br>    <span class="hljs-comment"># This is simpler and more robust than tracking IPs.</span><br>    <span class="hljs-keyword">while</span> ip rule | grep -q <span class="hljs-string">&quot;prio <span class="hljs-variable">$RULE_PRIO</span>&quot;</span>; <span class="hljs-keyword">do</span><br>        <span class="hljs-comment"># Find the first rule with our priority and delete it. Loop until none are left.</span><br>        RULE_TO_DELETE=$(ip rule | grep <span class="hljs-string">&quot;prio <span class="hljs-variable">$RULE_PRIO</span>&quot;</span> | <span class="hljs-built_in">head</span> -n 1)<br>        logger -t <span class="hljs-string">&quot;<span class="hljs-variable">$LOG_TAG</span>&quot;</span> <span class="hljs-string">&quot;Deleting rule: <span class="hljs-variable">$RULE_TO_DELETE</span>&quot;</span><br>        <span class="hljs-comment"># Re-construct the delete command from the rule string.</span><br>        ip rule del <span class="hljs-variable">$&#123;RULE_TO_DELETE&#125;</span><br>    <span class="hljs-keyword">done</span><br>&#125;<br><br><span class="hljs-comment"># Main command logic</span><br><span class="hljs-keyword">case</span> <span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span> <span class="hljs-keyword">in</span><br>    start)<br>        add_rules<br>        ;;<br>    stop)<br>        remove_rules<br>        ;;<br>    restart)<br>        remove_rules<br>        add_rules<br>        ;;<br>    *)<br>        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Usage: <span class="hljs-variable">$0</span> &#123;start|stop|restart&#125;&quot;</span><br>        <span class="hljs-built_in">exit</span> 1<br>        ;;<br><span class="hljs-keyword">esac</span><br><br><span class="hljs-built_in">exit</span> 0<br></code></pre></td></tr></table></figure><p>最后记得加上权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> <span class="hljs-built_in">chmod</span> +x /usr/local/sbin/zerotier-policy-route.sh<br></code></pre></td></tr></table></figure><h4 id="自启动服务脚本"><a href="#自启动服务脚本" class="headerlink" title="自启动服务脚本"></a>自启动服务脚本</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> nano /etc/systemd/system/zerotier-policy-route.service<br></code></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs sh">[Unit]<br>Description=ZeroTier Policy Routing Fix <span class="hljs-keyword">for</span> Tailscale Coexistence<br>After=network-online.target<br>Wants=network-online.target<br>After=zerotier-one.service tailscaled.service<br><br>[Service]<br>Type=oneshot<br>RemainAfterExit=<span class="hljs-built_in">yes</span><br>ExecStart=/usr/local/sbin/zerotier-policy-route.sh start<br>ExecStop=/usr/local/sbin/zerotier-policy-route.sh stop<br><br>[Install]<br>WantedBy=multi-user.target<br></code></pre></td></tr></table></figure><p>最后，要启动服务。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> systemctl <span class="hljs-built_in">enable</span> zerotier-policy-route.service<br><span class="hljs-built_in">sudo</span> systemctl start zerotier-policy-route.service<br></code></pre></td></tr></table></figure><p>可以验证一下<code>ip rule show</code>，应该可以看到下面这样</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">0</span>:      <span class="hljs-keyword">from</span> <span class="hljs-keyword">all</span> lookup <span class="hljs-keyword">local</span><br><span class="hljs-number">5210</span>:   <span class="hljs-keyword">from</span> <span class="hljs-keyword">all</span> fwmark <span class="hljs-number">0x80000</span><span class="hljs-operator">/</span><span class="hljs-number">0xff0000</span> lookup main<br><span class="hljs-number">5230</span>:   <span class="hljs-keyword">from</span> <span class="hljs-keyword">all</span> fwmark <span class="hljs-number">0x80000</span><span class="hljs-operator">/</span><span class="hljs-number">0xff0000</span> lookup <span class="hljs-keyword">default</span><br><span class="hljs-number">5250</span>:   <span class="hljs-keyword">from</span> <span class="hljs-keyword">all</span> fwmark <span class="hljs-number">0x80000</span><span class="hljs-operator">/</span><span class="hljs-number">0xff0000</span> unreachable<br><span class="hljs-number">5260</span>:   <span class="hljs-keyword">from</span> <span class="hljs-number">172.27</span><span class="hljs-number">.72</span><span class="hljs-number">.101</span> lookup main  <span class="hljs-operator">&lt;</span><span class="hljs-comment">--</span><br><span class="hljs-number">5260</span>:   <span class="hljs-keyword">from</span> <span class="hljs-number">172.27</span><span class="hljs-number">.62</span><span class="hljs-number">.101</span> lookup main  <span class="hljs-operator">&lt;</span><span class="hljs-comment">--</span><br><span class="hljs-number">5260</span>:   <span class="hljs-keyword">from</span> <span class="hljs-number">172.27</span><span class="hljs-number">.71</span><span class="hljs-number">.101</span> lookup main  <span class="hljs-operator">&lt;</span><span class="hljs-comment">--</span><br><span class="hljs-number">5270</span>:   <span class="hljs-keyword">from</span> <span class="hljs-keyword">all</span> lookup <span class="hljs-number">52</span><br><span class="hljs-number">32766</span>:  <span class="hljs-keyword">from</span> <span class="hljs-keyword">all</span> lookup main<br><span class="hljs-number">32767</span>:  <span class="hljs-keyword">from</span> <span class="hljs-keyword">all</span> lookup <span class="hljs-keyword">default</span><br></code></pre></td></tr></table></figure><p>同时，<code>logread</code> 中烦人的丢包日志也从此消失了。</p></div><div class="hexo-llm-en"><p>To ensure network reliability, I run both Tailscale and ZeroTier on my OpenWrt router. I primarily use Tailscale, but ZeroTier serves as an excellent failover that works wonders when Tailscale struggles with connectivity.</p><h3 id="The-Symptom-Mysterious-Packet-Drop-Logs"><a href="#The-Symptom-Mysterious-Packet-Drop-Logs" class="headerlink" title="The Symptom: Mysterious Packet Drop Logs"></a>The Symptom: Mysterious Packet Drop Logs</h3><p>It all started with a seemingly minor anomaly. While checking the OpenWrt system logs, I noticed recurring error messages printed by <code>tailscaled</code> (the Tailscale daemon):</p><pre><code class="language-log">Fri Jul 11 21:10:43 2025 daemon.err tailscaled[3274]: Drop: IPProto-44&#123;[fd7a:...] &gt; [fd7a:...]&#125; ... unknown-protocol-44Fri Jul 11 21:10:53 2025 daemon.err tailscaled[3274]: [RATELIMIT] format(&quot;%s: %s %d %s\n%s&quot;) (8 dropped)</code></pre><p>The logs indicated that Tailscale was dropping packets of a protocol it didn’t recognize (<code>IPProto-44</code>). Both the source and destination IPs belonged to devices within my internal network. Even stranger, this traffic appeared unrelated to Tailscale itself. After some troubleshooting, I identified the culprit: these “abnormal” packets were actually generated by the ZeroTier client attempting to communicate with its Moon relay servers.</p><h3 id="Deep-Dive-It’s-the-Routing-Table"><a href="#Deep-Dive-It’s-the-Routing-Table" class="headerlink" title="Deep Dive: It’s the Routing Table"></a>Deep Dive: It’s the Routing Table</h3><p>Why was ZeroTier traffic leaking into Tailscale’s domain? The answer lies in the Linux routing rules.</p><p>By SSHing into the OpenWrt instance and running <code>ip rule show</code>, the root cause became clear:</p><pre><code class="language-bash">root@ImmortalWrt:~# ip rule show0:      from all lookup local...5270:   from all lookup 5232766:  from all lookup main...</code></pre><p>Linux routing rules are executed based on priority (<code>prio</code>), where a lower number indicates higher priority. This output reveals the following logic:<br>The system first checks if the traffic is destined for the router itself (<code>lookup local</code>). If not, it moves to the rule with priority <code>5270</code>. This rule states: “<strong>For all traffic, first check routing table 52</strong>.” Table <code>52</code> is a dedicated routing table created by Tailscale upon installation, which only contains routes to other Tailscale nodes. Only if no match is found in table <code>52</code> does the traffic proceed to the <code>main</code> routing table (where our standard internet gateway resides).</p><p><strong>The conclusion is obvious: Tailscale implements an “aggressive” high-priority rule that intercepts all outgoing traffic from the router, including ZeroTier’s. When ZeroTier’s specific signaling packets are forced into the Tailscale network, Tailscale—unfamiliar with the protocol—simply drops them.</strong></p><h3 id="The-Solution"><a href="#The-Solution" class="headerlink" title="The Solution"></a>The Solution</h3><p>To resolve this, we shouldn’t modify Tailscale’s rules directly, as they are managed by the daemon. Instead, we should establish a “dedicated bypass” for ZeroTier with an even higher priority.</p><p><strong>Our strategy:</strong> Create a new routing rule that explicitly tells the system: “<strong>Any traffic originating from a ZeroTier virtual interface must look up the <code>main</code> routing table directly</strong>,” ensuring this rule has a higher priority (a lower number) than Tailscale’s <code>5270</code>.</p><h4 id="Implementation-on-OpenWrt"><a href="#Implementation-on-OpenWrt" class="headerlink" title="Implementation on OpenWrt"></a>Implementation on OpenWrt</h4><h5 id="Step-1-Recommended-Install-the-Full-ip-Utility"><a href="#Step-1-Recommended-Install-the-Full-ip-Utility" class="headerlink" title="Step 1: (Recommended) Install the Full ip Utility"></a>Step 1: (Recommended) Install the Full <code>ip</code> Utility</h5><p>The default <code>ip</code> command in OpenWrt (provided by busybox) may lack certain features. Installing <code>ip-full</code> prevents various compatibility issues.</p><pre><code class="language-bash">opkg updateopkg install ip-full</code></pre><h5 id="Step-2-Create-the-Service-Script"><a href="#Step-2-Create-the-Service-Script" class="headerlink" title="Step 2: Create the Service Script"></a>Step 2: Create the Service Script</h5><p>Create a new init script using <code>vi</code> or <code>nano</code>.</p><pre><code class="language-bash">nano /etc/init.d/zerotier-policy-route</code></pre><p>Paste the following script into the file.</p><div class="note note-warning">            <p>Please modify the <code>ZT_IFACE</code> variable to match your environment. You can find your ZeroTier interface name by running <code>ifconfig | grep zt</code>.</p>           </div><pre><code class="language-sh">#!/bin/sh /etc/rc.common## This script creates policy routing rules for ZeroTier to coexist with Tailscale.# It prevents ZeroTier&#39;s traffic from being intercepted by Tailscale&#39;s high-priority rule.# Version 3: Intelligently handles IPv4 and IPv6 addresses.#START=99STOP=15# --- CONFIGURATION ---# The name of your ZeroTier virtual network interface. Find it with `ifconfig | grep zt`.ZT_IFACE=&quot;ztypia4gba&quot;# The priority for the new routing rule. Must be lower (higher priority) than Tailscale&#39;s (usually 5270).RULE_PRIO=&quot;5260&quot;# Tag for system log entries.LOG_TAG=&quot;zerotier-policy-route&quot;# --- END CONFIGURATION ---add_rules() &#123;    # Get all global/unique IP addresses (v4 and v6), excluding link-local (fe80::) addresses.    IP_LIST=$(ip addr show dev &quot;$&#123;ZT_IFACE&#125;&quot; | grep -E &#39;inet|inet6&#39; | grep -v &#39; fe80::&#39; | awk &#39;&#123;print $2&#125;&#39; | cut -d&#39;/&#39; -f1)    if [ -z &quot;$&#123;IP_LIST&#125;&quot; ]; then        logger -t &quot;$&#123;LOG_TAG&#125;&quot; &quot;Warning: No usable IP addresses found on interface $&#123;ZT_IFACE&#125;.&quot;        return    fi    for ip in $&#123;IP_LIST&#125;; do        # Check if a rule for this IP already exists to avoid duplication.        if ! ip rule | grep -q &quot;from $&#123;ip&#125; lookup main&quot;; then            logger -t &quot;$&#123;LOG_TAG&#125;&quot; &quot;Adding rule for $&#123;ip&#125; with priority $&#123;RULE_PRIO&#125;.&quot;                        # CRITICAL FIX: Use the &#39;-6&#39; flag for IPv6 addresses.            if echo &quot;$&#123;ip&#125;&quot; | grep -q &quot;:&quot;; then                ip -6 rule add from &quot;$&#123;ip&#125;&quot; lookup main prio &quot;$&#123;RULE_PRIO&#125;&quot;            else                ip rule add from &quot;$&#123;ip&#125;&quot; lookup main prio &quot;$&#123;RULE_PRIO&#125;&quot;            fi        else            logger -t &quot;$&#123;LOG_TAG&#125;&quot; &quot;Rule for $&#123;ip&#125; already exists. Skipping.&quot;        fi    done&#125;remove_rules() &#123;    IP_LIST=$(ip addr show dev &quot;$&#123;ZT_IFACE&#125;&quot; | grep -E &#39;inet|inet6&#39; | grep -v &#39; fe80::&#39; | awk &#39;&#123;print $2&#125;&#39; | cut -d&#39;/&#39; -f1)    if [ -z &quot;$&#123;IP_LIST&#125;&quot; ]; then return; fi    for ip in $&#123;IP_LIST&#125;; do        if ip rule | grep -q &quot;from $&#123;ip&#125; lookup main&quot;; then            logger -t &quot;$&#123;LOG_TAG&#125;&quot; &quot;Removing rule for $&#123;ip&#125;.&quot;            # Use the &#39;-6&#39; flag for deletion of IPv6 rules as well.            if echo &quot;$&#123;ip&#125;&quot; | grep -q &quot;:&quot;; then                ip -6 rule del from &quot;$&#123;ip&#125;&quot; lookup main prio &quot;$&#123;RULE_PRIO&#125;&quot;            else                ip rule del from &quot;$&#123;ip&#125;&quot; lookup main prio &quot;$&#123;RULE_PRIO&#125;&quot;            fi        fi    done&#125;start() &#123;    logger -t &quot;$&#123;LOG_TAG&#125;&quot; &quot;Service starting, applying rules...&quot;    add_rules&#125;stop() &#123;    logger -t &quot;$&#123;LOG_TAG&#125;&quot; &quot;Service stopping, removing rules...&quot;    remove_rules&#125;reload() &#123;    logger -t &quot;$&#123;LOG_TAG&#125;&quot; &quot;Service reloading...&quot;    stop    start&#125;</code></pre><h5 id="Step-3-Authorize-and-Enable-the-Service"><a href="#Step-3-Authorize-and-Enable-the-Service" class="headerlink" title="Step 3: Authorize and Enable the Service"></a>Step 3: Authorize and Enable the Service</h5><p>After saving the file, execute the following commands in the terminal:</p><pre><code class="language-bash"># Grant execution permissionschmod +x /etc/init.d/zerotier-policy-route# Enable the service to run on boot/etc/init.d/zerotier-policy-route enable# Start the service immediately/etc/init.d/zerotier-policy-route start</code></pre><h5 id="Step-4-Verification"><a href="#Step-4-Verification" class="headerlink" title="Step 4: Verification"></a>Step 4: Verification</h5><p>Run <code>ip rule show</code>. You should see output similar to the following, where the <code>5260</code> rules for each ZeroTier IP are correctly positioned above Tailscale’s rules.</p><pre><code class="hljs">0:      from all lookup local...5260:   from 172.27.72.251 lookup main5260:   from fddd:ec77:... lookup main5260:   from fce1:9571:... lookup main5270:   from all lookup 52...</code></pre><h4 id="Implementation-on-Linux-Servers"><a href="#Implementation-on-Linux-Servers" class="headerlink" title="Implementation on Linux Servers"></a>Implementation on Linux Servers</h4><p>Since these errors appeared on OpenWrt, it’s highly likely that another Linux server in your Tailscale network is also running both services. We can adapt the script for standard Linux distributions.</p><h5 id="Policy-Routing-Script"><a href="#Policy-Routing-Script" class="headerlink" title="Policy Routing Script"></a>Policy Routing Script</h5><pre><code class="language-bash">sudo nano /usr/local/sbin/zerotier-policy-route.sh</code></pre><pre><code class="language-sh">#!/bin/bash## This script creates policy routing rules for all ZeroTier interfaces# to coexist with Tailscale on a standard Linux system.#set -e # Exit immediately if a command exits with a non-zero status.# --- CONFIGURATION ---# The priority for the new routing rule.# This MUST be a lower number (higher priority) than Tailscale&#39;s rule (usually 5270).RULE_PRIO=&quot;5260&quot;LOG_TAG=&quot;zerotier-policy-route&quot;# --- END CONFIGURATION ---# Find all ZeroTier network interfaces (names starting with &#39;zt&#39;).ZT_INTERFACES=$(ip -o link show | awk -F&#39;: &#39; &#39;&#123;print $2&#125;&#39; | grep &#39;^zt&#39;)if [ -z &quot;$ZT_INTERFACES&quot; ]; then    logger -t &quot;$LOG_TAG&quot; &quot;No ZeroTier interfaces found. Exiting.&quot;    exit 0fi# Function to add rules for all found interfacesadd_rules() &#123;    logger -t &quot;$LOG_TAG&quot; &quot;Applying policy routing rules...&quot;    for iface in $ZT_INTERFACES; do        # Get all global/unique IP addresses (v4 and v6), excluding link-local (fe80::)        IP_LIST=$(ip addr show dev &quot;$iface&quot; | grep -E &#39;inet|inet6&#39; | grep -v &#39;fe80::&#39; | awk &#39;&#123;print $2&#125;&#39; | cut -d&#39;/&#39; -f1)                if [ -z &quot;$IP_LIST&quot; ]; then            logger -t &quot;$LOG_TAG&quot; &quot;No usable IP addresses on interface $iface. Skipping.&quot;            continue        fi        for ip in $IP_LIST; do            if ! ip rule | grep -q &quot;from $ip lookup main&quot;; then                logger -t &quot;$LOG_TAG&quot; &quot;Adding rule for $ip (on $iface) with priority $RULE_PRIO.&quot;                if [[ &quot;$ip&quot; == *&quot;:&quot;* ]]; then                    ip -6 rule add from &quot;$ip&quot; lookup main prio &quot;$RULE_PRIO&quot;                else                    ip rule add from &quot;$ip&quot; lookup main prio &quot;$RULE_PRIO&quot;                fi            fi        done    done&#125;# Function to remove rulesremove_rules() &#123;    logger -t &quot;$LOG_TAG&quot; &quot;Removing policy routing rules...&quot;    while ip rule | grep -q &quot;prio $RULE_PRIO&quot;; do        RULE_TO_DELETE=$(ip rule | grep &quot;prio $RULE_PRIO&quot; | head -n 1)        logger -t &quot;$LOG_TAG&quot; &quot;Deleting rule: $RULE_TO_DELETE&quot;        # We need to parse the rule string to delete it correctly        ip rule del $(echo $&#123;RULE_TO_DELETE&#125; | sed &#39;s/[0-9]*:\s*//&#39;)    done&#125;case &quot;$1&quot; in    start)        add_rules        ;;    stop)        remove_rules        ;;    restart)        remove_rules        add_rules        ;;    *)        echo &quot;Usage: $0 &#123;start|stop|restart&#125;&quot;        exit 1        ;;esacexit 0</code></pre><p>Set the permissions:</p><pre><code class="language-bash">sudo chmod +x /usr/local/sbin/zerotier-policy-route.sh</code></pre><h5 id="Systemd-Service-Unit"><a href="#Systemd-Service-Unit" class="headerlink" title="Systemd Service Unit"></a>Systemd Service Unit</h5><pre><code class="language-bash">sudo nano /etc/systemd/system/zerotier-policy-route.service</code></pre><pre><code class="language-ini">[Unit]Description=ZeroTier Policy Routing Fix for Tailscale CoexistenceAfter=network-online.targetWants=network-online.targetAfter=zerotier-one.service tailscaled.service[Service]Type=oneshotRemainAfterExit=yesExecStart=/usr/local/sbin/zerotier-policy-route.sh startExecStop=/usr/local/sbin/zerotier-policy-route.sh stop[Install]WantedBy=multi-user.target</code></pre><p>Finally, enable and start the service:</p><pre><code class="language-bash">sudo systemctl enable zerotier-policy-route.servicesudo systemctl start zerotier-policy-route.service</code></pre><p>Verify with <code>ip rule show</code>; you should see the entries mapped:</p><pre><code class="hljs">0:      from all lookup local5210:   from all fwmark 0x80000/0xff0000 lookup main...5260:   from 172.27.72.101 lookup main  &lt;-- Fixed5260:   from 172.27.62.101 lookup main  &lt;-- Fixed5270:   from all lookup 52...</code></pre><p>With this setup, the annoying packet drop logs in <code>logread</code> will finally vanish.</p></div>]]></content>
      
      
      
        <tags>
            
            <tag> OpenWrt </tag>
            
            <tag> ZeroTier </tag>
            
            <tag> Tailscale </tag>
            
            <tag> 路由冲突 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ReFS使用注意事项</title>
      <link href="/blog/refs-attention/"/>
      <url>/blog/refs-attention/</url>
      
        <content type="html"><![CDATA[<h2 id="什么是ReFS"><a href="#什么是ReFS" class="headerlink" title="什么是ReFS"></a>什么是ReFS</h2><p>浏览本文的时候，默认你已经了解了ReFS的基本概念以及优劣。如果不了解，可以参考<a href="https://learn.microsoft.com/zh-cn/windows-server/storage/refs/refs-overview">ReFS概述</a>。<br>本文只讨论自己使用ReFS的注意事项，若有命令参数等请自行参考本文的超链接官方文档。<br>并且本文对ReFS的归纳并不完整，请参阅官方文档。</p><h2 id="ReFS注意事项"><a href="#ReFS注意事项" class="headerlink" title="ReFS注意事项"></a>ReFS注意事项</h2><p>下面只讨论作为数据盘的情况，不太建议用作系统盘。虽然新版本的Windows支持从REFS引导，但是社区依然发现在系统还原这种基础问题上依然有问题。</p><div class="note note-warning">            <p>强烈建议在使用前，禁止自动升级REFS版本。不然在回撤Windows版本的时候，你会无法访问数据盘，变成RAW分区。<br>REFS的版本升级是不可逆的，升级后无法降级！！！</p>           </div><h2 id="日常维护"><a href="#日常维护" class="headerlink" title="日常维护"></a>日常维护</h2><h3 id="禁止自动升级（推荐）"><a href="#禁止自动升级（推荐）" class="headerlink" title="禁止自动升级（推荐）"></a>禁止自动升级（推荐）</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs reg">Windows Registry Editor Version 5.00<br>[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\FileSystem]<br>&quot;RefsDisableLastAccessUpdate&quot;=dword:00000001<br>;&quot;RefsDisableVolumeUpgrade&quot;=dword:00000001   不用这种方法，似乎会阻止手动升级<br></code></pre></td></tr></table></figure><h3 id="手动升级（推荐）"><a href="#手动升级（推荐）" class="headerlink" title="手动升级（推荐）"></a>手动升级（推荐）</h3><p>在你确认你不需要降级的情况下，手动升级ReFS版本。高版本的ReFS会有更好的性能和稳定性。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-comment"># 查看版本</span><br>fsutil fsinfo refsinfo z:<br><br><span class="hljs-comment"># 升级文件系统版本</span><br>fsutil Volume Upgrade &lt;C:&gt;<br></code></pre></td></tr></table></figure><h3 id="数据压缩（推荐）"><a href="#数据压缩（推荐）" class="headerlink" title="数据压缩（推荐）"></a>数据压缩（推荐）</h3><p>这个挺好用的。<br><a href="https://learn.microsoft.com/zh-cn/windows-server/administration/windows-commands/refsutil-compression">数据压缩文档</a></p><h3 id="重复数据删除（推荐）"><a href="#重复数据删除（推荐）" class="headerlink" title="重复数据删除（推荐）"></a>重复数据删除（推荐）</h3><p><a href="https://learn.microsoft.com/zh-cn/windows-server/administration/windows-commands/refsutil-dedupe">重复数据删除文档</a></p><h2 id="数据修复（必看）"><a href="#数据修复（必看）" class="headerlink" title="数据修复（必看）"></a>数据修复（必看）</h2><p><a href="https://learn.microsoft.com/zh-cn/windows-server/administration/windows-commands/refsutil-triage">分析和解决文件系统损坏问题</a><br><a href="https://learn.microsoft.com/zh-cn/windows-server/administration/windows-commands/refsutil-salvage">对于变成RAW(损坏的卷)执行恢复作以检索数据。</a></p><h2 id="高级功能"><a href="#高级功能" class="headerlink" title="高级功能"></a>高级功能</h2><h3 id="ReFS完整性流（推荐）"><a href="#ReFS完整性流（推荐）" class="headerlink" title="ReFS完整性流（推荐）"></a>ReFS完整性流（推荐）</h3><p>完整性流是 ReFS 的一项功能，它可以确保文件数据的完整性。它使用 CRC32 校验和来验证文件数据的完整性。启用完整性流后，ReFS 会在每次读取文件时计算 CRC32 校验和，并将其与存储在文件中的校验和进行比较。如果校验和不匹配，则 ReFS 会尝试修复文件。<br><a href="https://learn.microsoft.com/zh-cn/windows-server/storage/refs/integrity-streams">完整性流文档</a></p><h4 id="Get-FileIntegrity"><a href="#Get-FileIntegrity" class="headerlink" title="Get-FileIntegrity"></a>Get-FileIntegrity</h4><p>若要查看是否为文件数据启用了完整性流，请使用 Get-FileIntegrity cmdlet。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">Get-FileIntegrity</span> <span class="hljs-literal">-FileName</span> <span class="hljs-string">&#x27;C:\Docs\TextDocument.txt&#x27;</span><br></code></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">Get-Item</span> <span class="hljs-literal">-Path</span> <span class="hljs-string">&#x27;C:\Docs\*&#x27;</span> | <span class="hljs-built_in">Get-FileIntegrity</span><br></code></pre></td></tr></table></figure><p>也可以使用 Get-Item cmdlet 获取指定目录中所有文件的完整性流设置。</p><h4 id="Set-FileIntegrity"><a href="#Set-FileIntegrity" class="headerlink" title="Set-FileIntegrity"></a>Set-FileIntegrity</h4><p>若要对文件数据启用&#x2F;禁用完整性流，请使用 Set-FileIntegrity cmdlet。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">Set-FileIntegrity</span> <span class="hljs-literal">-FileName</span> <span class="hljs-string">&#x27;H:\Docs\TextDocument.txt&#x27;</span> <span class="hljs-literal">-Enable</span> <span class="hljs-variable">$True</span><br></code></pre></td></tr></table></figure><p>也可以使用 Get-Item cmdlet 设置指定文件夹中所有文件的完整性流设置。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">Get-Item</span> <span class="hljs-literal">-Path</span> <span class="hljs-string">&#x27;H\Docs\*&#x27;</span> | <span class="hljs-built_in">Set-FileIntegrity</span> <span class="hljs-literal">-Enable</span> <span class="hljs-variable">$True</span><br></code></pre></td></tr></table></figure><p>Set-FileIntegrity cmdlet 也可直接用于卷和目录。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">Set-FileIntegrity</span> <span class="hljs-built_in">H</span>:\ <span class="hljs-literal">-Enable</span> <span class="hljs-variable">$True</span><br><span class="hljs-built_in">Set-FileIntegrity</span> <span class="hljs-built_in">H</span>:\Docs <span class="hljs-literal">-Enable</span> <span class="hljs-variable">$True</span><br></code></pre></td></tr></table></figure><h3 id="高级重复数据删除"><a href="#高级重复数据删除" class="headerlink" title="高级重复数据删除"></a>高级重复数据删除</h3><p><a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.refsdedup.commands/?view=windowsserver2025-ps">高级重复数据删除指令</a><br>我一直分不清ReFSDedupSchedule和ReFSDedupScrubSchedule区别。总之我一直用ReFSDedupScrubSchedule。</p><p>不过基本上常用的下面这些</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">Disable-ReFSDedup</span> Z:<br>refsutil dedup z: /d<br><span class="hljs-built_in">Enable-ReFSDedup</span> <span class="hljs-literal">-Volume</span> <span class="hljs-string">&quot;Z:&quot;</span> <span class="hljs-literal">-Type</span> DedupAndCompress<br><span class="hljs-built_in">Set-ReFSDedupScrubSchedule</span> <span class="hljs-literal">-Volume</span>: Z: <span class="hljs-literal">-Start</span> <span class="hljs-number">2025</span>/<span class="hljs-number">4</span>/<span class="hljs-number">29</span> <span class="hljs-number">19</span>:<span class="hljs-number">0</span>:<span class="hljs-number">0</span> <span class="hljs-literal">-WeeksInterval</span> <span class="hljs-number">2</span><br><span class="hljs-built_in">Start-ReFSDedupJob</span> <span class="hljs-literal">-Volume</span> Z: <span class="hljs-literal">-CompressionFormat</span> LZ4<br><span class="hljs-built_in">Stop-ReFSDedupJob</span> Z:<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 文件系统 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Windows </tag>
            
            <tag> 文件系统 </tag>
            
            <tag> ReFS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ZeroTier和Tailscale的区别</title>
      <link href="/blog/diff-zerotier-tailscale/"/>
      <url>/blog/diff-zerotier-tailscale/</url>
      
        <content type="html"><![CDATA[<p>网上基本上没人说这两个有什么差别，其实实际使用的时候区别还是蛮大的。</p><p>先说结论，ZeroTier用的是私有协议，Tailscale用的是WireGuard。但是ZeroTier有点像玩具，Tailscale更完善。</p><h2 id="ZeroTier"><a href="#ZeroTier" class="headerlink" title="ZeroTier"></a>ZeroTier</h2><p>ZeroTier 是一种虚拟局域网解决方案，它可以将不同地点的设备连接到同一个网络中，如同它们处于同一物理网络。</p><h2 id="Tailscale"><a href="#Tailscale" class="headerlink" title="Tailscale"></a>Tailscale</h2><p>Tailscale 是一种基于 WireGuard 的 VPN 解决方案，可以安全地连接您的设备和应用，无需复杂的防火墙配置。</p><h3 id="协议以及网络结构"><a href="#协议以及网络结构" class="headerlink" title="协议以及网络结构"></a>协议以及网络结构</h3><p>ZeroTier使用的是私有协议，Tailscale使用的是WireGuard。ZeroTier和Tailscale都提供自定义中继服务器，分别是MOON和DERP服务器。<br>在网络结构上，ZeroTier是一个P2P网络，Tailscale是一个Mesh网络。</p><h3 id="连接稳定性-最大区别"><a href="#连接稳定性-最大区别" class="headerlink" title="连接稳定性(最大区别)"></a>连接稳定性(最大区别)</h3><p>Tailscale的稳定性比ZeroTier要好的多。</p><ul><li>Tailscale在网络中，如果对其他节点没有数据交互，会设置为idle状态，在开始数据交换，会先由DERP服务器进行中转，<strong>同时</strong>开始尝试进行NAT穿透。对于客户端，可以通过<code>tailscale status</code>命令来查看连接状态。</li><li>ZeroTier在网络中，默认会尝试对所有节点进行连接，并直接进行NAT穿透。ZeroTier的MOON服务器会在连接不稳定的时候，自动进行中转。对于客户端，可以通过<code>zerotier-cli peers</code>命令来查看连接状态。</li></ul><div class="note note-warning">            <p>但是ZeroTier的MOON服务器只提供UDP中继，默认不提供TCP中继！<br>如果要使用TCP中继，需要自行编译源代码并且配置，非常麻烦。<br>而UDP中继在国内网络环境下，基本上不可用的，这就导致如果显示为REPLYING的节点，基本上无法连接。</p>           </div><p><strong>这就导致了ZeroTier中，如果双方有任意一方在较差的网络环境下，连接会非常不稳定，甚至无法连接。而Tailscale则不会出现这种情况。</strong></p><h3 id="穿透NAT-速度"><a href="#穿透NAT-速度" class="headerlink" title="穿透NAT(速度)"></a>穿透NAT(速度)</h3><p>ZeroTier的私有协议在穿透NAT方面做得非常好，Tailscale的WireGuard没有ZeroTier好。</p><h3 id="安全性"><a href="#安全性" class="headerlink" title="安全性"></a>安全性</h3><p>都差不多，对普通人没啥区别。</p>]]></content>
      
      
      <categories>
          
          <category> 网络技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ZeroTier </tag>
            
            <tag> Tailscale </tag>
            
            <tag> VPN </tag>
            
            <tag> Virtual LAN </tag>
            
            <tag> Network </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>仿 TrymenT 游戏风格的Hexo时钟组件</title>
      <link href="/blog/background-tryment-clock/"/>
      <url>/blog/background-tryment-clock/</url>
      
        <content type="html"><![CDATA[<div class="note note-success">            <p>本文由 Fluid 用户授权转载，版权归原作者所有。</p> <p>本文作者：Tokisaki_Galaxy<br>原文地址：<a href="https://tokisaki.top/background-tryment-clock">https://tokisaki.top/background-tryment-clock</a></p>           </div><div class="note note-warning">            <p>该项目特别针对Hexo-Fluid主题进行了优化，其他主题可能需要手动修改主题代码以获得最佳体验。<br>Hexo-Theme-Fluid项目地址：<a href="https://github.com/fluid-dev/hexo-theme-fluid">https://github.com/fluid-dev/hexo-theme-fluid</a></p>           </div><h2 id="效果预览"><a href="#效果预览" class="headerlink" title="效果预览"></a>效果预览</h2><p><a href="https://github.com/Tokisaki-Galaxy/TrymenT-ClocK/">Github上的项目</a><br><a href="https://tokisaki.top/">在Hexo的在线预览</a></p><p>时钟效果展现了游戏中那种略带神秘感的界面设计，转动的双环加上特殊符号标记，营造出一种独特的视觉体验。无论是作为博客装饰还是个人页面点缀，都能增添不少科幻氛围。</p><h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>一个仿 <code>TrymenT ―今を変えたいと願うあなたへ―</code> 游戏中时钟界面设计的 Web 时钟实现。提供了一个特殊视觉风格的数字时钟。 很喜欢这个游戏，RASK公司什么时候出OmegaA啊？说好分割商法，也别烂尾啊！ 以最左边的指针为指示，指针不动，取而代之的是内外盘不停地动。内盘代表小时，外盘代表分钟。</p><h2 id="特性"><a href="#特性" class="headerlink" title="特性"></a>特性</h2><ul><li>独特的双环时钟设计</li><li>特殊的字体和符号标记</li><li>自定义日期显示格式</li><li>响应式设计，自适应不同屏幕尺寸</li><li>半透明背景图片效果</li></ul><h2 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h2><h3 id="需要的文件"><a href="#需要的文件" class="headerlink" title="需要的文件"></a>需要的文件</h3><ul><li><a href="https://cdn.jsdelivr.net/gh/Tokisaki-Galaxy/TrymenT-ClocK/TrymenT-ClocK.min.css">TrymenT-ClocK.min.css</a></li><li><a href="https://cdn.jsdelivr.net/gh/Tokisaki-Galaxy/TrymenT-ClocK/TrymenT-ClocK.min.js">TrymenT-ClocK.min.js</a></li><li><a href="https://cdn.jsdelivr.net/gh/Tokisaki-Galaxy/TrymenT-ClocK/img.png">TrymenT-ClocK-PNG</a></li></ul><h3 id="在Hexo中使用"><a href="#在Hexo中使用" class="headerlink" title="在Hexo中使用"></a>在Hexo中使用</h3><h4 id="（推荐！）Hexo注入"><a href="#（推荐！）Hexo注入" class="headerlink" title="（推荐！）Hexo注入"></a>（推荐！）Hexo注入</h4><p><a href="https://hexo.fluid-dev.com/posts/hexo-injector/">Hexo注入器</a>是一项Hexo5之后提出的功能.<br>编写注入代码，需要在博客的根目录下创建 scripts 文件夹，然后在里面任意命名创建一个 js 文件即可。</p><p>例如创建一个 &#x2F;blog&#x2F;scripts&#x2F;Tryment-Clock.js，内容为</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript">hexo.<span class="hljs-property">extend</span>.<span class="hljs-property">injector</span>.<span class="hljs-title function_">register</span>(<span class="hljs-string">&#x27;body_begin&#x27;</span>, <span class="hljs-string">&#x27;&lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/gh/Tokisaki-Galaxy/TrymenT-ClocK/TrymenT-ClocK.min.css&quot;&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;https://cdn.jsdelivr.net/gh/Tokisaki-Galaxy/TrymenT-ClocK/TrymenT-ClocK.min.js&quot;&gt;&lt;/script&gt;&#x27;</span>, <span class="hljs-string">&#x27;default&#x27;</span>);<br></code></pre></td></tr></table></figure><h4 id="（比较麻烦）修改主题代码"><a href="#（比较麻烦）修改主题代码" class="headerlink" title="（比较麻烦）修改主题代码"></a>（比较麻烦）修改主题代码</h4><p>把下面的代码放到主题的 <code>layout/layout.ejs</code> 文件中，然后把相应的文件复制到css，js，img文件夹里面。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs html">&lt;% if (theme.background_trymentclock.enable) &#123; %&gt;<br>  <span class="hljs-comment">&lt;!--下面两行是核心内容--&gt;</span><br>  &lt;%- css_ex(theme.static_prefix.internal_css, &#x27;TrymenT-ClocK.min.css&#x27;) %&gt;<br>  &lt;%- js_ex(theme.static_prefix.internal_js, &#x27;TrymenT-ClocK.min.js&#x27;) %&gt;<br>  &lt;% &#125; %&gt;<br></code></pre></td></tr></table></figure><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-comment"># 背景的TrymenT时钟特效，如果需要切换背景图片请在主题目录下替换 /source/img/img.png</span><br><span class="hljs-comment"># See: https://github.com/Tokisaki-Galaxy/TrymenT-ClocK</span><br><span class="hljs-attr">background_trymentclock:</span><br>  <span class="hljs-attr">enable:</span> <span class="hljs-literal">false</span><br></code></pre></td></tr></table></figure><h3 id="作为独立页面使用"><a href="#作为独立页面使用" class="headerlink" title="作为独立页面使用"></a>作为独立页面使用</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>TrymenT ClocK<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;https://cdn.jsdelivr.net/gh/Tokisaki-Galaxy/TrymenT-ClocK/TrymenT-ClocK.min.css&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;https://cdn.jsdelivr.net/gh/Tokisaki-Galaxy/TrymenT-ClocK/TrymenT-ClocK.min.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><ul><li>时钟效果可能会占用一定的系统资源，在低配置设备上可能会有轻微卡顿</li><li>背景图片默认为半透明效果，可能会与某些深色主题产生冲突</li><li>在移动设备上浏览时，时钟会自动调整大小以适应屏幕</li><li>如需更换背景图片，图片尺寸建议保持在1920×1080以上</li><li>不建议在页面中添加多个时钟实例，可能会导致性能问题</li></ul>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
          <category> Web组件 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
            <tag> JavaScript </tag>
            
            <tag> 时钟 </tag>
            
            <tag> 游戏风格 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>通过wheel文件解决rpy2安装权限问题</title>
      <link href="/blog/rpy2-install-via-wheel/"/>
      <url>/blog/rpy2-install-via-wheel/</url>
      
        <content type="html"><![CDATA[<h2 id="问题背景"><a href="#问题背景" class="headerlink" title="问题背景"></a>问题背景</h2><p>最近在尝试Python与R语言交互时，需要安装rpy2这个包。按照常规方式使用pip安装时，却不断遇到各种各样的错误：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">        File <span class="hljs-string">&quot;Z:\ProgramData\miniconda3\Lib\subprocess.py&quot;</span>, line 1538, <span class="hljs-keyword">in</span> _execute_child<br>          hp, ht, pid, tid = _winapi.CreateProcess(executable, args,<br>                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^<br>      PermissionError: [WinError 5] Access is denied<br>      [end of output]<br><br>  note: This error originates from a subprocess, and is likely not a problem with pip.<br>error: subprocess-exited-with-error<br><br>× Getting requirements to build wheel did not run successfully.<br>│ <span class="hljs-built_in">exit</span> code: 1<br>╰─&gt; See above <span class="hljs-keyword">for</span> output.<br><br>note: This error originates from a subprocess, and is likely not a problem with pip.<br></code></pre></td></tr></table></figure><p>还有其他各种各样的问题，在重新设置 <code>R_HOME</code> (<a href="https://www.cnblogs.com/Xeonilian/p/windows_rpy2_install.html">https://www.cnblogs.com/Xeonilian/p/windows_rpy2_install.html</a>) 、安装 <code>R_Tools</code> (<a href="https://blog.csdn.net/BioFlorist/article/details/121665959">https://blog.csdn.net/BioFlorist/article/details/121665959</a>) 、安装 MinGW 等等方法都无法解决。<br>这个问题困扰了我整整两天，尝试了各种方法都未能解决。<br>甚至到了我一度以为是rpy2不支持windows（在rpy2的官网上，他说对windows的支持不由官方提供，而是由社区提供），但是我同学却轻轻松松安装成功了。</p><h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2><p>在多次尝试失败后，网上别人推荐使用conda安装的方法，但是那种虽然能安装，但是却使用的是conda安装的R环境，而不是我本地的R环境。有大量的R包需要重装。<br>在找了许久之后，我发现可以通过预编译的wheel文件来绕过编译问题。<br>但是，网上很多教程用的是<a href="https://www.cnblogs.com/cloudtj/articles/6372197.html">托管在www.lfd.uci.edu的wheel包</a>，但是维护托管网站的教授因为服务器费用问题，已经关闭不再提供对rpy2的托管。<br>不过后来经过寻找，我在<a href="https://www.piwheels.org/project/rpy2/">piwheels</a>网站上找到了预编译好的rpy2 wheel文件。<br>虽然没有很多版本的wheel文件，最新的稳定版3.5.17也没有，只有3.6.0.dev2 pre-release，但是怎么说都比没有强很多了。</p><p>另外，<a href="https://rpy2.github.io/doc/v3.5.x/html/overview.html#background">官网上也有些R和rpy2的兼容性情况</a>。</p><h2 id="安装步骤"><a href="#安装步骤" class="headerlink" title="安装步骤"></a>安装步骤</h2><ol><li>访问<a href="https://www.piwheels.org/project/rpy2/">piwheels</a></li><li>根据你的python版本，找到对应的wheel文件</li><li>下载wheel文件到本地</li><li>打开命令行，使用以下命令安装：</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">pip install 你下载的wheel文件路径<br></code></pre></td></tr></table></figure><h2 id="安装要点"><a href="#安装要点" class="headerlink" title="安装要点"></a>安装要点</h2><p>安装前请确保系统中已经正确配置了R语言环境，rpy2需要调用R的库文件。</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>当pip编译rpy2出现错误时，可以去<a href="http://www.piwheels.org试试看,能不能搜到预编译的wheel文件./">www.piwheels.org试试看，能不能搜到预编译的wheel文件。</a><br>虽然这个过程有点曲折，但希望我的经历能帮助到遇到类似问题的你，少走一些弯路。</p>]]></content>
      
      
      <categories>
          
          <category> 编程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> rpy2 </tag>
            
            <tag> 安装问题 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用ZeroTier搭建游戏局域网环境</title>
      <link href="/blog/zerotier-game-setting/"/>
      <url>/blog/zerotier-game-setting/</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>ZeroTier是一个非常好用的软件定义局域网SDN，但在用来玩局域网游戏时可能会遇到一些问题，比如无法发现其他玩家或连接延迟高。</p><h2 id="服务器端配置"><a href="#服务器端配置" class="headerlink" title="服务器端配置"></a>服务器端配置</h2><h3 id="1-启用网络广播"><a href="#1-启用网络广播" class="headerlink" title="1. 启用网络广播"></a>1. 启用网络广播</h3><p>要让游戏能够自动发现其他玩家，需要在ZeroTier网络设置中启用广播和组播：</p><ol><li>登录管理面板（或者是ztncui）</li><li>添加新路由</li><li>添加以下两条路由规则：<ul><li>目标: <code>255.255.255.255/32</code>，via: <code>0.0.0.0</code>（启用广播）</li><li>目标: <code>224.0.0.0/4</code>，via: <code>0.0.0.0</code>（启用组播）</li></ul></li></ol><blockquote><p>注意：虽然广播会降低网络效率，但对于游戏发现功能来说是必需的。</p></blockquote><h3 id="2-优化MTU设置"><a href="#2-优化MTU设置" class="headerlink" title="2. 优化MTU设置"></a>2. 优化MTU设置</h3><p>大多数家用网络的MTU为1500（PPPoE环境下为1492），需要调整ZeroTier的MTU以避免数据包分片：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 进入ZeroTier配置目录</span><br><span class="hljs-built_in">sudo</span> su<br><span class="hljs-built_in">cd</span> /var/lib/zerotier-one/controller.d/network<br><span class="hljs-comment"># 修改目录下所有json网络配置文件中的MTU值</span><br><span class="hljs-comment"># 使用文本编辑器打开.json文件，将&quot;mtu&quot;:2800改为&quot;mtu&quot;:1492</span><br></code></pre></td></tr></table></figure><h2 id="客户端配置"><a href="#客户端配置" class="headerlink" title="客户端配置"></a>客户端配置</h2><h3 id="1-安装WindowsIPBroadcast"><a href="#1-安装WindowsIPBroadcast" class="headerlink" title="1.安装WindowsIPBroadcast"></a>1.安装WindowsIPBroadcast</h3><p>某些游戏（文明6）只在第一个网络适配器上面广播，需要第三方软件广播到全部适配器上，WindowsIPBroadcast可以解决这个问题：<br><a href="https://github.com/dechamps/WinIPBroadcast">GitHub仓库</a>下载最新版本</p><h3 id="2-加钱上moon服务器"><a href="#2-加钱上moon服务器" class="headerlink" title="2.加钱上moon服务器"></a><del>2.加钱上moon服务器</del></h3>]]></content>
      
      
      <categories>
          
          <category> 教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 游戏 </tag>
            
            <tag> ZeroTier </tag>
            
            <tag> 网络 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在 OpenWRT 上使用 acme.sh 配置 SSL 证书</title>
      <link href="/blog/openwrt-acmesh/"/>
      <url>/blog/openwrt-acmesh/</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>OpenWRT 自带的 luci-app-acme 非常难用，而且找不到官方文档（luci很多插件都这样一坨,比如tinyproxy也是年久失修。。）所以我选择官方原版acmesh。</p><p><a href="https://github.com/acmesh-official/acme.sh">如有需要可以参照官方README</a></p><h2 id="安装-acme-sh"><a href="#安装-acme-sh" class="headerlink" title="安装 acme.sh"></a>安装 acme.sh</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">wget -O -  https://get.acme.sh | sh -s email=my@example.com<br><span class="hljs-built_in">cd</span> ~/.acme.sh<br>./acme.sh --upgrade --auto-upgrade<br></code></pre></td></tr></table></figure><h2 id="配置-DNS-API-密钥"><a href="#配置-DNS-API-密钥" class="headerlink" title="配置 DNS API 密钥"></a>配置 DNS API 密钥</h2><p>编辑 <code>~/.acme.sh/account.conf</code> 文件，添加以下内容：</p><p>由于我使用的是cloudflare的dns，如果你是其他的，请<a href="https://github.com/acmesh-official/acme.sh/wiki/dnsapi">参照官方</a>。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">export</span> CF_Zone_ID=<span class="hljs-string">&quot;aaaaaaaaaaa&quot;</span><br><span class="hljs-built_in">export</span> CF_Token=<span class="hljs-string">&quot;aaaaaaaa&quot;</span><br></code></pre></td></tr></table></figure><h2 id="申请证书"><a href="#申请证书" class="headerlink" title="申请证书"></a>申请证书</h2><p>使用以下命令通过 Cloudflare 的 DNS 验证方式申请证书：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">./acme.sh --issue --dns dns_cf -d admin.tokisaki.top -d <span class="hljs-string">&#x27;*.example.com&#x27;</span> <span class="hljs-comment"># dns方式可以申请通配符证书</span><br></code></pre></td></tr></table></figure><h2 id="查看证书列表"><a href="#查看证书列表" class="headerlink" title="查看证书列表"></a>查看证书列表</h2><p>可以使用以下命令查看已申请的证书：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">./acme.sh --list<br></code></pre></td></tr></table></figure><h2 id="安装证书"><a href="#安装证书" class="headerlink" title="安装证书"></a>安装证书</h2><p>将申请到的证书安装到指定位置，并重启 uhttpd 服务：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">./acme.sh --install-cert -d admin.tokisaki.top \<br>--key-file /etc/uhttpd.key \<br>--fullchain-file /etc/uhttpd.crt \<br>--reloadcmd <span class="hljs-string">&#x27;/etc/init.d/uhttpd restart&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="验证安装是否有效"><a href="#验证安装是否有效" class="headerlink" title="验证安装是否有效"></a>验证安装是否有效</h2><p>使用以下命令强制续期证书：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">./acme.sh --renew -d admin.tokisaki.top --force<br></code></pre></td></tr></table></figure><p>如果安装成功，输出如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">.......<br>[Mon Feb  3 16:14:16 CST 2025] Your cert is <span class="hljs-keyword">in</span>: /root/.acme.sh/admin.tokisaki.top_ecc/admin.tokisaki.top.cer<br>[Mon Feb  3 16:14:16 CST 2025] Your cert key is <span class="hljs-keyword">in</span>: /root/.acme.sh/admin.tokisaki.top_ecc/admin.tokisaki.top.key<br>[Mon Feb  3 16:14:16 CST 2025] The intermediate CA cert is <span class="hljs-keyword">in</span>: /root/.acme.sh/admin.tokisaki.top_ecc/ca.cer<br>[Mon Feb  3 16:14:16 CST 2025] And the full-chain cert is <span class="hljs-keyword">in</span>: /root/.acme.sh/admin.tokisaki.top_ecc/fullchain.cer<br>[Mon Feb  3 16:14:17 CST 2025] Installing key to: /etc/uhttpd.key<br>[Mon Feb  3 16:14:17 CST 2025] Installing full chain to: /etc/uhttpd.crt<br>[Mon Feb  3 16:14:17 CST 2025] Running reload cmd: /etc/init.d/uhttpd restart<br>[Mon Feb  3 16:14:17 CST 2025] Reload successful<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> openwrt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> OpenWRT </tag>
            
            <tag> SSL </tag>
            
            <tag> HTTPS </tag>
            
            <tag> acme.sh </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>review-relief</title>
      <link href="/blog/review-relief/"/>
      <url>/blog/review-relief/</url>
      
        <content type="html"><![CDATA[<h2 id="包含大量剧透"><a href="#包含大量剧透" class="headerlink" title="包含大量剧透"></a>包含大量剧透</h2><h2 id="ruka"><a href="#ruka" class="headerlink" title="ruka"></a>ruka</h2><h2 id="momo"><a href="#momo" class="headerlink" title="momo"></a>momo</h2><h2 id="日向子（最喜欢的）"><a href="#日向子（最喜欢的）" class="headerlink" title="日向子（最喜欢的）"></a>日向子（最喜欢的）</h2>]]></content>
      
      
      <categories>
          
          <category> 评价 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ReLief </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RTL9210(A/B)固件配置</title>
      <link href="/blog/rtl9210-firmware/"/>
      <url>/blog/rtl9210-firmware/</url>
      
        <content type="html"><![CDATA[<h2 id="RTL9210固件配置"><a href="#RTL9210固件配置" class="headerlink" title="RTL9210固件配置"></a>RTL9210固件配置</h2><p>RTL9210 分为A版和B版。A版支持NVMe，B版同时支持SATA和NVMe。<br><a href="https://www.station-drivers.com/index.php/en/component/remository/search/submit_search,yes/search_filetitle,1/search_filedesc,1/search_text,rtl9210b/page,2/lang,en-gb/?Itemid=0">RTL9210(A&#x2F;B)公版</a><br><a href="https://github.com/bensuperpc/rtl9210-firmware">RTL9210A&#x2F;B参数解释</a></p><table><thead><tr><th>名称</th><th>内容</th></tr></thead><tbody><tr><td>MANUFACTURE</td><td>生产商</td></tr><tr><td>SCSI_VENDOR</td><td>SCSI 中显示的生产商名称</td></tr><tr><td>PRODUCT</td><td>产品型号</td></tr><tr><td>SCSI_PRODUCT</td><td>SCSI 中显示的产品型号</td></tr><tr><td>SERIAL</td><td>产品序列号</td></tr><tr><td>EN_UPS</td><td>建议关闭，设为1会每次插拔增加不安全关机数</td></tr><tr><td>DIS_SHOW_EMPTY_DISK</td><td>插硬盘是否显示空硬盘</td></tr><tr><td>ASPMDIS</td><td>是否禁用活动电源管理 值为16进制1和0。(开启:0x1 关闭:0x0)  开启后桥接会始终保持高功率，会很烫，但是好像速度没影响。</td></tr><tr><td>DISK_IPS_THRES</td><td>指定硬盘多久休眠（分钟）</td></tr><tr><td>EN_U1U2</td><td>开启U1U2功率管理模式</td></tr><tr><td>U2_MAXPWR</td><td>U2模式最大功率</td></tr><tr><td>U3_MAXPWR</td><td>U3模式最大功率</td></tr><tr><td>下列各个设置请</td><td>根据自己的硬盘盒厂商设定</td></tr><tr><td>LED</td><td></td></tr><tr><td>SUSPEND_LED_OFF</td><td>弹出后关灯</td></tr><tr><td>SUSPEND_DISK_OFF</td><td>弹出后单色灯灭灯，双色的话显示蓝色</td></tr><tr><td>UART_DBG_PIN</td><td>UART串口 DEBUG PIN码</td></tr><tr><td>PD</td><td>【待确认】开启PD供电模式？详细作用不明，但是WTG一定要关闭，否则可能导致加电速度慢，引导时找不到硬盘。</td></tr></tbody></table><h2 id="另外别人记录的坑"><a href="#另外别人记录的坑" class="headerlink" title="另外别人记录的坑"></a>另外别人记录的坑</h2><p>默认配置里有一行SCSI_WP_PIN &#x3D; 0xc，这行如果不删会出现向硬盘里写文件时提示硬盘有写保护，同时LED也不亮。<a href="https://www.bilibili.com/opus/841596810157883397">来源</a></p><h2 id="MD202原厂设置"><a href="#MD202原厂设置" class="headerlink" title="MD202原厂设置"></a>MD202原厂设置</h2><p>如需使用自行把<code>:</code>换成<code>=</code>。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">U2PHY :</span> <span class="hljs-number">02</span> <span class="hljs-string">f4</span> <span class="hljs-string">9b</span> <span class="hljs-string">e0</span> <span class="hljs-string">e1</span> <br><span class="hljs-attr">U3PHY :</span> <span class="hljs-number">02</span> <span class="hljs-string">d4</span> <span class="hljs-number">09</span> <span class="hljs-number">00</span> <span class="hljs-string">d5</span> <span class="hljs-number">00</span> <span class="hljs-number">80</span> <br><span class="hljs-attr">VID :</span> <span class="hljs-number">0x0bda</span><br><span class="hljs-attr">PID :</span> <span class="hljs-number">0x9210</span><br><span class="hljs-attr">MANUFACTURE :</span> <span class="hljs-string">&quot;HIKSEMI&quot;</span><br><span class="hljs-attr">PRODUCT :</span> <span class="hljs-string">&quot;MD202&quot;</span><br><span class="hljs-attr">SERIAL :</span> <span class="hljs-string">&quot;012345678935&quot;</span><br><span class="hljs-attr">SCSI_PRODUCT :</span> <span class="hljs-string">&quot;MD202&quot;</span> <span class="hljs-string">;这里出现未知字符，可能是厂商防伪用</span><br><span class="hljs-attr">SCSI_VENDOR :</span> <span class="hljs-string">&quot;HIKSEMI&quot;</span> <span class="hljs-string">;这里出现未知字符，可能是厂商防伪用</span><br><span class="hljs-attr">USB_SELF_PWR :</span> <span class="hljs-string">n/a</span><br><span class="hljs-attr">DISK_HOTPLUG :</span> <span class="hljs-number">0x00</span><br><span class="hljs-attr">LED :</span> <span class="hljs-number">0x02</span><br><span class="hljs-attr">PINMUX1 :</span> <span class="hljs-number">0x00000000</span><br><span class="hljs-attr">PINMUX2 :</span> <span class="hljs-number">0x00000070</span><br><span class="hljs-attr">U2_MAXPWR :</span> <span class="hljs-number">0xfa</span><br><span class="hljs-attr">U3_MAXPWR :</span> <span class="hljs-number">0x70</span><br><span class="hljs-attr">ASPMDIS :</span> <span class="hljs-number">0x00</span><br><span class="hljs-attr">PCIE_REFCLK :</span> <span class="hljs-string">n/a</span><br><span class="hljs-attr">DISK_IPS_THRES :</span> <span class="hljs-number">0x0a</span><br><span class="hljs-attr">SWR_1_2V :</span> <span class="hljs-string">n/a</span><br><span class="hljs-attr">EN_UPS :</span> <span class="hljs-string">n/a</span><br><span class="hljs-attr">PD :</span> <span class="hljs-string">n/a</span><br><span class="hljs-attr">CUSTOMIZED_LED :</span> <span class="hljs-string">n/a</span><br><span class="hljs-attr">SUSPEND_LED_OFF :</span> <span class="hljs-number">0x03</span><br><span class="hljs-attr">FORCE_USB_SPEED :</span> <span class="hljs-string">n/a</span><br><span class="hljs-attr">FORCE_PCIE_SPEED :</span> <span class="hljs-string">n/a</span><br><span class="hljs-attr">EN_U1U2 :</span> <span class="hljs-string">n/a</span><br><span class="hljs-attr">FORCE_USB_QUIRK :</span> <span class="hljs-string">n/a</span><br><span class="hljs-attr">FORCE_PCIE_QUIRK :</span> <span class="hljs-string">n/a</span><br><span class="hljs-attr">FAN :</span> <span class="hljs-string">n/a</span><br><span class="hljs-attr">DIS_SHOW_EMPTY_DISK :</span> <span class="hljs-string">n/a</span><br><span class="hljs-attr">FORCE_SATA_NORMAL_DMA :</span> <span class="hljs-string">n/a</span><br><span class="hljs-attr">UART_DBG_PIN :</span> <span class="hljs-number">0x05</span><br><span class="hljs-attr">FINGER_PRINT_EN :</span> <span class="hljs-string">n/a</span><br><span class="hljs-attr">RM_INTERNAL_RD :</span> <span class="hljs-string">n/a</span><br><span class="hljs-attr">HS_AUTO_SWITCH :</span> <span class="hljs-string">n/a</span><br><span class="hljs-attr">UART_BAUD_RATE :</span> <span class="hljs-string">n/a</span><br><span class="hljs-attr">CUSTOMIZED_DISK_IDENTIFY :</span> <span class="hljs-string">n/a</span><br><span class="hljs-attr">HW_LED_CFG :</span> <span class="hljs-string">n/a</span><br><span class="hljs-attr">CDROM_CFG :</span> <span class="hljs-string">n/a</span><br><span class="hljs-attr">SUPPORT_HID :</span> <span class="hljs-string">n/a</span><br><span class="hljs-attr">LATE_INIT_DISK :</span> <span class="hljs-string">n/a</span><br><span class="hljs-attr">SCSI_WP_PIN :</span> <span class="hljs-string">n/a</span><br><span class="hljs-attr">SD_MMC_TYPE :</span> <span class="hljs-string">n/a</span><br><span class="hljs-attr">FORCE_PORT_TYPE :</span> <span class="hljs-string">n/a</span><br><span class="hljs-attr">BCDDEVICE :</span> <span class="hljs-string">n/a</span><br><span class="hljs-attr">SUSPEND_DISK_OFF :</span> <span class="hljs-string">n/a</span><br><span class="hljs-attr">SCSI_WB_PIN :</span> <span class="hljs-string">n/a</span><br><span class="hljs-attr">CUSTOMIZED_FEATURE :</span> <span class="hljs-string">n/a</span><br><span class="hljs-attr">PERIPH_API :</span> <span class="hljs-string">n/a</span><br><span class="hljs-attr">RAID_CFG :</span> <span class="hljs-string">n/a</span><br><br><span class="hljs-attr">Boot Mode :</span> <span class="hljs-string">Flash</span><br><span class="hljs-attr">FW Ver :</span> <span class="hljs-number">1.27</span><span class="hljs-number">.24</span><br><span class="hljs-attr">FW Build Date :</span> <span class="hljs-number">2021.09</span><span class="hljs-number">.07</span><br><span class="hljs-attr">IC Pkg Type :</span> <span class="hljs-string">PCIE/SATA</span><br><span class="hljs-attr">UUID :</span> <span class="hljs-string">n/a</span><br><br><span class="hljs-attr">Disconn_ForceUSB2 :</span> <span class="hljs-literal">false</span><br></code></pre></td></tr></table></figure><h2 id="自用MD202"><a href="#自用MD202" class="headerlink" title="自用MD202"></a>自用MD202</h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">VID</span> <span class="hljs-string">=</span> <span class="hljs-number">0xbda</span><br><span class="hljs-string">PID</span> <span class="hljs-string">=</span> <span class="hljs-number">0x9210</span><br><span class="hljs-string">MANUFACTURE</span> <span class="hljs-string">=</span> <span class="hljs-string">&quot;HIKSEMI&quot;</span><br><span class="hljs-string">SCSI_VENDOR</span> <span class="hljs-string">=</span> <span class="hljs-string">&quot;HIKSEMI&quot;</span><br><span class="hljs-string">PRODUCT</span> <span class="hljs-string">=</span> <span class="hljs-string">&quot;MD202&quot;</span><br><span class="hljs-string">SCSI_PRODUCT</span> <span class="hljs-string">=</span> <span class="hljs-string">&quot;MD202&quot;</span><br><span class="hljs-string">SERIAL</span> <span class="hljs-string">=</span> <span class="hljs-string">&quot;012345678938&quot;</span><br><span class="hljs-string">LED</span> <span class="hljs-string">=</span> <span class="hljs-number">0x2</span><br><span class="hljs-string">DIS_SHOW_EMPTY_DISK</span> <span class="hljs-string">=</span> <span class="hljs-number">0x1</span><br><span class="hljs-string">DISK_IPS_THRES</span> <span class="hljs-string">=</span> <span class="hljs-number">0</span><br><br><span class="hljs-string">PINMUX1</span> <span class="hljs-string">=</span> <span class="hljs-number">0x0</span><br><span class="hljs-string">PINMUX2</span> <span class="hljs-string">=</span> <span class="hljs-number">0x70</span><br><span class="hljs-string">U2_MAXPWR</span> <span class="hljs-string">=</span> <span class="hljs-number">0xfa</span><br><span class="hljs-string">U3_MAXPWR</span> <span class="hljs-string">=</span> <span class="hljs-number">0x70</span><br><span class="hljs-string">SUSPEND_LED_OFF</span> <span class="hljs-string">=</span> <span class="hljs-number">0x1</span><br><span class="hljs-string">SUSPEND_DISK_OFF</span> <span class="hljs-string">=</span> <span class="hljs-number">0x7</span><br><span class="hljs-string">UART_DBG_PIN</span> <span class="hljs-string">=</span> <span class="hljs-number">0x5</span><br><br><span class="hljs-string">EN_UPS</span> <span class="hljs-string">=</span> <span class="hljs-number">0x0</span><br><span class="hljs-string">EN_U1U2</span> <span class="hljs-string">=</span> <span class="hljs-number">0x1</span><br><span class="hljs-string">ASPMDIS</span> <span class="hljs-string">=</span> <span class="hljs-number">0x0</span><br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 电脑硬件 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Windows </tag>
            
            <tag> firmware </tag>
            
            <tag> rtl9210 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>review-weathering-with-you</title>
      <link href="/blog/review-weathering-with-you/"/>
      <url>/blog/review-weathering-with-you/</url>
      
        <content type="html"><![CDATA[<h2 id="长大是为了什么"><a href="#长大是为了什么" class="headerlink" title="长大是为了什么"></a>长大是为了什么</h2><h2 id="我们一直在寻找的东西，为什么长大了之后却没有勇气去面对"><a href="#我们一直在寻找的东西，为什么长大了之后却没有勇气去面对" class="headerlink" title="我们一直在寻找的东西，为什么长大了之后却没有勇气去面对"></a>我们一直在寻找的东西，为什么长大了之后却没有勇气去面对</h2><h2 id="我为什么一直追求刀"><a href="#我为什么一直追求刀" class="headerlink" title="我为什么一直追求刀"></a>我为什么一直追求刀</h2><p>从那件事情开始，我从内心里面一直不知道自己是否有能力去爱别人，追求刀，只不过在追求自己因为看别人的爱情中碰到的困难影射到自己身上，或是看到别人在无法相遇爱情中留下的泪水来借此洒下自己的泪水，来以此确认自己还有爱别人的能力。</p><p>长大了之后，我真的还有不惜世界，在别人看来自私的去爱别人的能力吗？<br>在b站突然看到一个评论，施耐庵在几千年前写下《西游记》的时候都知道牺牲童男童女来换来几十年的太平是不可行的，为什么我们还在电影播出之后讨论是否牺牲阳菜？献祭其他人来换来太平本质上是赞同和接受强大的力量对弱小的力量的肆意切割与施暴。我们人类从树上的猴子历经几千万年进化演变成为现在的人类，难道仅仅是不断献祭他人，换来自己的太平吗？我们人类的进化是为了什么？人类的赞歌是勇气的赞歌，是爱的赞歌。而不是通过不断献祭他人来换来自己的太平。</p>]]></content>
      
      
      <categories>
          
          <category> 评价 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 你的名字 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>《你的名字。》的一些想法</title>
      <link href="/blog/review-your-name./"/>
      <url>/blog/review-your-name./</url>
      
        <content type="html"><![CDATA[<h2 id="两个相爱的人终会相遇"><a href="#两个相爱的人终会相遇" class="headerlink" title="两个相爱的人终会相遇"></a>两个相爱的人终会相遇</h2><p>这部影片是新海诚成名之作，在近两个小时的时间，为我们绘制一幅纯真的爱情与努力拯救对方的故事。以穿越时间的灵魂互换为契机，以拯救对方以及糸守镇为目标，两个年轻人在不断的交换中，逐渐了解对方，在黄昏之时相遇。<br>三叶等了八年，在樱花飘落的那一天，终于等到了他。而他，也在那一天，终于发现的自己的内心，找到了她。</p><h2 id="爱能做到的有哪些"><a href="#爱能做到的有哪些" class="headerlink" title="爱能做到的有哪些"></a>爱能做到的有哪些</h2><h3 id="远在乡下的三叶，跨越半个国家去东京"><a href="#远在乡下的三叶，跨越半个国家去东京" class="headerlink" title="远在乡下的三叶，跨越半个国家去东京"></a>远在乡下的三叶，跨越半个国家去东京</h3><p>在陨石坠落前一天，三叶不放心泷和奥寺的约会，逃课去东京找三年前的泷。地铁上相遇时，在泷看来是个陌生而奇怪的女生，三叶却以为自己不被认可，把纽糸时间的头绳交给了泷，埋下了一颗种子。</p><h3 id="泷为了拯救三叶，穿越时间"><a href="#泷为了拯救三叶，穿越时间" class="headerlink" title="泷为了拯救三叶，穿越时间"></a>泷为了拯救三叶，穿越时间</h3><p>虽然梦醒了忘记，泷只能记得三叶的名字或是糸守的地名，但是他也选择了跨越漫长的距离，找到了那个时空的三叶，拯救了她。两人的双向奔赴，虽然有三年的时间差，但是依然构成了一幅美丽的画面。</p><h3 id="三叶在奔跑中跌倒，看到了“喜欢你”"><a href="#三叶在奔跑中跌倒，看到了“喜欢你”" class="headerlink" title="三叶在奔跑中跌倒，看到了“喜欢你”"></a>三叶在奔跑中跌倒，看到了“喜欢你”</h3><p>泷在经历了自己手机上的My diary里面变成一堆乱码，发现似乎名字与事件不能同时留下，选择在三叶的手上写下“喜欢你”，而三叶在奔跑中跌倒，看到了这句话。这句话，是泷对三叶的爱。而三叶在见到之后，知道自己不是孤单一人，有泷和她一起努力拯救镇子，泷也在努力拯救他。三叶更加努力的奔跑，与镇长父亲协商转移居民，去完成泷未完成的事情，去拯救整个镇子。</p><h3 id="【隐藏线】二叶和镇长"><a href="#【隐藏线】二叶和镇长" class="headerlink" title="【隐藏线】二叶和镇长"></a>【隐藏线】二叶和镇长</h3><p>泷in三叶和一叶的对话中提到，宫水家族的人在青春期总会进行这样的“梦”。而在外传中提到，镇长是其他地方的望族，入赘糸守镇。并且由于他们青春期也经历过泷和三叶这样的互换，虽然梦醒来遗忘了，但是潜意识里面让二叶一见面就和他产生好感，最后结婚。<br>最终成为镇长，在彗星坠落的时候顺利的以避难演习为名，转移全镇人员，完成了最终的拯救。<br>如果缺失了二叶和镇长的努力，三叶和泷的努力恐怕没有这样的结果，糸守镇也不会得以幸存。<br>就此，神明1200年的守护与宫水家族的任务，终于结束。</p><h2 id="彗星的意义"><a href="#彗星的意义" class="headerlink" title="彗星的意义"></a>彗星的意义</h2><p>糸守镇诞生于1200年前的彗星陨落，也毁灭于彗星的再次陨落。</p><h2 id="我们是否也在遗忘？该怎么做？"><a href="#我们是否也在遗忘？该怎么做？" class="headerlink" title="我们是否也在遗忘？该怎么做？"></a>我们是否也在遗忘？该怎么做？</h2><p>遗忘贯穿了整部影片，不止影片，生活中我们也在不断遗忘着，遗忘着自己的初心，遗忘着自己的梦想，遗忘着自己的爱。而在遗忘之后，我们又该如何做呢？泷和三叶反抗着遗忘，去追寻对方，我们是不是也是经历过邂逅，然后遗忘，然后再次邂逅呢？泷和三叶的两次擦肩而过，在第二次泷终于选择直面三叶，三叶也终于发现了自己所追寻的人。</p><h2 id="这是一个关于爱情的故事"><a href="#这是一个关于爱情的故事" class="headerlink" title="这是一个关于爱情的故事"></a>这是一个关于爱情的故事</h2><p>每个人在成长中经历的故事不一样，而每个人是否相信对新海诚影片中主题的爱也不一样。新海诚描绘了他心中的爱情，我认为也是极为纯粹的爱情，两个人在不断交换中拯救对方，了解对方。而你是否愿意相信这样的爱呢？现在我们所接触到的爱情，不可否认的有很多基于利益，基于物质，昂或只是基于诞生下一代。而这样的爱情，是否也是我们所追求的呢？<br>如果你在内心中接受这样的故事，愿意相信这样的爱情，那么这部影片对你来说，是一部值得一看的影片。</p>]]></content>
      
      
      <categories>
          
          <category> 评价 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 你的名字 </tag>
            
            <tag> 影评 </tag>
            
            <tag> 新海诚 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cloudflare出现了CurvePreferences-includes-unsupported-curve错误</title>
      <link href="/blog/openwrt-cloudflared-curvepreferences-includes-unsupported-curve/"/>
      <url>/blog/openwrt-cloudflared-curvepreferences-includes-unsupported-curve/</url>
      
        <content type="html"><![CDATA[<h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><p>在Openwrt的cloudflared中，当你使用新版本时（2024年3月或者4月开始），可能会出现<code>CurvePreferences includes unsupported curve</code>错误，这是因为新版本的cloudflared使用了新的加密算法，而这个要求Go构建工具链的更新。<br>而Openwrt上的cloudflared并没有更新工具链，所以会出现这个错误。</p><h2 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h2><p>目前解决方法可以通过使用旧版本的cloudflared（不推荐），或者修改参数让它只使用HTTP2协议，而不是默认的QUIC协议。</p><p>修改运行参数，加上<code>--protocol http2</code>。如果不加，默认是使用auto，但是那个auto只会使用QUIC协议来链接，无法自动切换到HTTP2，只会报<code>CurvePreferences includes unsupported curve</code>，然后访问时候提示<code>Argo ERROR</code>。</p><p>提及的Issues<br><a href="https://github.com/openwrt/packages/issues/23852">https://github.com/openwrt/packages/issues/23852</a><br><a href="https://github.com/cloudflare/cloudflared/issues/1158">https://github.com/cloudflare/cloudflared/issues/1158</a></p>]]></content>
      
      
      <categories>
          
          <category> openwrt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> cloudflare </tag>
            
            <tag> tunnel </tag>
            
            <tag> openwrt </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Git子模块教程：更换Hexo博客主题</title>
      <link href="/blog/git-submodule-blog-change-theme/"/>
      <url>/blog/git-submodule-blog-change-theme/</url>
      
        <content type="html"><![CDATA[<h2 id="0-背景"><a href="#0-背景" class="headerlink" title="0.背景"></a>0.背景</h2><p>很久之前写的博客使用Hexo搭建<a href="https://tokisaki.top/blog/make-blog/">传送门</a>，不同于其他教程，我主张把存储库整个作为<strong>私有存储库</strong>放到github上。<br>优点包括没必要用当时装hexo的电脑写文章，可以用github网页版直接传一个md文件就可以。<br>而且原版的方式如果想迁移很麻烦，因为是本地编译，每次迁移要下载一堆库。而我这种方式只需要把存储库clone下来就可以了（由Serverless平台来编译成静态文件）。</p><p>而我的这种方式更换主题不同于其他方式，需要作为submodule来处理。<br>我使用的方法主题是一个从别人那里fork来的独立的存储库，可以很容易的直接在github网页版更新后继版本。<br>而其他人的deploy方法是直接把主题clone到themes文件夹下，这样就没法直接更新了。</p><p>所以我这里记录一下如何使用git submodule更换主题。</p><h2 id="1-找一个主题，然后fork"><a href="#1-找一个主题，然后fork" class="headerlink" title="1. 找一个主题，然后fork"></a>1. 找一个主题，然后fork</h2><h2 id="2-设置submodule"><a href="#2-设置submodule" class="headerlink" title="2.设置submodule"></a>2.设置submodule</h2><h3 id="方式一：直接设置"><a href="#方式一：直接设置" class="headerlink" title="方式一：直接设置"></a>方式一：直接设置</h3><p><a href="https://zhuanlan.zhihu.com/p/404615843">知乎submodule教程</a></p><blockquote><p>添加一个远程仓库项目 <a href="https://github.com/iphysresearch/GWToolkit.git">https://github.com/iphysresearch/GWToolkit.git</a> 子模块到一个已有主仓库项目中。代码形式是 git submodule add <url> <repo_name>， 如下面的例子：<code>git submodule add https://github.com/iphysresearch/GWToolkit.git GWToolkit</code><br>如果你是旧版 Git 的话，你会发现 .&#x2F;GWToolkit 目录中是空的，你还需要在执行一步「更新子模块」，才可以把远程仓库项目中的内容下载下来。<code>$ git submodule update --init --recursive</code></repo_name></url></p></blockquote><h3 id="方式二：手动设置-推荐"><a href="#方式二：手动设置-推荐" class="headerlink" title="方式二：手动设置(推荐)"></a>方式二：手动设置(推荐)</h3><p>在主题文件夹下面clone你fork来的主题存储库。<br>在主存储库目录（和.git同级的目录）下面创建<code>.gitmodules</code>文件，写入下面内容</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">[submodule <span class="hljs-string">&quot;themes/hexo-theme-matery&quot;</span>]<br>path = themes/hexo-theme-matery<br>url = https://github.com/Tokisaki-Galaxy/hexo-theme-matery.git<br></code></pre></td></tr></table></figure><p>进入主存储库目录下面的.git文件夹，修改config文件，添加下面内容</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">[submodule <span class="hljs-string">&quot;themes/hexo-theme-matery&quot;</span>]<br>url = https://github.com/Tokisaki-Galaxy/hexo-theme-matery.git<br></code></pre></td></tr></table></figure><p>最后使用<code>git submodule status</code>来检查是否正确设置。</p><h3 id="异常处理"><a href="#异常处理" class="headerlink" title="异常处理"></a>异常处理</h3><p>一般来讲只要使用手动设置就不会有问题。如果你无法使用方法一，请直接使用方法二手动添加。</p><p>检查步骤：</p><ul><li>检查主存储库目录下面是否存在.gitmodules文件。</li><li>检查主存储库.git目录下面config文件夹是否存在[submodules]标签。</li><li>执行<code>git submodule status</code>，如果显示为 <code>No submodule mapping found</code>，表示子模块的仓库没有在本地克隆。我们可以使用 <code>git submodule update --init</code> 命令来克隆子模块的仓库到本地。</li></ul><h2 id="3-检查设置成submodule"><a href="#3-检查设置成submodule" class="headerlink" title="3.检查设置成submodule"></a>3.检查设置成submodule</h2><p>把本地的所有更改提交到主存储库，然后push到github。打开Github你的存储库网站，检查是否有主题文件夹图标不同，而且名字后面有@xxxx的版本号。如果不存在请进行手动设置。（一般是缺少.gitmodules文件）<br>并且点击名字后面有@xxxx的子模块进去检查是否能进入，是否有文件。</p>]]></content>
      
      
      <categories>
          
          <category> blog </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Github </tag>
            
            <tag> Hexo </tag>
            
            <tag> Git </tag>
            
            <tag> Submodule </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ZeroTier原理与实践</title>
      <link href="/blog/zerotier-network/"/>
      <url>/blog/zerotier-network/</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>因为网络上这方面的信息很少，我在使用的时候有时摸不着头脑，所以写下来供后人参考。<br><a href="https://docs.zerotier.com/protocol">ZeroTier协议议定书</a>，下面简称议定书。截止本文书写日期2024&#x2F;04&#x2F;11，现在处于v1版本，v2版本据说会大改，但是已经放卫星放四年了，而且这种网络基础设施应该会保持向下兼容，故信息大体上应该长期有效，细枝末节以当前版本为准。</p><h3 id="什么是Planet"><a href="#什么是Planet" class="headerlink" title="什么是Planet"></a>什么是Planet</h3><blockquote><p>To achieve this VL1 is organized like DNS. At the base of the network is a collection of always-present root servers whose role is similar to that of DNS root name servers. Roots run the same software as regular endpoints but reside at fast stable locations on the network and are designated as such by a world definition. World definitions come in two forms: the planet and one or more moons. The protocol includes a secure mechanism allowing world definitions to be updated in-band if root servers’ IP addresses or ZeroTier addresses change.<br>There is only one planet. Earth’s root servers are operated by ZeroTier, Inc. as a free service. There are currently four root servers distributed across the globe and multiple network providers. Almost everyone in the world has one within less than 100ms network latency from their location.</p></blockquote><p><em>其实我觉得ZeroTier里面的Planet和流浪地球电影版里面的全球根服务器非常非常相似</em></p><p>在ZeroTier世界里面，一切以Planet中心为主，可以理解成DNS里面的根服务器（他们也确实这么称呼，在议定书里面称为RootServers）。所有节点在联网的时候都会去尝试连接Planet来获得其他节点的信息。官方提供的Planet服务器是免费的。<br>Planet的功能包括，<strong>记录所有联网节点网络信息</strong>（记住这个），记录节点互联所使用的密钥并提供交换服务，在节点无法互相直连的情况下提供中继。</p><p>ZeroTier公司提供收费服务的<strong>只有网页端的<a href="https://my.zerotier.com/">Controller</a></strong>。其中的25个设备限制我们只需要自行建立Controller即可绕过，<strong>但是</strong>自建的Controller没有SSO，Ruler之类的功能。</p><p>zerotier在初次启动的时候会从Planet获得所有所需要的连接信息，首先会尝试通过ID定位Moon（如果设置）信息，并且缓存下来，如果无法连接到Planet会连接到缓存的Moon。</p><h3 id="什么是Moon"><a href="#什么是Moon" class="headerlink" title="什么是Moon"></a>什么是Moon</h3><p>Planet和Moon的关系可以理解成Moon是自己建立的Private Root Servers。功能<strong>基本上</strong>和Planet是完全一致的。<br>如果你<a href="https://docs.zerotier.com/roots">选择自建Moon服务器</a>，Moon服务器为了保证稳定性，官方建议不再承担其他网络功能（作为LEAF之类的）。所以意味着只要你知道别人的Moon服务器ID，<strong>可以直接加入，不需要对方同意。</strong></p><h4 id="加入Moon方式"><a href="#加入Moon方式" class="headerlink" title="加入Moon方式"></a>加入Moon方式</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">zerotier-cli orbit &lt;world ID&gt; &lt;seed&gt; - Join a moon via any member root<br><span class="hljs-comment">#一般情况下world ID和seed可以一样</span><br></code></pre></td></tr></table></figure><h2 id="链路层结构"><a href="#链路层结构" class="headerlink" title="链路层结构"></a>链路层结构</h2><p>ZeroTier链路层分为VL1和VL2。<br>VL1称为点对点网络，只用于连接到基础设施Planet和Moon，以获取网络配置。在大部分情况是零配置，不需要关注。<br>VL2称为以太网虚拟层，是你自己通过my.zerotier.com或者自行构建Controller建立的网络<br>Planet&#x2F;Moon 是 Zerotier VL1 层的设施，主要用来辅助 Peer 之间的连接建立。Controller 是 VL2 层的设施，主要用来保存虚拟网的配置。一个虚拟网中的设备首先要接入 VL1 与 Controller 沟通，最后才能接入 VL2 中的一个虚拟网。</p><h2 id="节点类型"><a href="#节点类型" class="headerlink" title="节点类型"></a>节点类型</h2><p>在执行<code>zerotier-cli peers</code>之后，其中<code>&lt;role&gt;</code>中可以看到每个节点的类型，这些类型是在VL1层中的角色。其中有LEAF,PLANET,MOON。<br>LEAF是普通的节点，<strong>一般</strong>是你的设备连上去之后会直接变成LEAF。</p><h2 id="Controller"><a href="#Controller" class="headerlink" title="Controller"></a>Controller</h2><p>Controller位于链路层的VL2中，在VL1中是一个特殊的LEAF。<br>如果你想加入一个网络，或连接这个网络上的其他节点，你首先需要连接这个网络对应的Controller。<br>如果无法连接到Controller，表现为一直显示为Request Configure（请求配置中）。</p><p>如果你认真看完上面的文字，你应该明白Controller是不需要有公网IP的，但是要求必须连接稳定。<em>为了这点，我自己是在Moon上面运行Controller，但是官方其实不建议这样做</em><br><a href="https://docs.zerotier.com/controller">ZeroTier官方提供了搭建Controller的方式</a>，但是官方给出的是命令行的形式，已经有人套了个GUI，名字叫ztncui。</p><h2 id="ztncui搭建"><a href="#ztncui搭建" class="headerlink" title="ztncui搭建"></a>ztncui搭建</h2><p><a href="https://key-networks.com/ztncui/">https://key-networks.com/ztncui/</a><br>注意最好不要使用ZeroTier网络来访问搭建好的Controller，因为这样如果出问题很容易丢失访问权限。我建议用CloudFlare Tunnel来访问，还可以设置二步验证，增强安全性。<br>ztncui默认是https协议，没有http协议，其证书是自签的。使用Cloudflare Tunnel来映射到域名访问，需要在Cloudflare里面设置要开启运行任意证书（因为默认Tunnel不认自签证书）才能正常访问。</p><p>下面是一些有用的快速脚本。</p><h2 id="搭建moon的快速命令"><a href="#搭建moon的快速命令" class="headerlink" title="搭建moon的快速命令"></a>搭建moon的快速命令</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> /var/lib/zerotier-one<br><span class="hljs-built_in">sudo</span> su<br><span class="hljs-comment">#zerotier-idtool initmoon identity.public &gt; moon.json</span><br><span class="hljs-built_in">exit</span><br><br><span class="hljs-comment">#下面几行可以保存为一个脚本，之后只用改moon.json里面的stablePoint</span><br>zerotier-idtool genmoon moon.json<br><span class="hljs-built_in">sudo</span> <span class="hljs-built_in">mv</span> 000000??????????.moon moons.d/<br><span class="hljs-built_in">sudo</span> systemctl restart zerotier-one<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> cloudflare </tag>
            
            <tag> ZeroTier </tag>
            
            <tag> Argo </tag>
            
            <tag> 路由 </tag>
            
            <tag> ztncui </tag>
            
            <tag> Planet </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>openwrt找出占用空间最大的文件</title>
      <link href="/blog/router-openwrt-common-operate/"/>
      <url>/blog/router-openwrt-common-operate/</url>
      
        <content type="html"><![CDATA[<p>OpenWrt的find命令不支持-size +1M这种格式。所以我们如果想找分类出大于1M的文件，可以使用-size +1048576c来代替。<br>1048576是1MB的字节数，c表示计数的是字节。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">find / -<span class="hljs-built_in">type</span> f -size +1048576c -<span class="hljs-built_in">exec</span> <span class="hljs-built_in">du</span> -h &#123;&#125; \;    <span class="hljs-comment"># 查找大于1M的文件</span><br></code></pre></td></tr></table></figure><p>然后可以去删除不需要的文件，毕竟硬路由寸金寸土。</p>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> openwrt </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在OpenWrt上安装cloudflared服务</title>
      <link href="/blog/router-openwrt-cloudflare/"/>
      <url>/blog/router-openwrt-cloudflare/</url>
      
        <content type="html"><![CDATA[<p>openwrt使用cloudflared安装服务的时候会有兼容性问题，问题出现在&#x2F;etc&#x2F;init.d&#x2F;目录下的服务脚本，默认使用的是SysVinit，而cloudflared使用的是procd。所以我们需要修改服务脚本，将其改为procd的格式。</p><p><strong>SysVinit</strong> 是许多早期 Linux 发行版使用的传统初始化系统。它使用一系列的 shell 脚本，按照特定的顺序启动各种服务。这些脚本通常位于 <code>/etc/init.d/</code> 目录中，每个脚本对应一个服务。SysVinit 的主要缺点是它启动服务的方式是线性的，不能并行启动，这可能导致启动时间较长。</p><p><strong>procd</strong> 是 OpenWrt 使用的初始化系统。与 SysVinit 不同，procd 可以并行启动服务，从而加快系统启动时间。procd 还提供了一些其他高级功能，如进程监控、自动重启和 cgroup 管理。procd 的服务脚本通常位于 <code>/etc/init.d/</code> 目录中，与 SysVinit 类似，但它们的格式和语法有所不同。</p><p>修改完<code>/etc/init.d/cloudflared</code>后，使用<code>/etc/init.d/cloudflared restart</code>重启服务即可。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/sh /etc/rc.common</span><br><span class="hljs-comment"># Copyright (C) 2021 Tianling Shen &lt;cnsztl@immortalwrt.org&gt;</span><br><br>USE_PROCD=1<br>START=99<br><br>CONF=<span class="hljs-string">&quot;cloudflared&quot;</span><br>PROG=<span class="hljs-string">&quot;/usr/bin/cloudflared&quot;</span><br><br><span class="hljs-function"><span class="hljs-title">start_service</span></span>() &#123;<br>    procd_open_instance<br>    procd_set_param <span class="hljs-built_in">command</span> <span class="hljs-string">&quot;<span class="hljs-variable">$PROG</span>&quot;</span> <span class="hljs-string">&quot;--pidfile&quot;</span> <span class="hljs-string">&quot;/var/run/<span class="hljs-variable">$CONF</span>.pid&quot;</span> <span class="hljs-string">&quot;--logfile&quot;</span> <span class="hljs-string">&quot;/var/log/cloudflared.log&quot;</span> <span class="hljs-string">&quot;--protocol&quot;</span> <span class="hljs-string">&quot;http2&quot;</span> <span class="hljs-string">&quot;--no-autoupdate&quot;</span> <span class="hljs-string">&quot;tunnel&quot;</span> <span class="hljs-string">&quot;run&quot;</span> <span class="hljs-string">&quot;--token&quot;</span> <span class="hljs-string">&quot;xxxxxxxxxxxxxxxx&quot;</span><br>    procd_set_param stdout 1<br>    procd_set_param stderr 1<br>    procd_set_param pidfile <span class="hljs-string">&quot;/var/run/<span class="hljs-variable">$CONF</span>.pid&quot;</span><br>    procd_close_instance<br>&#125;<br><br><span class="hljs-function"><span class="hljs-title">stop_service</span></span>() &#123;<br>    procd_kill <span class="hljs-variable">$CONF</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-title">reload_service</span></span>() &#123;<br>    stop<br>    start<br>&#125;<br><br><span class="hljs-function"><span class="hljs-title">service_triggers</span></span>() &#123;<br>    procd_add_reload_trigger <span class="hljs-string">&quot;<span class="hljs-variable">$CONF</span>&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> openwrt </tag>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在pwsh里面使用终端Github Copilot</title>
      <link href="/blog/github-copilot/"/>
      <url>/blog/github-copilot/</url>
      
        <content type="html"><![CDATA[<p>如果在终端里面也可以使用github copilot将会方便很多，很多命令不用刻意去记忆，也不用去网上找很久。</p><span id="more"></span><p>先去下载<a href="https://cli.github.com/">Github-CLI</a>。<br>然后用<code>gh auth login</code>登陆，默认是不安装copilot的，要手动安装插件<code>gh extension install github/gh-copilot</code>。</p><p>测试一下<code>gh copilot</code>是不是正常使用。</p><p>然后设置别名，方便使用。<br>通过读取配置文件<code>echo $PROFILE</code>的路径，然后修改<code>notepad $PROFILE</code>。<br>加入以下内容。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">function Github-Copilot-Explain &#123; gh copilot explain $args &#125;<br>function Github-Copilot-Suggest &#123; gh copilot suggest $args &#125;<br><br>Set-Alias -Name cs -Value Github-Copilot-Suggest<br>Set-Alias -Name ce -Value Github-Copilot-Explain<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 编程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Windows Terminal </tag>
            
            <tag> Powershell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>解决REFS卷变成RAW的经历</title>
      <link href="/blog/refs-salvage-experience/"/>
      <url>/blog/refs-salvage-experience/</url>
      
        <content type="html"><![CDATA[<h2 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h2><p>之前听闻REFS文件系统对NVME和SMR HDD有特别的优化，而且数据安全更好，是未来代替NTFS的文件系统。<br>所以一年前的时候把两个分区格式化成REFS来试试水。确实效果不错，<strong>除了OneDrive没法在REFS分区上用以外。</strong></p><p>前几天突然内置的SMR HDD在系统更新之后变成了RAW分区。一开始是尝试在文件浏览器里面打开，显示参数错误。后来磁盘管理里显示RAW分区。<br>一开始以为是系统更新的问题，但是发现另一个REFS分区可以打开，突发奇想去事件管理器里一看，发现原来分区挂了。<br><img src="https://pic.imgdb.cn/item/652d57f2c458853aef660f9d.png" alt="无法打开"></p><p>然后接着发现电脑很卡，在任务管理器里面看到那个已经挂的磁盘占用率持续90%+的读写，很好奇在干嘛，然后发现事件管理器里面提示这个。</p><p><img src="https://pic.imgdb.cn/item/652d57f1c458853aef660d88.png" alt="自动修复不成功"><br><img src="https://pic.imgdb.cn/item/652d5e21c458853aef7691e4.png" alt="无法纠正"></p><p>那就只能去整数据恢复了。一开始我打算用R-Studio。<br>但是发现虽然REFS分区现在可以用R-Studio，但是REFS文件系统在快速迭代，那个软件更新速度赶不上微软的更新速度。所以我用那个软件恢复出来的文件是没有文件目录结构的。最后还是用微软自己家的数据恢复工具refsutil。</p><h2 id="REFS数据打捞工具refsutil"><a href="#REFS数据打捞工具refsutil" class="headerlink" title="REFS数据打捞工具refsutil"></a>REFS数据打捞工具refsutil</h2><h3 id="什么是refsutil"><a href="#什么是refsutil" class="headerlink" title="什么是refsutil"></a>什么是refsutil</h3><p>用于诊断严重损坏的 ReFS 卷（变成RAW）、识别剩余文件，并将这些文件复制到另一个卷。<br>该工具位于 %SystemRoot%\Windows\System32 文件夹中。<br><strong>除非卷为 RAW，否则不必使用 ReFSutil 工具。 如果为只读，则仍可访问数据。</strong></p><p><a href="https://learn.microsoft.com/zh-cn/windows-server/administration/windows-commands/refsutil">Microsoft对refsutil的介绍</a></p><h3 id="怎么用"><a href="#怎么用" class="headerlink" title="怎么用"></a>怎么用</h3><blockquote><p>ReFS Salvage 有两个阶段：扫描阶段和复制阶段。 在自动模式下，扫描阶段和复制阶段将按顺序运行。 在手动模式下，每个阶段都可以单独运行。 进度和日志保存在工作目录中，以允许单独运行阶段以及暂停和恢复扫描阶段。</p></blockquote><p>1.确定为什么不能挂载<br>2.快速扫描阶段<br>3.完全扫描阶段<br>4.查看交互式控制台(因为可以看看哪些不需要的，然后在txt文件里删掉)<br>5.使用列表的复制阶段，把选择的文件复制出来</p><p>确定目标卷是否为refs卷，并确定该卷是否可装载。 如果卷不可装载，则会提供原因。<br><img src="https://pic.imgdb.cn/item/652d57fbc458853aef6629f8.png" alt="诊断扫描"></p><p><img src="https://pic.imgdb.cn/item/652d57f2c458853aef6610b8.png" alt="快速扫描阶段"></p><p><img src="https://pic.imgdb.cn/item/652d57f1c458853aef660ca4.png" alt="完全扫描阶段"></p><h2 id="后期的思路"><a href="#后期的思路" class="headerlink" title="后期的思路"></a>后期的思路</h2><h3 id="启动REFS的完整性流功能"><a href="#启动REFS的完整性流功能" class="headerlink" title="启动REFS的完整性流功能"></a>启动REFS的完整性流功能</h3><p>启动完整性流可能有帮助，完整性流是REFS的一项可选功能，保证获得数据是原始未出错。</p><blockquote><p>完整性流是 ReFS 中的可选功能，它使用校验和来验证和维护数据完整性。虽然 ReFS 始终对元数据使用校验和，但默认情况下，ReFS 不会为文件数据生成或验证校验和。 完整性流是一项可选功能，允许用户对文件数据使用校验和。 启用完整性流后，ReFS 可以清楚地确定数据是否有效或已损坏。 此外，ReFS 和存储空间可以共同自动地更正损坏的元数据和数据。</p></blockquote><p><strong>！！！对性能有负面影响哦！！！</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">Get-Item -Path <span class="hljs-string">&#x27;C:\*&#x27;</span> | Set-FileIntegrity -Enable <span class="hljs-variable">$True</span><br>Set-FileIntegrity C:\ -Enable <span class="hljs-variable">$True</span><br><br>Get-Item -Path <span class="hljs-string">&#x27;C:\*&#x27;</span> | Set-FileIntegrity -Enable <span class="hljs-variable">$False</span><br>Set-FileIntegrity C:\ -Enable <span class="hljs-variable">$False</span><br><br>Get-Item -Path <span class="hljs-string">&#x27;C:\*&#x27;</span> | Get-FileIntegrity<br>Get-Item -Path <span class="hljs-string">&#x27;C:\&#x27;</span> | Get-FileIntegrity<br></code></pre></td></tr></table></figure><h3 id="使用软RAID阵列"><a href="#使用软RAID阵列" class="headerlink" title="使用软RAID阵列"></a>使用软RAID阵列</h3><p>使用VHDX的虚拟硬盘，并且使用Windows的存储池功能，构造软RAID1。分布在两个硬盘上提升可靠性。</p>]]></content>
      
      
      <categories>
          
          <category> 数据恢复 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Windows </tag>
            
            <tag> REFS </tag>
            
            <tag> refsutil </tag>
            
            <tag> 数据恢复 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>小米R3G刷机breed后刷openwrt</title>
      <link href="/blog/r3g-flush-breed-openwrt/"/>
      <url>/blog/r3g-flush-breed-openwrt/</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>挺早之前打算买个路由器玩，因为学了网络技术这么久都没用上，很想玩。<br>其次宿舍里打游戏有时候要局域网，总是开热点不方便。所以整个路由器刷个openwrt是个不错的选择。<br>一开始我打算选随身wifi，但是发现那高通CPU太弱了，根本带不动游戏联机，所以买了台据说对标K2P的R3G。<br>因为第一次刷breed和openwrt，网上没有什么现成的教程。七零八碎，版本也不对的教程看的挺难受，一路上挺坎坷的，终于成功之后记录一下过程。</p><h2 id="打开SSH"><a href="#打开SSH" class="headerlink" title="打开SSH"></a>打开SSH</h2><p>先刷入开发版的ROM。将下载的ROM包复制到FAT32格式U盘的根目录，并重命名为miwifi.bin ，同时确保该目录下不存在其它“.bin”文件，若存在会导致刷机失败。<br><a href="https://www.miwifi.com/miwifi_download.html">https://www.miwifi.com/miwifi_download.html</a></p><blockquote><p>断开小米路由器的电源，将U盘插入路由器USB接口；<br>按住reset键，接通电源，等待指示灯变为黄色闪烁状态后松开reset键，路由器开始刷机；<br>等待刷机完成，整个过程约为3-5分钟，完成后系统会自动重启。路由器指示灯变蓝刷机完成；如果出现异常、失败、U盘无法读取的状况，会进入红灯状态，建议重试或更换U盘再试。</p></blockquote><p><strong>手机要装MiWIFI的APP</strong>，然后绑定账号（不然用不了SSH）。绑定之后访问这个网站，下载SSH工具包。<br><a href="https://d.miwifi.com/rom/ssh">https://d.miwifi.com/rom/ssh</a><br><em>也可以去看看什么强开SSH，但是有人反馈强开SSH得到的shell刷机失败</em></p><blockquote><p>请将下载的工具包bin文件复制到U盘（FAT&#x2F;FAT32格式）的根目录下，保证文件名为miwifi_ssh.bin；<br>断开小米路由器的电源，将U盘插入USB接口；<br>按住reset按钮之后重新接入电源，指示灯变为黄色闪烁状态即可松开reset键；<br>等待3-5秒后安装完成之后，小米路由器会自动重启，之后您就可以尽情折腾啦 ：）</p></blockquote><p>尝试SSH访问。因为路由器上的dropbear版本很古典，必须加额外参数兼容那个古老的算法。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ssh -oKexAlgorithms=+diffie-hellman-group1-sha1 -oHostKeyAlgorithms=+ssh-dss -oCiphers=+3des-cbc root@192.168.31.1<br></code></pre></td></tr></table></figure><p>否则无法连接，会出现出现</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">Unable to negotiate with 192.168.31.1 port 22: no matching key exchange method found. <br>Their offer: diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha1,diffie-hellman-group1-sha1<br></code></pre></td></tr></table></figure><p>当时因为没有网线，然后绑定账号必须要用手机APP。我用电脑共享到有线网到路由器，重置路由器好多次都不行，搞了好久。所以看到还挺激动的。<br><img src="https://pic.imgdb.cn/item/65257c99c458853aefc0c83d.png" alt="挺激动的"></p><h2 id="备份原始数据"><a href="#备份原始数据" class="headerlink" title="备份原始数据"></a>备份原始数据</h2><p>每台机器的备份有略微不同，混用同一型号其他机器的备份可能会导致信号很差。<br><code>cat /proc/mtd</code>查看分区表，然后依次备份</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">dd</span> <span class="hljs-keyword">if</span>=/dev/mtd0 of=/extdisks/sda/ALL.bin<br><span class="hljs-built_in">dd</span> <span class="hljs-keyword">if</span>=/dev/mtd1 of=/extdisks/sda/Bootloader.bin<br><span class="hljs-built_in">dd</span> <span class="hljs-keyword">if</span>=/dev/mtd2 of=/extdisks/sda/Config.bin<br><span class="hljs-built_in">dd</span> <span class="hljs-keyword">if</span>=/dev/mtd3 of=/extdisks/sda/Bdata.bin<br><span class="hljs-built_in">dd</span> <span class="hljs-keyword">if</span>=/dev/mtd4 of=/extdisks/sda/Factory.bin<br><span class="hljs-built_in">dd</span> <span class="hljs-keyword">if</span>=/dev/mtd5 of=/extdisks/sda/crash.bin<br><span class="hljs-built_in">dd</span> <span class="hljs-keyword">if</span>=/dev/mtd6 of=/extdisks/sda/crash_syslog.bin<br><span class="hljs-built_in">dd</span> <span class="hljs-keyword">if</span>=/dev/mtd7 of=/extdisks/sda/reserved0.bin<br><span class="hljs-built_in">dd</span> <span class="hljs-keyword">if</span>=/dev/mtd8 of=/extdisks/sda/kernel0.bin<br><span class="hljs-built_in">dd</span> <span class="hljs-keyword">if</span>=/dev/mtd9 of=/extdisks/sda/kernel1.bin<br><span class="hljs-built_in">dd</span> <span class="hljs-keyword">if</span>=/dev/mtd10 of=/extdisks/sda/rootfs0.bin<br><span class="hljs-built_in">dd</span> <span class="hljs-keyword">if</span>=/dev/mtd11 of=/extdisks/sda/rootfs1.bin<br><span class="hljs-built_in">dd</span> <span class="hljs-keyword">if</span>=/dev/mtd12 of=/extdisks/sda/overlay.bin<br><span class="hljs-built_in">dd</span> <span class="hljs-keyword">if</span>=/dev/mtd13 of=/extdisks/sda/ubi_rootfs.bin<br><span class="hljs-built_in">dd</span> <span class="hljs-keyword">if</span>=/dev/mtd14 of=/extdisks/sda/data.bin <span class="hljs-comment">#这一行可能会因为设备忙无法备份，没关系</span><br></code></pre></td></tr></table></figure><h3 id="还原备份"><a href="#还原备份" class="headerlink" title="还原备份"></a>还原备份</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">mtd write /extdisks/sda/Bootloader.bin Bootloader<br>mtd write /extdisks/sda/Config.bin Config<br>mtd write /extdisks/sda/Bdata.bin Bdata<br>mtd write /extdisks/sda/Factory.bin Factory<br>mtd write /extdisks/sda/crash.bin crash<br>mtd write /extdisks/sda/crash_syslog.bin crash_syslog<br>mtd write /extdisks/sda/reserved0.bin reserved0<br>mtd write /extdisks/sda/kernel0.bin kernel0<br>mtd write /extdisks/sda/kernel1.bin kernel1<br>mtd write /extdisks/sda/rootfs0.bin rootfs0<br>mtd write /extdisks/sda/rootfs1.bin rootfs1<br>mtd write /extdisks/sda/overlay.bin overlay<br>mtd write /extdisks/sda/ubi_rootfs.bin ubi_rootfs<br></code></pre></td></tr></table></figure><h2 id="刷breed"><a href="#刷breed" class="headerlink" title="刷breed"></a>刷breed</h2><p>当时很担心成砖，所以上一步备份我备份了三次，都比较了CRC32，发现均相同才敢接着刷。<br>（其实现在想起来没必要这么谨慎，但是也挺好的习惯）</p><p>下载breed，在目录里搜索文件名包含R3G的文件，下载<br><a href="https://breed.hackpascal.net/">https://breed.hackpascal.net/</a></p><p>使用WinSCP来传输文件到临时目录，协议使用SCP，不要用SFTP。（注意，FileZilla因为只支持SFTP，所以用不了。）<br>这个网站下载的是最新版，截止目前的时间，是1.2版本，和1.1版本的Web操作有较大差异。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">mtd -r write /tmp/XXX.bin Bootloader<br></code></pre></td></tr></table></figure><p><img src="https://pic.imgdb.cn/item/65257c98c458853aefc0c82e.png" alt="刷breed"></p><p>确认完成之后，按住RESET键开机。<br>等到路由的灯闪烁时候，松开RESET键，浏览器访问192.168.1.1。（一般情况下不需要手动分配IP地址,有DHCP）</p><p><img src="https://pic.imgdb.cn/item/65257c98c458853aefc0c808.png" alt="breed的web界面"></p><h3 id="在控制台中备份"><a href="#在控制台中备份" class="headerlink" title="在控制台中备份"></a>在控制台中备份</h3><p>备份EEPROM和编程器固件。其中最重要的是EEPROM。</p><h2 id="breed控制台刷入openwrt"><a href="#breed控制台刷入openwrt" class="headerlink" title="breed控制台刷入openwrt"></a>breed控制台刷入openwrt</h2><p>使用的是这个版本的openwrt<br><a href="https://www.right.com.cn/forum/forum.php?mod=viewthread&tid=8303844">https://www.right.com.cn/forum/forum.php?mod=viewthread&amp;tid=8303844</a></p><p>下载底包，然后上传。<br>在v1.2的breed中，只用选rootfs0和kernel1两个文件，外加闪存布局写Openwrt就可以，不需要额外设置环境变量，挺方便的。<br>勾上刷机之后自动重启，然后慢慢等，千万别断电就好。<br><em>据说v1.1的要设环境变量才能启动</em></p><p><img src="https://pic.imgdb.cn/item/65257c98c458853aefc0c7fb.png" alt="等自动重启就好"></p><p><strong>进入OPENWRT之后，不要以为结束了，需要继续进行固件更新，更新文件sysupgrade.bin。</strong></p><h2 id="一些其他的问题"><a href="#一些其他的问题" class="headerlink" title="一些其他的问题"></a>一些其他的问题</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">mtd write mir3g-squashfs-kernel1.binkernel1<br>mtd write mir3g-squashfs-rootfs0.binrootfs0<br>nvram <span class="hljs-built_in">set</span> flag_try_sys1_failed=1<br>nvram commit<br>reboot<br></code></pre></td></tr></table></figure><p>上述命令中nvram是uboot专有命令，Breed与uboot相互独立，参数不共用，根据国外论坛对于小米路由器原厂uboot的分析，小米路由器的kernel0包含的usb恢复的功能，就是将官方固件命名为miwifi.bin放入U盘内，断电时插入路由器，用硬物抵住reset键后插电，保持10秒左右，待黄灯快速闪动后可松手，可恢复至官方固件，这个功能可用于原厂固件损坏后的修复，也算是不错的功能，所以OpenWrt官网上的建议是将内核文件刷入kernel1</p><h2 id="更新源"><a href="#更新源" class="headerlink" title="更新源"></a>更新源</h2><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-string">src/gz</span> <span class="hljs-string">immortalwrt_core</span> <span class="hljs-string">https://mirror.sjtu.edu.cn/immortalwrt/snapshots/targets/ramips/mt7621/packages</span><br><span class="hljs-string">src/gz</span> <span class="hljs-string">immortalwrt_base</span> <span class="hljs-string">https://downloads.immortalwrt.org/snapshots/packages/mipsel_24kc/base</span><br><span class="hljs-string">src/gz</span> <span class="hljs-string">immortalwrt_luci</span> <span class="hljs-string">https://downloads.immortalwrt.org/snapshots/packages/mipsel_24kc/luci</span><br><span class="hljs-string">src/gz</span> <span class="hljs-string">immortalwrt_packages</span> <span class="hljs-string">https://downloads.immortalwrt.org/snapshots/packages/mipsel_24kc/packages</span><br><span class="hljs-string">src/gz</span> <span class="hljs-string">immortalwrt_routing</span> <span class="hljs-string">https://downloads.immortalwrt.org/snapshots/packages/mipsel_24kc/routing</span><br><span class="hljs-string">src/gz</span> <span class="hljs-string">immortalwrt_small8</span> <span class="hljs-string">https://downloads.immortalwrt.org/snapshots/packages/mipsel_24kc/small8</span><br><span class="hljs-string">src/gz</span> <span class="hljs-string">immortalwrt_telephony</span> <span class="hljs-string">https://downloads.immortalwrt.org/snapshots/packages/mipsel_24kc/telephony</span><br></code></pre></td></tr></table></figure><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-string">src/gz</span> <span class="hljs-string">immortalwrt_core</span> <span class="hljs-string">https://mirrors.cloud.tencent.com/openwrt/snapshots/targets/ramips/mt7621/packages</span><br><span class="hljs-string">src/gz</span> <span class="hljs-string">immortalwrt_base</span> <span class="hljs-string">https://mirrors.cloud.tencent.com/openwrt/snapshots/packages/mipsel_24kc/base</span><br><span class="hljs-string">src/gz</span> <span class="hljs-string">immortalwrt_luci</span> <span class="hljs-string">https://mirrors.cloud.tencent.com/openwrt/snapshots/packages/mipsel_24kc/luci</span><br><span class="hljs-string">src/gz</span> <span class="hljs-string">immortalwrt_packages</span> <span class="hljs-string">https://mirrors.cloud.tencent.com/openwrt/snapshots/packages/mipsel_24kc/packages</span><br><span class="hljs-string">src/gz</span> <span class="hljs-string">immortalwrt_routing</span> <span class="hljs-string">https://mirrors.cloud.tencent.com/openwrt/snapshots/packages/mipsel_24kc/routing</span><br><span class="hljs-string">src/gz</span> <span class="hljs-string">immortalwrt_small8</span> <span class="hljs-string">https://mirrors.cloud.tencent.com/openwrt/snapshots/packages/mipsel_24kc/small8</span><br><span class="hljs-string">src/gz</span> <span class="hljs-string">immortalwrt_telephony</span> <span class="hljs-string">https://mirrors.cloud.tencent.com/openwrt/snapshots/packages/mipsel_24kc/telephony</span><br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 捡垃圾 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> openwrt </tag>
            
            <tag> 刷机 </tag>
            
            <tag> 固件 </tag>
            
            <tag> R3G </tag>
            
            <tag> 路由 </tag>
            
            <tag> breed </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ChromeBook电池阈值限制充电到80%停止</title>
      <link href="/blog/chromebook-batterymanage/"/>
      <url>/blog/chromebook-batterymanage/</url>
      
        <content type="html"><![CDATA[<h2 id="目的"><a href="#目的" class="headerlink" title="目的"></a>目的</h2><p>前几天买的chromebook，然后有时候要长时间拿出去用，所以比较在意电池的健康。发现老是充电自动到100%，就写个小程序用来限制充电到80%。<br>C++写的，默认3分钟定时检查一次电量，所以如果有<strong>略微超出80%是正常情况</strong>。<br>平时在<strong>休眠状态资源占用极低</strong>。<br>确保两个exe文件在同一个目录下。</p><h2 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h2><h3 id="手动启动"><a href="#手动启动" class="headerlink" title="手动启动"></a>手动启动</h3><p>确保两个文件放在同一目录，点击chromebook_batterymanage.exe。</p><h3 id="自动启动"><a href="#自动启动" class="headerlink" title="自动启动"></a>自动启动</h3><p>确保两个文件放在同一目录，然后在”任务计划程序”里面创建计划，开机启动，执行chromebook_batterymanage.exe<br>预期情况，每隔3分钟检测一次电池电量，若大于等于80%，则停止向电池供电。不探测的时候后台休眠，占用极低。</p><h2 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h2><p><strong>感谢coreboot提供的ectool。</strong></p><p>真的希望大家顺路可以去gayhub点个star，<br><a href="https://github.com/Tokisaki-Galaxy/chromebook_batterymanage">github项目链接（首选）</a></p><p>分流地址（可能没有更新到最新版本）<br><a href="https://www.lanzouj.com/b00rw55id">https://www.lanzouj.com/b00rw55id</a><br>密码:grs8</p>]]></content>
      
      
      <categories>
          
          <category> 捡垃圾 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> coreboot </tag>
            
            <tag> chromebook </tag>
            
            <tag> windows </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>切换主题的纪念和一些想法</title>
      <link href="/blog/switch-theme-log/"/>
      <url>/blog/switch-theme-log/</url>
      
        <content type="html"><![CDATA[<h2 id="纪念"><a href="#纪念" class="headerlink" title="纪念"></a>纪念</h2><p>2023年1月24日晚上，三天前。</p><p>终于下决心把博客从以前的旧主题<code>hexo-theme-matery</code>切换成现在使用的<code>hexo-theme-fluid</code>。<br>不过也由于各种奇怪的问题，磨磨蹭蹭拖了两三天才弄完，至少解决了大部分问题。<br>旧的主题因为我当时使用的时候功能不多，我自己在自己的分支上添加了很多功能，修改了很多文件，结果更新的时候合并出一大堆问题，版本控制彻底爆炸。再加上没注释，很多东西我自己都不知道是啥。。<br>大部分是因为我之前在添加代码的时候完全没想到后续更新，然后随意添加代码，删改文件。然后git记录里面乱成一片，自己都不知道自己干什么。。</p><h2 id="想法和记录"><a href="#想法和记录" class="headerlink" title="想法和记录"></a>想法和记录</h2><p>在切换主题的时候，最大问题是hexo最近版本新引入的一个功能，覆盖主题设置，就是<code>_config.&lt;theme.name&gt;.yml</code>。<br>之前按照<a href="https://hexo.fluid-dev.com/docs/guide/#%E8%A6%86%E7%9B%96%E9%85%8D%E7%BD%AE">fluid docs 覆盖配置</a>来配置，但是搞了一天多一直不生效，但是我又不想直接去修改theme下的_config，所以一直搞不定，结果一天之后突发奇想把<code>_config.fluid.yml</code>名字改成<code>_config.hexo-theme-fluid.yml</code>，结果就成功了…</p><p>不得不说切换主题之后，加载速度快多了，而且Lighthouse评分也高多了。效果真的很显著，而且比以前看起来差不多。<br>以前的主题太注重各种好看的功能，加载了大量js和css，结果加载速度挺慢的，现在fluid在效果和加载速度中取得了不错的平衡。</p>]]></content>
      
      
      <categories>
          
          <category> blog </category>
          
      </categories>
      
      
        <tags>
            
            <tag> blog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>树莓派3b刷openwrt作为旁路由</title>
      <link href="/blog/rpi-openwrt-sideroute/"/>
      <url>/blog/rpi-openwrt-sideroute/</url>
      
        <content type="html"><![CDATA[<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://sspai.com/post/68511">Openwrt 作为旁路网关（不是旁路由、单臂路由）的终极设置方法，破解迷思</a></p><h2 id="固件下载"><a href="#固件下载" class="headerlink" title="固件下载"></a>固件下载</h2><p><a href="https://doc.openwrt.cc/2-OpenWrt-Rpi/">OpenWrt RPi</a></p><h2 id="刷机"><a href="#刷机" class="headerlink" title="刷机"></a>刷机</h2><p>用etcher就可以了，然后进Linux里面用GPart扩展分区，不然SD卡空间不能完全利用。</p><h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><p>emmm最后没做到少数派里面说的旁路网关，只做到了单臂路由。等哪天我做到旁路网关再回来吧。<br>旁路网关只影响上行数据，单臂路由会影响上下行。在树莓派3b上，网卡只有100M最高上限，所以跑不满，会影响网速。。。</p>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RPi </tag>
            
            <tag> openwrt </tag>
            
            <tag> 路由 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>debian重新命名网卡</title>
      <link href="/blog/debian-rename-network-interface/"/>
      <url>/blog/debian-rename-network-interface/</url>
      
        <content type="html"><![CDATA[<p>新买了个RTL8812BU网卡，打算用来给parrot用，然后去找了驱动装上之后，发现网卡名居然不是wlan0，是一串长长的名字，这个可忍不了。<br>parrot5是基于debian10 x64的。</p><p>查了一下，修改一下命名规则就好啦。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo nano /etc/default/grub<br></code></pre></td></tr></table></figure><p>将原来<code>GRUB_CMDLINE_LINUX=&quot;&quot;</code>改为<code>GRUB_CMDLINE_LINUX=&quot;net.ifnames=0 biosdevname=0&quot;</code>。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo update-grub<br></code></pre></td></tr></table></figure><p>另外，如果在使用过程中出现<code>write failed: Network is down</code>，需要把虚拟机设置，主机控制器里面兼容性从USB3.x改成USB2.0。</p>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Debian </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>晓龙410芯片随身wifi刷机浅谈</title>
      <link href="/blog/portable-wifi-flash/"/>
      <url>/blog/portable-wifi-flash/</url>
      
        <content type="html"><![CDATA[<p>之前在b站看到有人弄随身wifi刷机，感觉好奇怪。点进去一看发现这东西才不到20块钱，而且里面居然是晓龙410的芯片，跑着安卓4.4，然后去酷安找了个车买了俩。</p><p>刷root挺麻烦，我想只做一次root，然后之后买的同样的机器都可以直接刷进去就可以了，省时省力。<br>之前一直好奇QCN和救砖包到底是什么样的关系，网上有人说两者没有关系，然后我就信了那个鬼话，随便刷了miko全量包，结果基带丢了，联不了联网。。<br>这就说明，再使用miko保存救砖包的时候，把QCN文件也一起保存下来，所以在复制到其他机器会丢失QCN。。。<br>丢失QCN会导致无法使用基带，丢失IMEI。每个设备IMEI是独特的，一般来讲复制其他设备IMEI不可行。也就是说这玩意差点废了。<br>好在我事先用miko全量备份了，没酿成惨案。。<br>但是我一直想知道QCN和救砖包到底是什么样的关系。仔细想了想，备份QCN需要root，而且有提示是从NV Database里保存的，这说明QCN其实保存在系统可以访问的地方。。<br>所以我把两个型号一样的随身wifi全量包的每个文件，去用差异计算，寻找不同的地方，也就是保存QCN的位置。</p><p>两个随身wificlone下来的救砖包里基本所有文件都是一样的，有差异的是</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">cache.img<br>modemst1.img<br>modemst2.img<br>persist.img<br>userdata.img<br></code></pre></td></tr></table></figure><p>很神奇，一开始我预想的是modem.img会有差异，结果居然是一样的。<br>cache.img不管他，可以当成一样的。<br>对persist.img分析，里面差异文件是<code>[SYS]\Journal</code><br>所以根据文件名推测，里面应该不是重要文件，可以认为persist.img也是一致的。<br>所以到这里，知道了随身wifi不同设备不同的地方在于<code>modemst1.img modemst2.img</code>不同。所以可以认为QCN保存在这里。</p><p>由于这两个文件无法继续使用7zip简单的打开进行查看，所以不管他到底是哪个文件不同了。<br>不过我们知道QCN位置，所以可以通过Qualcomm Premium Tool刷写指定位置，这样就通过达到在新机器上直接flash预先做好的已经root的镜像，然后再烧一遍保存QCN的分区来达到简化操作的目的。</p><p>最后，通过这样保存分区来保存QCN，也不需要root，相较使用星海SVIP保存更加方便，速度也更加快。毕竟擦写分区可比用软件写QCN快多了。（不管是星海SVIP还是miko，读写QCN都好慢…）</p><p>最后测试一下，写了root的镜像，然后直接打开没有IMEI。重新烧录那两个分区，再打开就出现IMEI了。</p><p>有个很奇怪的问题，网上的教程都是使用Miko保存救砖包，然后再用Qualcomm Premium Tool保存全部文件。难道没有人知道miko生成的救砖包可以打开为压缩包，里面文件和用Qualcomm Premium Tool保存的一模一样吗，绝对是重复操作。或者说网上都是复制粘贴的吗。。<br>Qualcomm Premium Tool的作用无法替代，因为它可以单独擦写某个分区，但是我不认同网上千篇一律教程所说的miko保存一遍，Qualcomm Premium Tool再保存一遍的重复操作…</p>]]></content>
      
      
      <categories>
          
          <category> android&amp;linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> android </tag>
            
            <tag> 刷机 </tag>
            
            <tag> wifi </tag>
            
            <tag> 固件 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>解决WSA或WSL占用过多C盘空间</title>
      <link href="/blog/resolution-wsa-wsl-usage-much-system-space/"/>
      <url>/blog/resolution-wsa-wsl-usage-much-system-space/</url>
      
        <content type="html"><![CDATA[<p>因为我电脑一开始分区只给C盘分了100G，还加了Bitlocker加密，所以搞得现在空间不够用，而且还没法扩容（因为有BitLocker，没法扩容）。所以只好把安装的软件往外面迁，但是WSA是个占空间的大户，而且微软一如既往的不提供迁移方法，只好自己想办法解决。<br><strong>同时，此办法也适用于对WSA，WSL有备份需求的用户。</strong></p><h2 id="WSA迁移方法"><a href="#WSA迁移方法" class="headerlink" title="WSA迁移方法"></a>WSA迁移方法</h2><p>在文件浏览器中打开<code>%LocalAppData%\Packages\MicrosoftCorporationII.WindowsSubsystemForAndroid_8wekyb3d8bbwe\LocalCache</code>。<br>其中<code>userdata.vhdx</code>文件是WSA的虚拟硬盘，安装的APP都在这个文件里。</p><p>用fastcopy复制到其他位置，再把原来位置的VHDX文件删除就可以了。<br>这里举例复制到<code>Z:\WSA_VHDX</code></p><p><img src="https://cdn.jsdelivr.net/gh/Tokisaki-Galaxy/res/post/resolution-wsa-wsl-usage-much-system-space/1.png" alt="用fastcopy复制VHDX文件"></p><p>然后进入有管理员权限的cmd，创建链接。<br><strong>注意一定是cmd，powershell没有mklink指令</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">mklink userdata.vhdx Z:\WSA_VHDX\userdata.vhdx<br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/Tokisaki-Galaxy/res/post/resolution-wsa-wsl-usage-much-system-space/2.png" alt="用mklink创建软链接"></p><h2 id="WSL迁移方法"><a href="#WSL迁移方法" class="headerlink" title="WSL迁移方法"></a>WSL迁移方法</h2><p>基本上和WSA迁移方法一致，不同在于VHDX路径不同。<br>不同Linux发行版的VHDX存储路径不同，用Ubuntu20.04LTS举例，它的VHDX存储在<code>%LocalAppData%\Packages\CanonicalGroupLimited.Ubuntu20.04onWindows_79rhkp1fndgsc\LocalState</code>下的<code>ext4.vhdx</code>里面，迁移其他到位置就好了。</p><h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><p>迁移前需要关闭对于软件，不然会提示文件打开，不能删除</p><h3 id="WSA关闭方法"><a href="#WSA关闭方法" class="headerlink" title="WSA关闭方法"></a>WSA关闭方法</h3><p>安装完WSA，会有一个绿色图标的应用，叫<code>Windows Subsystem for Android</code>，里面有个开关是关闭WSA。</p><h3 id="WSL关闭方法"><a href="#WSL关闭方法" class="headerlink" title="WSL关闭方法"></a>WSL关闭方法</h3><p>进入powershell或者cmd，输入<code>wsl --shutdown</code></p>]]></content>
      
      
      <categories>
          
          <category> 软件安装与配置 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> Windows </tag>
            
            <tag> WSL </tag>
            
            <tag> WSA </tag>
            
            <tag> Win11 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>msf http使用cloudflare argo上线</title>
      <link href="/blog/meterpreter-via-cloudflare-argo/"/>
      <url>/blog/meterpreter-via-cloudflare-argo/</url>
      
        <content type="html"><![CDATA[<p>为了直观展示，本文使用<a href="https://github.com/FunnyWolf/Viper/">VIPER图形化界面</a>。</p><h2 id="配置Argo隧道方法"><a href="#配置Argo隧道方法" class="headerlink" title="配置Argo隧道方法"></a>配置Argo隧道方法</h2><p><strong>下面教程是建立在您已经有一条隧道，有一个配置文件的基础上的，如果您还没有，请参阅<a href="https://tokisaki.top/blog/viper-via-cloudflare-argo/">使用Cloudflare Argo隐藏VIPER后台</a>。</strong></p><p>在config.yml后面添上<br>如果已经有了那路径是<code>/etc/cloudflared/config.yml</code>。</p><p>新加如下几行</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-comment">#tp</span><br><span class="hljs-attr">tunnel:</span> <span class="hljs-string">xxxxxxxxx</span><br><span class="hljs-attr">credentials-file:</span> <span class="hljs-string">/root/.cloudflared/xxxxxxxxx.json</span><br><br><span class="hljs-attr">ingress:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">hostname:</span> <span class="hljs-string">vip.example.top</span><br>    <span class="hljs-attr">service:</span> <span class="hljs-string">http://127.0.0.1:60000</span><br>    <span class="hljs-comment">#这里开始</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">hostname:</span> <span class="hljs-string">tp.example.top</span><br>    <span class="hljs-attr">service:</span> <span class="hljs-string">http://127.0.0.1:2095</span> <span class="hljs-comment">#这里端口要和下面msf监听设置成一样的，只要没被占用就行</span><br>    <span class="hljs-comment">#这里结束</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">service:</span> <span class="hljs-string">http_status:404</span><br></code></pre></td></tr></table></figure><p>最后重启服务，应用配置文件。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> systemctl restart cloudflared<br></code></pre></td></tr></table></figure><p>在<a href="https://dash.cloudflare.com/">cloudflare dashboard</a>的dns面板里面，将tp.example.top的记录设置为与vip.example.top的记录一样<br><img src="https://cdn.jsdelivr.net/gh/Tokisaki-Galaxy/res/post/meterpreter-via-cloudflare-argo/1.png" alt="就像这样"></p><p>然后通过浏览器访问 <code>http://tp.example.top:2095</code> ，应该会有这样的提示。<br><img src="https://cdn.jsdelivr.net/gh/Tokisaki-Galaxy/res/post/meterpreter-via-cloudflare-argo/2.png" alt="提示404 Not found"></p><h2 id="通过http上线"><a href="#通过http上线" class="headerlink" title="通过http上线"></a>通过http上线</h2><p>因为cloudflare在国内访问不太行，最好用stageless。</p><p>载荷选择<code>windows/meterpreter_reverse_http</code>。</p><p>设置LHOST为<code>tp.example.top</code><br>端口和argo隧道里设的一样就行。</p><p><del>设置<code>LHOST</code>为<code>104.19.0.100</code>，这是Cloudflare的一个香港节点，大陆访问速度相当快，如果你有更快的就直接替代好啦。<br>下拉找到<code>HttpHostHeader</code>，里面填<code>tp.example.top</code>这样既可以用较快的节点访问C2服务器，又不至于太暴露C2域名。</del></p><p>如果用HostHeader伪装C2域名，理论上来讲没问题，但是实操会导致上线但无法操作，可能跟缓存有关，下周回来试试。</p><p><img src="https://cdn.jsdelivr.net/gh/Tokisaki-Galaxy/res/post/meterpreter-via-cloudflare-argo/3.png" alt="设置完之后大概这样"></p><p>生成PE&#x2F;ELF文件，然后执行。就会产生一个Session。</p><p><img src="https://cdn.jsdelivr.net/gh/Tokisaki-Galaxy/res/post/meterpreter-via-cloudflare-argo/4.png" alt="最终成果"></p>]]></content>
      
      
      <categories>
          
          <category> 踩坑记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> cloudflare </tag>
            
            <tag> Argo </tag>
            
            <tag> metasploit </tag>
            
            <tag> 网络安全 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用Cloudflare Argo隐藏VIPER后台</title>
      <link href="/blog/viper-via-cloudflare-argo/"/>
      <url>/blog/viper-via-cloudflare-argo/</url>
      
        <content type="html"><![CDATA[<blockquote><p>What is a Cloudflare Argo Tunnel<br>Argo隧道提供了一种简便的方法，可将Web服务器安全地公开到Internet，而无需打开防火墙端口和配置ACL。 Argo隧道还可以确保请求在到达网络服务器之前先通过Cloudflare进行路由，因此可以确保通过Cloudflare的WAF和Unmetered DDoS缓解功能停止了攻击流量，并且如果为帐户启用了这些功能，则可以通过Access进行身份验证。</p></blockquote><p>为什么走Argo而不是普通CDN？<br>因为走CDN要用安全组放通60000端口，并且泄露了C&amp;C服务器的IP地址，增加了被溯源隐患。使用ArgoTunnel不需要放通后台端口。而且有Cloudflare官方证书。</p><p>并且现在Cloudflare默认走香港节点，大陆访问也不慢。</p><p>为啥我要这么搞呢，其实一开始我只是想隐藏后台，所以使用宿主机装nginx反代，但是太难弄了。最后突然想起来Argo可以不开放端口，绑定域名外加隐藏地址，所以就赶紧上了Argo。</p><h2 id="配置VIPER"><a href="#配置VIPER" class="headerlink" title="配置VIPER"></a>配置VIPER</h2><p>因为viper使用的是自签名证书，如果直接转发<code>https://127.0.0.1:60000</code>是不行的，会报证书错误。所以要先进容器内改nginx的配置文件，关掉ssl，改成http。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker ps <span class="hljs-comment">#查看容器名</span><br>docker <span class="hljs-built_in">exec</span> -i -t viper-c /bin/bash<br><span class="hljs-comment">#下面是在容器内的操作</span><br><span class="hljs-built_in">cd</span> /root/viper/Docker/<br>nano viper.conf<br></code></pre></td></tr></table></figure><p>用Ctrl+Shift+_跳转到第7行。</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-string">.......</span><br><span class="hljs-string">server</span> &#123;<br>        <span class="hljs-string">include</span> <span class="hljs-string">/root/viper/Docker/nginxconfig/viper.conf;</span><br>        <span class="hljs-string">ssl</span> <span class="hljs-string">off;</span>    <span class="hljs-comment">#把这里由on改成off</span><br>        <span class="hljs-string">ssl_certificate</span> <span class="hljs-string">/root/viper/Docker/nginxconfig/server.crt;</span><br><span class="hljs-string">.......</span><br></code></pre></td></tr></table></figure><p>最后记得重载nginx的配置文件，让改动生效。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">nginx -s reload<br><span class="hljs-built_in">exit</span> <span class="hljs-comment">#退出容器内</span><br></code></pre></td></tr></table></figure><h2 id="配置Argo"><a href="#配置Argo" class="headerlink" title="配置Argo"></a>配置Argo</h2><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p>Cloudflared 是源服务器和 Cloudflare Argo Server 的连接软件。</p><p>你可以参考这里的文档。</p><p>官方文档<br><a href="https://developers.cloudflare.com/cloudflare-one/connections/connect-apps/install-and-setup/installation">Docs</a></p><p>Github Release<br><a href="https://github.com/cloudflare/cloudflared/releases">Downloads</a></p><h3 id="配置Tunnel"><a href="#配置Tunnel" class="headerlink" title="配置Tunnel"></a>配置Tunnel</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">cloudflared tunnel login <span class="hljs-comment">#先登录，并且选择example.com的域名</span><br>cloudflared tunnel create viper<br>cloudflared tunnel route dns viper vip <span class="hljs-comment">#通过vip这条隧道，自动在cloudflare中添加一条指向vip.example.com的CNAME记录</span><br></code></pre></td></tr></table></figure><h3 id="确认Tunnel配置"><a href="#确认Tunnel配置" class="headerlink" title="确认Tunnel配置"></a>确认Tunnel配置</h3><p>启动隧道试试，如果没问题就继续。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">cloudflared tunnel --name viper --url http://127.0.0.1:60000<br></code></pre></td></tr></table></figure><p>然后可以访问vip.example.com查看效果，如果没有问题就继续。<br>这样启动隧道只是一个临时的措施，所以我们要持久化。</p><h3 id="持久化Argo"><a href="#持久化Argo" class="headerlink" title="持久化Argo"></a>持久化Argo</h3><p>先运行<code>cloudflared tunnel list</code>记一下Tunnel的ID是多少。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> cloudflared service install<br>nano /etc/cloudflared/config.yml<br></code></pre></td></tr></table></figure><p>按照下面这样写，该改的改一下</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">tunnel:</span> <span class="hljs-string">&lt;Tunnel-UUID&gt;</span><br><span class="hljs-attr">credentials-file:</span> <span class="hljs-string">/root/.cloudflared/&lt;Tunnel-UUID&gt;.json</span><br><br><span class="hljs-attr">ingress:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">hostname:</span> <span class="hljs-string">vip.example.com</span><br>    <span class="hljs-attr">service:</span> <span class="hljs-string">http://127.0.0.1:60000</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">service:</span> <span class="hljs-string">http_status:404</span><br></code></pre></td></tr></table></figure><p>重启cloudfalred服务</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> systemctl restart cloudflared &amp;&amp; <span class="hljs-built_in">sudo</span> systemctl <span class="hljs-built_in">enable</span> cloudflared<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 踩坑记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> cloudflare </tag>
            
            <tag> Argo </tag>
            
            <tag> metasploit </tag>
            
            <tag> 网络安全 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TencentOS安装Docker</title>
      <link href="/blog/tencentos-install-docker/"/>
      <url>/blog/tencentos-install-docker/</url>
      
        <content type="html"><![CDATA[<blockquote><p>TencentOS Server（又名 Tencent Linux，简称 TS 或 tlinux）是腾讯针对云的场景研发的 Linux 操作系统，提供特定的功能及性能优化，为云服务器实例中的应用程序提供高性能及更加安全可靠的运行环境。TencentOS Server 提供免费使用，在 CentOS（及其他发行版）上开发的应用程序可直接在 TencentOS Server 上运行，用户还可持续获得腾讯云团队的更新维护和技术支持。</p><p>…<br>TencentOS Server 环境说明<br>用户态环境<br>TencentOS Server 2用户态软件包保持与最新版 CentOS 7兼容，即 CentOS 7版本的软件包可以直接在 TencentOS Server 2.4 中使用。<br>TencentOS Server 3用户态软件包保持与最新版 RHEL 8兼容，即 RHEL 8版本的软件包可以直接在 TencentOS Server 3.1 中使用。<br>…</p></blockquote><p><a href="https://cloud.tencent.com/document/product/213/38027">全部简介见官方文档</a></p><p>增加适用于云场景的新特性、改进内核性能并修复重大缺陷，针对容器场景进行优化，提供了隔离增强和性能优化特性，所以建议使用TencentOS部署Docter。</p><p>因为买了个服务器，看到有个没用过的TencentOS想试试，结果发现直接用官方的脚本docker死活装不上去，又找不到解决的办法，因此写下这篇文章记录。<br>支持一下TencentOS，但是用户社区太小了，希望更多人用增大社区用户量吧。</p><p>安装所需软件包</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">yum install yum-utils device-mapper-persistent-data lvm2<br></code></pre></td></tr></table></figure><p>添加docker官方的安装源</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">yum-config-manager --add-repo http://download.docker.com/linux/centos/docker-ce.repo<br>yum list docker-ce --showduplicates | sort -r #会报错，不管就行。<br>cd /etc/yum.repos.d/<br>nano docker-ce.repo #修改存储库文件<br></code></pre></td></tr></table></figure><p>将docker-ce.repo改为下面这样，一般只用得上stable，所以就改stable的部分，其他都删了。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs config">[docker-ce-stable]<br>name=Docker CE Stable - $basearch<br>#如果是TencentOS 2就是centos/7，如果是TencentOS 3就是centos/8<br>baseurl=https://download.docker.com/linux/centos/8/x86_64/stable<br>#baseurl=https://download.docker.com/linux/centos/$releasever/$basearch/stable<br>enabled=1<br>gpgcheck=1<br>gpgkey=https://download.docker.com/linux/centos/gpg<br></code></pre></td></tr></table></figure><p>最后安装并启动docker</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">yum install docker-ce docker-ce-cli containerd.io<br>service docker start<br>systemctl enable docker<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 踩坑记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> 云服务器 </tag>
            
            <tag> TencentOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>apt</title>
      <link href="/blog/apt/"/>
      <url>/blog/apt/</url>
      
        <content type="html"><![CDATA[<h2 id="绝对禁止在实战中使用HTTP协议"><a href="#绝对禁止在实战中使用HTTP协议" class="headerlink" title="绝对禁止在实战中使用HTTP协议"></a>绝对禁止在实战中使用HTTP协议</h2><p>用cobaltstrike的HTTP上线，被教育局抓了，刚上线几分钟教育局就打来电话了。还好套了层cloudflare argo</p><h2 id="meterpreter-reverse-tcp和meterpreter-reverse-tcp区别"><a href="#meterpreter-reverse-tcp和meterpreter-reverse-tcp区别" class="headerlink" title="meterpreter&#x2F;reverse_tcp和meterpreter_reverse_tcp区别"></a>meterpreter&#x2F;reverse_tcp和meterpreter_reverse_tcp区别</h2><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs text">payload/windows/x64/meterpreter/reverse_tcp                               normal  No     Windows Meterpreter (Reflective Injection x64), Windows x64 Reverse TCP Stager<br><br>payload/windows/x64/meterpreter_reverse_tcp                               normal  No     Windows Meterpreter Shell, Reverse TCP Inline x64<br></code></pre></td></tr></table></figure><p>这两个的区别在于第一个是stage模式，第二个是stageless</p>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>【CrackMe】之CKme002</title>
      <link href="/blog/crack-me-ckme002/"/>
      <url>/blog/crack-me-ckme002/</url>
      
        <content type="html"><![CDATA[<p>谨以此系列记录自己学破解的进程。</p><p>本文使用的CrackMe链接：<a href="https://www.52pojie.cn/thread-709699-1-1.html">【反汇编练习】160个CrackME索引目录1~160建议收藏备用 - 『脱壳破解区』 - 吾爱破解 - LCG - LSG |安卓破解|病毒分析|www.52pojie.cn</a></p><hr><p>随便找找字符串，然后找到成功意思的字符串，跳转过去。</p><p><img src="https://cdn.jsdelivr.net/gh/Tokisaki-Galaxy/res@master/img/202108231252477.png" alt="找字符串"></p><p>然后抹掉条件跳转指令，完成</p><p><img src="https://cdn.jsdelivr.net/gh/Tokisaki-Galaxy/res@master/img/202108231253037.png" alt="抹掉条件跳转指令"></p>]]></content>
      
      
      <categories>
          
          <category> 踩坑记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> x64dbg </tag>
            
            <tag> 逆向工程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【CrackMe】之CKme</title>
      <link href="/blog/crack-me-ckme/"/>
      <url>/blog/crack-me-ckme/</url>
      
        <content type="html"><![CDATA[<p>谨以此系列记录自己学破解的进程。</p><p>本文使用的CrackMe链接：<a href="https://www.52pojie.cn/thread-709699-1-1.html">【反汇编练习】160个CrackME索引目录1~160建议收藏备用 - 『脱壳破解区』 - 吾爱破解 - LCG - LSG |安卓破解|病毒分析|www.52pojie.cn</a></p><hr><p>字符串搜索，随便搜个成功。</p><p>然后搜索到了”恭喜恭喜！注册成功”，直接跳转过去</p><p>看到右边有虚线，找到虚线起源，jne指令。然后改成NOP，完成。</p><p><img src="https://cdn.jsdelivr.net/gh/Tokisaki-Galaxy/res@master/img/202108231305331.png" alt="5"></p><p>PS.如果没加载出来图，点一下灰色框。</p>]]></content>
      
      
      <categories>
          
          <category> 踩坑记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> x64dbg </tag>
            
            <tag> 逆向工程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【CrackMe】之Acid Burn</title>
      <link href="/blog/crack-me-acid-burn/"/>
      <url>/blog/crack-me-acid-burn/</url>
      
        <content type="html"><![CDATA[<p>谨以此系列记录自己学破解的进程。</p><p>本文使用的CrackMe链接：<a href="https://www.52pojie.cn/thread-709699-1-1.html">【反汇编练习】160个CrackME索引目录1~160建议收藏备用 - 『脱壳破解区』 - 吾爱破解 - LCG - LSG |安卓破解|病毒分析|www.52pojie.cn</a></p><hr><p>第一次玩crackme，先直接启动，熟悉一下各个界面。了解一下序列号出错的提示。</p><p>它有两种验证，一种是序列号+注册名，另一种是仅序列号，大致明白流程之后关闭，然后挂上x64dbg走起。</p><h3 id="序列号"><a href="#序列号" class="headerlink" title="序列号"></a>序列号</h3><p>先从简单的下手，载入程序后搜索所有模块-字符串，搜索出错提示”Try Again!!”，然后跳转过去。</p><p><img src="https://cdn.jsdelivr.net/gh/Tokisaki-Galaxy/res@master/img/202108231107084.png" alt="跳转到Try Again!!"></p><p>首先必须知道点汇编指令的含义，比如jmp是无条件跳转，jne是条件跳转之类的。</p><p>（其实也不用记，x64dbg用虚线箭头标出来的是条件跳转，实线是无条件跳转，</p><p>然后看到跳转过来的”Try Again!!”附近有一个虚线、一个实线箭头。</p><p>理清一下程序流程，首先它先对输入的数据进行判断，然后用jne判断是否符合，如果不符合就输出Fail，try again!!，如果符合就啥也不干。</p><p>所以将jne指令用nop填充，第一个问题解决。</p><p><img src="https://cdn.jsdelivr.net/gh/Tokisaki-Galaxy/res@master/img/202108231113665.png" alt="将jne替换为nop"></p><h3 id="序列号-注册名"><a href="#序列号-注册名" class="headerlink" title="序列号+注册名"></a>序列号+注册名</h3><p>先用搜索字符串找到提示”Sorryxxxxxx”，会出现两个结果，因为它要对序列号和注册名判断两次，所以有两次提示。</p><p>先从第一处开始，jge也是条件跳转指令中一个，只要将jge改为jmp，这里就破解完成了。</p><p><img src="https://cdn.jsdelivr.net/gh/Tokisaki-Galaxy/res@master/img/202108231117268.png" alt="修改jge指令"></p><p>然后找到第二处，</p><p><img src="https://cdn.jsdelivr.net/gh/Tokisaki-Galaxy/res@master/img/202108231120301.png" alt="第二处"></p><p>大致梳理一下流程，基本和之前一样，把条件跳转jne改为nop就行了</p><h3 id="结尾"><a href="#结尾" class="headerlink" title="结尾"></a>结尾</h3><p>至此无论你输什么，都会显示祝贺成功。</p><p>最后可以输出修补程序，就是破解完的程序</p>]]></content>
      
      
      <categories>
          
          <category> 踩坑记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> x64dbg </tag>
            
            <tag> 逆向工程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>dnspod public dns 初体验</title>
      <link href="/blog/tencent-public-dns/"/>
      <url>/blog/tencent-public-dns/</url>
      
        <content type="html"><![CDATA[<p>最近腾讯DnsPod新出了一个产品——个性化dns，可以自定义拦截列表，用于拦截广告，追踪器。国内以前也要类似的产品，比如红🐟之类的。</p><p>我只以前用树莓派搭过adguard home，用于在家里拦截广告，追踪器。这样做的好处是只需要在网关上设置，不需要在家里每个设备上单独设置了。但用树莓派的不足之处在于出门不能使用（废话），解析时间略长（50-60ms，约长一倍）。</p><p>现在新推出的dnspod处于公测期间，可以免费无限量使用，正好拿来试试水。</p><p>从dnspod中进入公共解析，完成创建后可以看到下面这个界面。</p><p><img src="https://ftp.bmp.ovh/imgs/2021/08/a6d39e3f44ac5ccf.png" alt="publicdns"></p><p>然后只需要把dns服务器地址设为路由器dhcp服务器里面就行了</p><p><img src="https://ftp.bmp.ovh/imgs/2021/08/6bd7b21343604d1a.png" alt="tplink设置dhcp服务器"></p><p>TP-LINK打钱<br>由于dnspod的IPv4地址不能为所有客户1对1的给一个地址，必须将你的地址绑定到你的账户上</p><p><img src="https://ftp.bmp.ovh/imgs/2021/08/09de7d3cf32cfec5.png" alt="publicdns绑定"></p><p>家里用的宽带一般是动态IP，每天都会变，而我们又不可能每天都登录dnspod来手动绑定，所以推出了一项功能叫自动绑定接口。</p><p>只要变化的IP后访问了这个接口（GET请求），就会自动绑定。那么我们只需要把这个地址设为我们浏览器的启动页就好了。</p><p>（这真的是最合理的办法了啊）</p><p>第二种方法，写一个python脚本访问，不过你要加启动项或者每天自己点</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br>requests.get(<span class="hljs-string">&quot;xxxxxxxxxx&quot;</span>) <span class="hljs-comment">#这是你的自动绑定接口</span><br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> blog </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DNSPod </tag>
            
            <tag> DNS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Win/Lin HackRF升级固件 (2021.03.1)</title>
      <link href="/blog/hackrf-upgrade-firmware/"/>
      <url>/blog/hackrf-upgrade-firmware/</url>
      
        <content type="html"><![CDATA[<h2 id="更新固件"><a href="#更新固件" class="headerlink" title="更新固件"></a>更新固件</h2><h3 id="安装工具"><a href="#安装工具" class="headerlink" title="安装工具"></a>安装工具</h3><h4 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h4><p>先安装<a href="http://www.gcndevelopment.com/gnuradio/index.htm">GNURadio Windows</a>，添加安装目录&#x2F;bin到path里面</p><h4 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h4><p><code>apt install hackrf</code></p><h3 id="检测是否连上"><a href="#检测是否连上" class="headerlink" title="检测是否连上"></a>检测是否连上</h3><p><code>hackrf_info</code>，如果出现了信息，就是连上了，同时可以看到现在的版本号。截止目前最新的Release是<code>hackrf-2021.03.1</code>。</p><h3 id="下载Release"><a href="#下载Release" class="headerlink" title="下载Release"></a>下载Release</h3><p><a href="https://github.com/mossmann/hackrf/releases">https://github.com/mossmann/hackrf/releases</a></p><h3 id="更新"><a href="#更新" class="headerlink" title="更新"></a>更新</h3><p>解压后，进入firmware-bin目录下。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#更新flash</span><br>hackrf_spiflash -Rw hackrf_one_usb.bin<br></code></pre></td></tr></table></figure><p><em>如果你的hackrf_spiflash里没有-R选项，那就去掉它，它的作用只是写入新的固件后重启而已</em></p><p>网上的很多更新固件的文章都是2017、2018年版的，需要刷flash盒cpld包。但是最新版不需要cpld包了，所以只需要刷进去一个文件就行了。</p><blockquote><p>CPLD bitstreams are now included in and loaded automatically by the firmware. There is no longer a need to update the CPLD separately.<br>—Github Release(2021.03.1)发行说明</p></blockquote><p>然后再执行<code>hackrf_info</code>，可以看到已经更新到2021.03.1了。</p><h2 id="更新软件"><a href="#更新软件" class="headerlink" title="更新软件"></a>更新软件</h2><p>先安装编译需要的软件<code>sudo apt-get install build-essential cmake libusb-1.0-0-dev pkg-config libfftw3-dev</code>。<br>然后进入host目录中</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">mkdir</span> build&amp;<span class="hljs-built_in">cd</span> build<br>cmake ../ -DINSTALL_UDEV_RULES=ON<br>make<br><span class="hljs-built_in">sudo</span> make install<br><span class="hljs-built_in">sudo</span> ldconfig<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 软件安装与配置 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> Windows </tag>
            
            <tag> hackrf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ParrotSec提示NO PUBLIC KEY</title>
      <link href="/blog/parrot-prompt-no-public-key/"/>
      <url>/blog/parrot-prompt-no-public-key/</url>
      
        <content type="html"><![CDATA[<p>本有了wsl2，指望彻底把vmware扔到垃圾桶里，结果今天发现wsl2居然不支持usb设备。。。<br>只好又赶紧翻出来vmware装上linux。</p><p>结果apt install的时候又提示NO PUBLIC KEY。。。</p><h2 id="确定要添加的PUBLIC-KEY的摘要"><a href="#确定要添加的PUBLIC-KEY的摘要" class="headerlink" title="确定要添加的PUBLIC KEY的摘要"></a>确定要添加的PUBLIC KEY的摘要</h2><p>为啥只有一张图呢？<br>因为懒，所以我就只传一张图了，包含所有步骤了（狗头</p><p><img src="https://i.loli.net/2021/07/23/6E5zoT9RgrLPywf.png" alt="1.png"></p><p><code>apt update</code>之后，会提示<code>the public key is not available: NO_PUBKEY XXXXXXXXX</code><br>记下来这个XXXXXXX</p><h2 id="添加PUBLIC-KEY"><a href="#添加PUBLIC-KEY" class="headerlink" title="添加PUBLIC KEY"></a>添加PUBLIC KEY</h2><p><code>sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys XXXXXXX</code></p><p>emmm其实一开始我碰到这个奇葩的问题是一脸懵逼的，去百度查一下，说用ha.pool.sks-keyserver.net这个地址，结果发现访问不了。（百度垃圾）</p><p>最后实在没办法了（找不到了），死马当活马医，给parrotsec用ubuntu的keyserver，发现居然可以，大喜。<br>可能是因为他们俩都是同父异母的兄弟吧（debian）。</p>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> Parrot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HackRF发送信号</title>
      <link href="/blog/hackrf-send-signal/"/>
      <url>/blog/hackrf-send-signal/</url>
      
        <content type="html"><![CDATA[<p>近期由于河南强降水，多地区失去通信，水电。许多人受灾情况没法及时传递。<br>看到家里吃灰已久的HackRF One，终于决定做个紧急求救电台。<br>（其实很早以前就有这个想法，不过当时是玩游戏玩high了，为核战准备的）</p><p>美中不足的是这玩意是半双工的，不能一边发送一边接收信号。</p><h2 id="ParrotSec-GNURadio-PLAN-A"><a href="#ParrotSec-GNURadio-PLAN-A" class="headerlink" title="ParrotSec + GNURadio (PLAN A)"></a>ParrotSec + GNURadio (PLAN A)</h2><p>强烈推荐ParrotSec，比kali不知道好看几倍，比ubuntu多很多工具。<br>wsl爬，原本以为有了wsl能把vmware扔垃圾桶里，结果发现wsl不支持usb。只好找回vmware。</p><p>在某个版本之后，parrotsec不默认包含gnuradio了，需要自己手动<code>apt install gnuradio</code>。</p><h2 id="Windows-GNURadio-PLAN-B"><a href="#Windows-GNURadio-PLAN-B" class="headerlink" title="Windows + GNURadio (PLAN B)"></a>Windows + GNURadio (PLAN B)</h2><p>本来我在parrotsec下已经弄好了，但是突然想起来gnuradio有windows版本的，加上我其实并不喜欢用vmware（感觉体积太庞大了）。<br>就试试几年前曾经抛弃的 gnuradio windows。抛弃原因是当时安装好了打不开。<br>下回来之后发现历经数次版本迭代，windows版本的gnuradio已经和linux版不分上下了，于是乎再次把vmware扔到垃圾桶里。<br><a href="http://www.gcndevelopment.com/gnuradio/index.htm">GNURadio Win64 Binaries</a><br>（下载是真的慢，idm都救不回来那种<br>安装完之后记得把安装目录\bin目录加到path里面，里面有hackrf工具，不用另外找了，很方便。</p><h2 id><a href="#" class="headerlink" title></a></h2>]]></content>
      
      
      <categories>
          
          <category> 软件安装与配置 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> Windows </tag>
            
            <tag> hackrf </tag>
            
            <tag> GNURadio </tag>
            
            <tag> WSL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>自建游戏加速器</title>
      <link href="/blog/create-game-accelerator/"/>
      <url>/blog/create-game-accelerator/</url>
      
        <content type="html"><![CDATA[<h2 id="服务端"><a href="#服务端" class="headerlink" title="服务端"></a>服务端</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">wget https://github.tokisaki.top/github.com/jedisct1/libsodium/releases/download/1.0.18-RELEASE/libsodium-1.0.18.tar.gz<br>wget --no-check-certificate -O shadowsocks-all.sh https://raw.githubusercontent.com/teddysun/shadowsocks_install/master/shadowsocks-all.sh<br><span class="hljs-built_in">chmod</span> +x shadowsocks-all.sh<br><span class="hljs-built_in">sudo</span> ./shadowsocks-all.sh 2&gt;&amp;1 | <span class="hljs-built_in">tee</span> shadowsocks-all.log<br></code></pre></td></tr></table></figure><p>然后输入配置信息，加密方法建议选择第三种（反正游戏加速器也不需要强加密<br>等运行完成之后复制SSR链接进入下一步</p><h2 id="客户端"><a href="#客户端" class="headerlink" title="客户端"></a>客户端</h2><p>下载<a href="https://github.com/netchx/netch/releases">Netch</a>，然后打开（如果闪退的话转.Net框架）。</p><p>第一个选项栏里选择从剪贴板导入，然后就可以导入服务器了，再选择需要的游戏加速规则，最后点加速。</p>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> 游戏 </tag>
            
            <tag> 云服务器 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>海龟汤</title>
      <link href="/blog/ltp/"/>
      <url>/blog/ltp/</url>
      
        <content type="html"><![CDATA[<p>FROM ZHIHU:<br>soup base-horror-1 牛吃草</p><p>夫妻俩屋内吵架，妻子气急而开始摔东西，丈夫一时气恨交加，用刀割掉了她的舌头，在妻子逃跑的同时丈夫用利斧砍断了她的四肢。丈夫行凶后被自己不正常的暴行和血腥场面所惊愕在原地。而逃出房门的妻子因失去了双臂双腿，趴在草地上用牙齿咬着草一点一点挪到邻居家门口，撞门之后得不到求救，最终因失血过多而死。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-12<br>soup base-horror-2 情人</p><p>情人是个男人，因为老男人拒绝离婚的理由是他生不出孩子，情人绝望之下，去老男人家里把老男人的儿子杀死塞进肚子中，用这种方式证明自己怀了老男人的儿子。墙上的话是“我怀了你的孩子”。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-12<br>soup base-horror-3 眼睛</p><p>该车站是某个杀人团伙转移重要尸体的窝点，这天在转移时由于疏忽大意让男子无意间进来，他们拆除了厕所的地下管道，改造成了藏尸间，出口就是男子坑位正前方的地板砖，男子蹲坑时他们正好把尸体从里面顶出出口，男子听到的声响是瓷砖被碰开的声音，然后从门缝底下看到尸体从眼睛处慢慢上升。罪犯顶出来尸体后发现了男子，于是杀人灭口。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-12<br>soup base-horror-4 犬</p><p>小女孩是个盲人，晚上有小偷潜入家里，把狗杀死吊在天花板上，滴水声是狗在滴血，舔她手的也不是她的狗，而是那个人。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-12<br>soup base-horror-5 厕所</p><p>凶手在刚刚杀完人的时候听到了厕所外面的动静，知道有人来上厕所，凶手为了不让尸体暴露，所以假装是清洁工在上夜班，然后把死者当成了拖把，背过身拖地，当时厕所灯光十分的昏暗，所以急忙去上厕所的主人公并没有发和现什么异常，只看到一个清洁工在拖地而已，于是上完就走了。其实是凶手把死者倒立，背对男主用死者的头发在拖地。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-12<br>soup base-horror-6 敲门声</p><p>丈夫下车不久就被杀人犯杀害了，杀人犯出于极致的恶趣味，把尸体吊在车上方的树上，每两声的敲车门声是风吹丈夫尸体摇摆的脚碰到车门发出的声音。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-12<br>soup base-horror-7 咚咚咚</p><p>一个小偷潜进了一个杀人犯的屋子，杀人犯当时拖着一具尸体往楼梯上走，咚咚的声音是尸体头被倒拖着撞到每层楼梯的声音，进门时杀人犯倒提着尸体进来，躲在床底的小偷的目光与尸体倒立的头的目光相遇，于是魂飞魄散。</p><p>注：改编自同名网传灵异汤。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-28<br>soup base-horror-8 别回头</p><p>有天女主在街上，刚好头顶高楼天台上有人争执，一人被失手推下楼顶，坠楼者被高空电线和铁丝网分割成碎状，鲜血和内脏溅落街道，女主身后的朋友看到急忙惊慌失措的喊她，女主听到呼喊转身后被散落的肢体内脏和血淋了一身，以及掉在脚前还睁着眼死不瞑目的半个脑袋。</p><p>注：原创为活跃于众多海龟汤线上群的木鱼同学，群内的重口女王（笑）。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-28<br>souo base-horror-9 爱</p><p>男孩已经死了，抓着的是一只断手，尸体是妈妈的。男孩和男孩母亲长期遭受父亲的家暴，男孩从小体弱多病，再加上家暴的影响，有很深的心理阴影，每晚必须抓着妈妈的手才能入睡。有一天母亲终于忍无可忍，在家里的茶壶里下了安眠药，男孩和父亲在睡前都喝了茶壶里的水。当晚，男孩依旧抓着妈妈的手入睡了。体弱的男孩首先因为过量安眠药致死，母亲半夜准备起来杀掉父亲时，发现男孩已经尸僵，手也挣脱不开，母亲悲痛欲绝之下先砍断自己被男孩握住的手，回头拼命的向孩子父亲砍去。房间满是血迹，男孩父亲被绝望的母亲分尸成碎块散落一地，断手的母亲倚靠在床脚，目光温柔的看着男孩，等待着男孩永远不会再睁开的眼睛睁开，最终因失血过多而死。</p><p>注：此汤是改编里较满意的本子之一。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-28<br>soup base-horror-10 双胞胎<br>我有人格分裂，一个内向的姐姐人格和活泼开朗的妹妹人格，和他约会的时候时而是姐姐时而是妹妹，为了隐瞒所以我说我们是双胞胎，但他喜欢的是妹妹。结婚的时候母亲说，这是我唯一的女儿，你要照顾好她，新郎便得知了真相而疯。</p><p>注：收录自抖音是不是团队。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-28<br>soup base-horror-11 找到你了</p><p>两家人去山林聚餐，小男孩和小女孩跑到深处玩捉迷藏，他们做的约定是谁被找到就偷偷拍身后，那个人就不许动，小女孩躲在从山坡中间斜过来的一颗矮树下，男孩在山坡上发现了女孩，偷偷从他这边的树枝爬到树顶，准备跳到女孩身后吓她一跳，爬上去因为失足摔下来，脖子被卡在树枝中间，窒息死亡后慢慢尸僵，软下来的脚尖刚好搭到女孩背上，女孩一直蹲着捂住耳朵，也没注意到头顶轻微的挣扎声响，背被搭上以为被找到了，于是动也不动。</p><p>注：山法官原创，灵感取自sp-h-6敲门声。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-28<br>soup base-horror-12 三胞胎</p><p>三胞胎长相一摸一样，感情也很好，三兄弟一直同床共眠，老大的死刺激了患有精神疾病的老三，在几晚上都睡不着之后，无法忍耐的老三把老二从中间劈成了两半，把尸体左边一半放在床的右边，把右边放床的左边，老三躺在中间入睡，左右看都是他的哥哥完整的侧脸。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-28<br>soup base-horror-13 爱（二）</p><p>我是一个洋娃娃，是用旁边男尸的女儿的皮做成的。有一家三口人，父亲和女儿都有遗传的精神病，女儿因为年龄太小忍受不了折磨每天痛苦不堪，父亲一直深爱着女儿，无法忍受女儿每天如此痛苦便杀了女儿，用女儿的皮做成洋娃娃陪着自己，母亲得知后因为极端的恐惧杀掉了女儿父亲，说：“你们可以永远在一起了。”</p><p>注：重编自网传汤《洋娃娃》。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-28<br>soup base-horror-14 外婆</p><p>外公因为农村里的重男轻女观念一直不待见孙女，等孙女来到家后晚上拿着镰刀准备杀掉孙女，但外婆发现了急忙上去阻拦，外婆夺过镰刀失手之下杀死了外公，女孩被声音惊醒问进屋来的外婆是什么声音，外婆说是在收麦子，事后外婆把外公制成了一个稻草人放在田地里。隔了几天女孩给外婆在地里帮忙干活时，看到鸟在啄稻草人的脸，稻草人脸上的伪装被鸟啄开，露出了外公尸体的眼珠，女孩问外婆的话是“为什么那个稻草人的眼珠看起来好像外公的眼睛啊。”外婆被孙女的话刺激到了，因为巨大的恐惧与愧疚，便在深夜自杀。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-28<br>soup base-horror-15 床边有人</p><p>我是一个女孩，妈妈被我杀了。女孩从小患有严重的精神错乱和自闭症，小时候因为精神错乱误杀了她的哥哥，母亲怕她的自闭症加深，便把这事含糊过去，但是女孩一直有深深的怀疑，以为是妈妈杀的哥哥。女孩的精神错乱一般都是深夜自闭症加深引发出来的，所以母亲每天半夜都偷偷过来盯着女孩是否安然入睡。这天终于被半夜醒来的女孩发现，女孩以为母亲来杀她了，惊恐不安下精神错乱又开始了。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-28<br>soup base-horror-16 红</p><p>她的床对面墙上挂着一副海报，海报里有个红色眼睛正对着她，但眼睛的墙壁位置其实是被掏空的，她墙对面住着一个红眼病人，盯着她的眼睛是这个红眼病人的。她每次发呆愣神都会一直盯着海报里的眼睛，也同时被这双眼睛死死盯着，晚上也受此影响一直做红色眼睛的噩梦，所以感觉快被逼疯了。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-28<br>soup base-horror-17 女明星</p><p>电视里正在播报新闻，报道说有一个狂热粉丝为了追星，把自己的皮剥下来做成人皮沙发送给了她，而这个明星就是她，女明星低下头看着自己正在坐的柔软的人皮沙发，在惊恐的尖叫中突发心脏病而死。</p><p>注：来自一位海外老哥的友情供稿。</p><p>soup base-weird-1 生日</p><p>这个人天生就是盲人，有次他们出去探险，被困在一个没有任何食物的荒岛上，朋友们骗他说每个人都砍下来自己的一只手臂当食物，他便主动奉上，在生日这天，无数掌声在他耳边响起来时，他忽然明白，自己被骗了。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-12<br>soup base-weird-2 邻居</p><p>邻居听到女主家有异响，打电话向女主说可能进小偷了，女主回到家寻找完发现并没有丢什么，便放心睡觉了，其实小偷是偷了女主家的备用钥匙，半夜进门后，来到女子床边在她耳朵边轻轻告诉她：“你丢的其实是这把钥匙。”女子因惊恐心脏病发作而死。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-12<br>soup base-weird-3 水草</p><p>一对情侣在河边玩的时候，不小心双双落水，但两人都不会游泳，男主在水中挣扎的时候脚被水草缠住，男主死命挣脱开才得以活命，女主却再也没有上来。后来和渔夫聊天，被告之河里从来没有水草，男主才醒悟缠住他的不是水草，是女主的头发，女主是被他用脚蹬下去所以死在河中的。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-12<br>soup base-weird-4 女明星</p><p>女明星毁过容，养女儿是为了移植女儿的脸皮到她自己的脸上，那顶帽子是她自己的，时不时给女儿戴上是为了测量女儿头部大小，一旦刚好合适，就可以带去医院做脸部移植手术，手术后女儿悲愤自杀。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-12<br>soup base-weird-5 新娘</p><p>故事发生在唐朝，新郎和新娘青梅竹马，定下婚约后新郎去京城求取功名，如愿以偿中了状元当了官之后兴高采烈的回来，才知道新娘因为家里闯进一群歹徒被轮番玷污了身子，新娘不堪受辱便上吊自杀了，新郎大喜后又大悲。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-12<br>soup base-weird-6 雪山</p><p>两人是一人身中7枪，另外一人自杀而死。自杀的人有梦游症，第一天晚上梦游中把同伴杀死，醒来后发现自己杀人很害怕，就挖了个坑把同伴埋了。第二天晚上梦游的时候，他又把坑里的同伴挖出来，在尸体上打一枪，又去睡了。这样重复了整整7天，在第八天的时候他终于受不了这种恐怖，没有等到救援队就自杀了。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-12<br>soup base-weird-7 崇拜</p><p>小孩的爸爸是一个魔术师，经常表演用刀切开人体后又如没事般地接回，因而小孩以为魔术是真的，有一天便趁爸爸的同事睡着尝试这项魔术，小孩把这个人真的切块了，等到爸爸回来时，小明对爸爸说了一句“怎么把他变回来啊”，爸爸便在绝望和愧疚中自杀了。</p><p>注：改编自网传汤-魔术。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-12<br>soup base-weird-8 字条</p><p>女儿有精神病，是她杀了妈妈，字条是妈妈写的。但是被撕碎打乱了顺序，正确的排列应该是，爸爸快走，女儿疯了。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-12<br>soup base-weird-9 勺</p><p>这是一家人，经常有国外亲戚寄过来特产，有天外祖母在国外过世，国外亲戚便寄过来装在罐子里的骨灰，因为和一起保健品放在箱子里，这家人以为也是罐保健品，便在桌子一勺一勺吃了下去，等最后反应过来他们在吃自己的外祖母，所有人惊恐不已，开始呕吐。</p><p>注：来源于BlackStory黑故事微信公众号，另，骨灰属于无机物，严格意义说有害，但是在故事背景中可以说无毒。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-12<br>soup base-weird-10 迷踪</p><p>一家三口人，小孩先残疾，生下来就是一条腿，他的父母为了让他们的小孩不自卑，所以搬到了深山老林里面生活，为了给孩子营造出人生下来就是一条腿的假象，所以夫妻两个各自也把一条腿剁了，在男主来到里借住后，夫妻两个为了不让孩子发现，所以趁着男主睡着的时候把男主人公的一条腿也切掉了。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-12<br>soup base-weird-11 绿牙</p><p>男子是一名殡葬师，有梦游症和异食癖，有一次夜间发作去停尸间拖走并吃了一具尸体，受到上司责骂之后为了搞清楚丢失原因，便用绿色颜料在另一具尸体上做了记号，等第二天发现自己嘴里有绿色颜料，才明白是自己吃了两具尸体，便在惊恐中自杀了。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-12<br>soup base-weird-12 太平间</p><p>故事有三个人，另一个人躺在尸体架上，3个人是医学院的，这天男子B生日，男子A和男子C约定要用特别的方式帮他庆祝，于是C就假扮成尸体，A去让B帮忙抬尸体。到太平间的时候，C突然跳起来并且拿出藏好的生日蛋糕大喊SUPRISE，B于是被吓得心脏病发作而死。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-12<br>soup base-weird-13 血</p><p>男子住在一家酒店的最顶层，酒店楼顶的蓄水箱被某个杀人犯扔进尸体，但因为处理不当，在沉尸过程中让大量血液流淌进水箱，混在水中。</p><p>注：改编自洛杉矶塞西尔酒店水箱沉尸案。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-12<br>soup base-weird-14 腐</p><p>我是一名警察，有人报案说楼里好几天一直味道很重，于是来查看情况。其实一个孤寡老人独自在家，养了很多流浪猫，邻居常常头疼于臭味，有天在鱼里下了毒扔到老人门上，想毒死猫，鱼被老人看到后觉得还新鲜就自己吃了，毒发身亡后尸体被猫啃食干净，因为也出不去，所以一只一只死在屋里，慢慢腐烂。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-12<br>soup base-weird-15 重见天日</p><p>某先生的太太死后下葬多年，先生准备开馆举行捡骨仪式，但是开馆后发现棺盖上全是太太手指甲的抓痕，说明太太在下葬后还活着，在棺材里活活窒息死的，先生想到这里，便在绝望和愧疚中自杀了。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-12<br>soup base-weird-16 邻居（二）</p><p>我是一个女人，邻居有通感症，具体是对于声音和画面的通感，觉得我的声音像柠檬，因此他看我就像看到了柠檬一样。</p><p>注：本汤源自豆瓣组。</p><p>另，通感症属于神经系统病症，受外界刺激后，正常人一般只有一个感应器官做出应答，而通感症患者有两个或两个以上。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-12<br>soup base-weird-17 惩罚</p><p>她是我的妻子，惩罚就是吃人肉。我是个变态杀人狂，喜欢用尸体的腐肉做饭菜，这就是我内心的终极秘密，而妻子一无所知。这天她一边吃一边说看透了我的秘密，所以撒谎的惩罚就是继续吃着满桌的人肉饭菜。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-12<br>soup base-weird-18 病</p><p>家里老爷子重男轻女，从某处得知了偏方，是用同血缘的人的心脏做药引。于是杀了妹妹取了心脏，做好药汤让哥哥喝。哥哥不见妹妹逼问下老爷子说了实情，绝望痛苦中选择自杀。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-13<br>soup base-weird-19 人影</p><p>我是一个通缉杀人犯，低价购买了这个凶宅用地下室藏尸，我杀人之前先要烫烂他们的眼睛和舌头，这天有一个没被我杀死的人跑了出来，但庆幸的是，他们跑不远。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-29<br>soup base-weird-20 浪子回头</p><p>我恨死了这个男人。<br>每天在外面掂花惹草。<br>在一天家里他沉迷于球赛在怎么叫喊都不搭理我后，怒火让我失去理智，砍下了他的头，转过来放在脖子上面对着我。<br>我痴迷的看着他如往日般爱我的温顺。<br>欣喜万分。</p><p>注：改编汤，故事原型取自鬼故事集。</p><p>soup base-ratiocinate-1 线索</p><p>凶手是妻子，因为男子长期吸毒，妻子实在忍受不了想离婚，所以趁男子吸完毒神志不清的时候给他又打了一针，使他晕过去，接着用男子的拇指粘了红色墨水盖章在离婚协议书上面。但是因为剂量过大，男子直接死亡，女子发觉后，不得已营造出一个自杀的场景。但是法医在脚上面找到了男子并不是自杀的线索，因为如果是上吊自杀，脚是没有受到力自然下垂的，尸僵后脚尖是向下的，但是如果是被他杀，尸僵的时候脚部也是正常的。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-13<br>soup base-ratiocinate-2 富豪</p><p>富豪年事已高，但妻子还风华正茂，和富豪的私人医生出轨了，他们计划了富豪的死亡为夺取财产。富豪很久就得了心脑血管病，长期服用阿司匹林，但由于阿司匹林会慢慢阻碍身体里维c的运输，所以开始缺c。富豪便让私人医生开维生素c的药，但医生这时已经妻子已经串通好了，所以向富豪开的维c药全部换成了安眠药，富豪因为年老体衰，加上服用药物不当让身体进一步恶化，最终因大量食用安眠药而死。</p><p>注：原创主.霹雳火，一篇珍贵的推理作品，使用时请务必尊重作者版权。</p><p>且，心脑血管病属于神经内科，但是具体部位分布非常广泛，有血管、大脑神经、心肺等，而且症状也遍及全身。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-14<br>soup base-ratiocinate-3 南瓜灯</p><p>我挂的是人头，一个属于我妻子，一个是我的心理医生。现场有四个南瓜灯，两个真的南瓜灯以尸体为灯具。<br>我亲爱的妻子为了踢走我，拥抱她的真爱，也就是我的心理医生，他们合计以认知性障碍综合征把我送进精神病医院，但万圣节当天，由于我各种题测显示正常，我便被特许回家过节，于是回到家的我完美的撞见了这两个混账的爱情现场。我提起斧头，砍下了他们的头，把他们的头颅刻成了南瓜灯，挂在了我的门前作为万圣节装饰，又把真正的南瓜头灯放在他们的尸体上。毕竟在所有人眼里，我只是一个可怜的认知性障碍精神病人罢了，把头颅当成南瓜灯，又不是我的错啊。<br>可问题究竟，谁知道我到底有没有病呢，毕竟，那可是我的心理医生亲口说的呀。</p><p>注：原创主.木鱼，极其珍贵的原创作品，使用时请务必尊重作者版权。</p><p>且：把人头做成南瓜头的细节可自行构想在底中。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-14<br>soup base-ratiocinate-4 白</p><p>我带着我的猫散步，走到一片森林里，大雾弥漫，地上到处散落着白色粉末。我觉得这里不太对劲，想离开这里，但我的猫忽然挣脱我跑了出去，我循着它的方向往森林更深处追去，可等我找到它的时候，看到它正被背对着我的一个男人疯狂虐杀。怒火一瞬间点燃了我的理智，我失控般的举起脚边的石头狠狠的砸向那人的后脑，血液四溅，男人应声倒地。我擦了一把脸上的血，沉默地把猫埋在一旁的树根下。</p><p>我走出迷雾弥漫的森林时，发现已经被警察用枪指着我包围了。在随后漫长的等待中，他们的调研结果出来了，告诉我森林里的白色粉末是一种很强烈的致幻药物，所以推出结论是是我在不慎吸入大量致幻药物后产生了强烈的幻觉，随后杀了男人和猫。<br>因此我从监管室转入医护室，开始被观察测试后续药反。</p><p>这样的日子持续了多久呢，我已经开始记不清了。<br>每天醒来时白色占满我的视野。白色的天花板、白色的墙、白色的床单，和在我身边来来往往的白色的制服。我身上仿佛永远满插着连接庞大冰冷的仪器的管子。<br>最开始的迷茫、进行测试实验时的痛苦、以及永远得不到离开承诺的绝望和永无止境的白色困笼，让我身陷疯狂。</p><p>我睁开眼，茫然的看着眼前的房间。<br>没有仪器，没有试管，没有一切，仿佛只是做了一个很长的梦，可梦的样子也记不清了，慢慢回想，只恍惚看到在一片黑暗中疯狂奔跑，没有亮光。<br>“0213号，病症为重度臆想症，现进行本周第四次康复题测，累积第三百八十一次。”<br>“0213号，基本题测完毕，现开始照例提问。你还记得在森林的事吗。”<br>“我，我杀了人…和猫。”<br>“有白色粉末存在吗。”<br>“……什么粉末。”<br>“………”<br>“好，提问完毕，精神恢复程度尚可，预测接近出院时间，0213号，请回去吧。”<br>我缓缓站起身，浑浊的眼睛扫过房间，最后落到墙壁的铁窗上，有微弱的光。</p><p>“还有什么问题吗，0213号。”<br>“不……不。”</p><p>我难以置信的盯着医生的面孔。<br>藏在面罩背后的眼睛闪着奇异的光。<br>“你是说，你们把我摆弄了这么久，我在这张床上度过了这么长时间，最后得出的结论是我其实得了精神病？”<br>“很遗憾，但是根据监测数据来说…”<br>“你们这是谋杀！我有没有病我自己很清楚！”<br>“那白色粉末呢，我们在森林根本没有找到你说的那种白色粉末。”<br>“不可能，我之前有抓回来一些…我手上有的，我记得很清楚！”<br>“那只是您的幻觉，实际上，只是一些碎石罢了。”<br>“你——”<br>“请您先去收拾您留在我们这边的衣物吧，转移您的车马上就要到了。”<br>房间里，我脱下病号服，换上了来这里就匆忙丢进储物柜的衣服，车就到了。</p><p>我看着精神病院的大门，他们把我扔在这里就急匆匆的走了。<br>我习惯性摸向自己的口袋，一种微妙的触感被我察觉。<br>我张开手，看到手指上不均匀地分布着一些淡淡的白色粉末，在阳光下微微发亮。<br>我被骗了。</p><p>我疯了似的高举着手，冲向大门。<br>大门却开始慢慢合拢。<br>“我有证据！我不是精神病啊，你们放我出去！你们听我说——”</p><p>坚硬的大门合上缝隙，夹断了最后一丝光。</p><p>侯校官，你明白了吗。<br>是长官。<br>请记住，你现在所做的事是正确的，一切为了最高利益，这些都是必要的牺牲。<br>是长官。<br>无论如何也要完成任务，不惜一切代价。<br>是长官，不惜一切代价，完成任务！</p><p>为了暗地研究违背国际惯例的药物，候校官被派命保证任务顺利。<br>这种药物研究必须在特殊血型的人身上进行试验，而全国范围内拥有该血型的普通人只检测到我一个，因此我被策划进这场演出。<br>白色粉末是已经研究出的半成品，只在特殊血型的人身上起作用，但是需要接触皮肤，因此他们乘我不在家的时候潜入杀了猫，粉末洒在猫的身上。而回来的我见猫死亡，悲伤中前往附近的森林去埋掉猫的尸体。但药效开始逐渐发作，我进入森林看见的白雾，地面的白粉，逃掉的猫，和正在虐杀猫的人，全部出自药物对我施加的影响。<br>于是我被顺理成章的开始研究和监测。试验结束后，我被丢进精神病院。<br>饱受药物折磨的我，在大门合闭的时候，心也成死寂。<br>我不知道我到底有没有病，他们也不知道，也不必知道。</p><p>我在精神病院中，度日如年的过着每一天。<br>如果麻木也算一种病。<br>我已病入膏肓。</p><p>END</p><p>注：原创主.小垂，极其珍贵的原创汤，使用时请务必尊重作者版权。</p><p>又：我从头到尾没有病，药物的影响后遗症也不致疯，但是经历了实验时的痛苦过程后，又被强行关到精神病院，我被反复折磨到一个半疯麻木的状态。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-29<br>soup base-ratiocinate-5 冲水声</p><p>一家三口是毒贩，男邻居是他们的眼线。他们利用母亲的身体运毒。具体为母亲把带保护的胶囊状毒品吞入腹内，回到家后利用泻药排出，排泄完后取出毒品，用马桶冲走其余的排泄物，然后反复进行直到所有的毒品都排出来。而事发当晚，母亲发现自己怀孕了，于是不想进行催泄，但父亲强逼着让她排毒，儿子听到母亲抗拒的哭喊声后与父亲进行争吵，随即和父亲殴打起来，母亲绝望中在厕所进行催泄，导致流产，且因身体长时间催泻的虚弱，最终失血过多而死。儿子因和母亲的深厚感情，绝望中也跳楼自杀。父亲惊怒之下，先逃到了男邻居那里，让男邻居给警察制造儿子和母亲关系不好的导向，借以拖延警察的查案思路，随后带着所有毒品逃命了。</p><p>注：原创主.润子小姐，一篇可以力顶经典老汤牛吃草的极其珍贵的原创汤，使用时请务必尊重作者版权。</p><p>soup base-tale-1 湖</p><p>我和妻子都热衷潜水，在一次差点把整个家砸烂的感情宣泄后，我决定要永远摆脱她，但我不知道妻子和我下了同样的决定，我邀请妻子去一个人迹罕至的深湖潜水，妻子欣然应允。我们穿齐所有潜水装具，坠离小船，沉入湖面下，湖水幽蓝，湖底漆黑。我准备杀妻子的办法是提前到这片湖底，在湖底一块石头绑了铁链，到时候缠住妻子，让她永远留在湖底，谁也找不到她。当我来到那个地方时候，居然发现我的铁链消失了，而一根铁链无声无息的圈住了我，我愕然回头，对上了妻子潜水镜后冷漠的眼睛。原来妻子准备的手段是暗中跟随提前过来的我，在我离开后下去把铁链藏到别的地方。可妻子这根铁链没有锚，根本留不住我，我想把铁链挣脱开，却忽然呼不上气来，原来妻子趁我寻找铁链的时候在身后关了我的氧气瓶。我绝望的看着妻子向我游来，却惊愕的看见她把铁链也缠在自己身上，我们被铁链拉到一起。<br>妻子忽然无声的笑了下，轻轻抱住了我。<br>我不知道的是，妻子的氧气罐在下来之前就一半不到，她根本没打算再回到上面。<br>人在死亡临近走马灯的时候，会看到记忆深处最深刻的一幕。于是我看到了我们第一次在水底相遇的场景，妻子回到了笑起来像盛开在深水的花一样美丽的年纪，眼里满溢着星光。<br>同样年轻的我咧着笑容向她游去，湖水清澈，湖底荡漾。<br>我忽然回抱住我的妻子。<br>我们在黝黑的湖底紧紧相拥，没有声音，没有冷漠。</p><p>那天晴朗，我对这个女孩说。<br>要永远，永远爱你。</p><p>注：故事原型取自鬼故事集(具体出处不明)。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-12<br>soup base-tale-2 圣诞前夜</p><p>我是个保险推销员，临近年底，我为了冲业绩快逼疯了自己，而小女孩的出现让我有了一个大胆的决定，就是杀掉小女孩然后让她的父母产生恐惧，有利于我上门推销保险。为了造成他杀所以我脱掉了女孩的衣服(他杀属于保险范畴，而自杀不属于)，也同样说明钥匙也落入凶手里。在女孩的父母来不及更换钥匙或者逃离城市之前，我开始上门推销。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-12<br>soup base-tale-3 一百万</p><p>女子长期被家暴，带上家里的100w去找她的情人，但是情人刚好想跟她分手，女子在火车上把装钱的箱子藏好，自己留着钥匙，下火车打电话给情人后得知情况，告诉情人钱和藏的地方后，说想要钥匙，来找我。但因为意外落水而亡，情人在火车找到了箱子，又在几天后找到了女子的尸体，但是由于尸体在水中泡胀，钥匙是项链所以卡进了脖子里面，情人最终也没有找到。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-13<br>soup base-tale-4 悔</p><p>第一个他是警察，第二个他是纵火犯。男子多年前与女儿失散 ，后来打听到是被一家人把女儿拐走，男子找到这家人，这家人为了隐瞒，就骗他说他的女儿早已经被卖走 ，男子愤怒之下，晚上把整个村子放火烧了，随后自首。后来警察鉴定了，他的女儿就在那个村子里。警察拿出的是死亡名单，男子在里面看到了女儿的名字，悔恨中自杀。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-14<br>soup base-tale-5 湖（二）</p><p>我说今天天气这么好，一起去划船吧。<br>男友又和往常一样慢悠悠的说，划什么船啊，逛逛公园还不行啊，好麻烦啊，真的是。<br>啊，好气，为什么我会找这么一个又懒又麻烦的男朋友啊！</p><p>我扭过头生闷气。<br>男友无奈的在一旁哄我。<br>“好啦，咱们这不已经在船上了嘛，别生气啦老婆，我划船你看风景好不好嘛。”<br>“我之前不想来也不是纯粹因为懒嘛，因为我今天看了天气预报好像会有暴风雨––”<br>我猛的扭过头来狠狠的盯着男友。<br>“你还敢狡辩？你就是懒，大懒猪！”<br>看着男友无奈的眼神，我忽然觉得没意思了。<br>“不划了，我要回去。”</p><p>好啊，我们回去。</p><p>突如其来的暴雨差点打翻了我们的小船，短短一会天空已经遍布黑云，我在惊慌失措中猛的记起因为匆忙赶来，我不顾男友的劝阻随手指了一支最小的船。<br>所以现在，小船将倾。<br>“我们该怎么办啊。”我发现我的声音已经带了哭腔。<br>“别害怕，我在。”男友的声音从来没有像这样让我觉得安稳。<br>我看像面色冷静的男友，紧紧揪住的心忽然轻轻松了一下。<br>可下瞬间小船被一个猛浪打了起来！<br>我在空中脑海一片空白。<br>我…就要这么…<br>可下一刻又回到一个温暖的怀抱里。<br>男友在我被拍起的瞬间跳过来抓住了我，可他在握桨啊！<br>我绝望的看着两支桨滑落水里，转瞬即逝。<br>暴雨中男友好像在说话，可我绝望中一点儿也没听懂，但这些话好像有生命一样，一个一个的钻进我的脑中。<br>“没事的老婆，你一定能活下去的，幸好你选了这只渔船，我上船前就发现侧面挂着斧头，待会你要自己划过去了，我的宝贝，要坚强，好吗。”<br>我呆滞的看着男友举起斧头，我忽然明白过来，疯了一样冲过去嚎啕大哭。<br>“你别––”<br>“别动，会砍偏的，我们不是说好了吗，要回去的。”<br>“不行不能这样青你别––”我又被猛浪拍回船框。<br>“别乱动。”男友严厉的看着我。<br>我忽然看不懂他的目光了，我以为我早就熟悉了他。他的慵懒、他的随和、和他从没凶过我的回忆一起在这道严厉的目光里消逝不见。<br>“答应我，和它们一起活着回去。”<br>血溅出来，和泪光混合一起蒙住了我的眼睛。</p><p>好啊，我们回去。</p><p>我呆滞无神的化着桨。<br>暴风依然怒吼在我的耳边。<br>雨点好像小了一点，又好像依然在疯狂的下着。<br>小船两侧留下血色的线，又很快被汹涌的湖面掩盖。</p><p>你怎么又在偷懒啊，大懒猪，给我起床！<br>好啦老婆，别闹了让我再睡一会吧，就一会。<br>睡睡睡，就知道睡！哪天醒不来我看你怎么办！<br>没事啦，你醒来叫我就好了，我没关系的。</p><p>老婆。<br>又怎么啦，我才不叫你呢，我走了，哼。<br>我爱你呀。</p><p>END</p><p>注：原创主之星.小垂汤友的出道作，答主在基础上进行了微不足道的故事加工，原型是她的自身梦境。一篇珍贵的原创汤。</p><p>且：最后是男友把自己两条腿砍下来让女主当船桨，为了减轻船体重量又主动落湖。</p><p>soup base-taste-1 海龟汤</p><p>这个男孩儿跟爸爸一起出海，中途遇到暴风，在弥留之际，爸爸用自己的肉给他熬了一碗汤，骗他的儿子说这是海龟熬成的汤，爸爸牺牲自己保住了孩子的性命。孩子安全上岸之后，去了餐厅点了一碗真正的海龟汤，发现原来不是那个味道，顿时明白了，就自杀了。</p><p>注：网传版本之一，另著名的版本还有“企鹅肉”，基本都是改编自原版“第一碗汤”(收录在第四模板)。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-29<br>soup base-taste-2 美餐</p><p>我是一只狮子，人类的衣服对我来说就是不能吃的垃圾，今天的垃圾多是因为多了一个大背包，这是一个跳伞的人，因为降落伞没打开摔死在草原里。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-29<br>soup base-taste-3 蝴蝶结</p><p>小女孩的妈妈有了婚外情，跟情人约定当小女孩的父亲不在家时就给小女孩戴上蝴蝶结作为暗号，以便情人去她家偷情。因为小女孩自己不会系蝴蝶结，所以这个暗号也就一直行之有效。而这天小女孩的老师给小女孩戴上了蝴蝶结，让情人误以为女孩父亲不在家，于是就暴露了，女孩父亲一怒之下杀了情人。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-29<br>soup base-taste-4 半根火柴</p><p>一群人坐热气球去沙漠旅行，回程途中燃料不足，必须减负，扔完所有行李后还缺多一个人的重量，于是这群人决定用火柴抽签，抽到半根火柴的那个人就自己跳下去。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-29<br>soup base-taste-5 鞋</p><p>这是一个女人，出门穿了一双高跟鞋，同时也是马戏团表演蒙眼飞镖的员工，这天因为迟到匆忙上台，所以忘了换鞋，由于她的合作搭档之前一直习惯了之前她的身高，在蒙上眼睛后并不知道这个女生由于穿了高跟鞋而改变了高度，所以导致了女生的意外死亡。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-29<br>soup base-taste-6 苹果</p><p>女孩是单亲家庭，父女之间相处很不和睦，女孩为了缓和关系，特意做了一件苹果雕刻送给父亲，而父亲对女孩的艺术品毫无兴趣，拿到手随口吃了下去，女孩在做雕刻时用于支撑的刀片又忘了取出，于是父亲因利刃割穿喉咙而死。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-29<br>soup base-taste-7 纸条</p><p>男子在一片沙漠里迷失了道路，给一株仙人掌上贴了纸条用来当路标，可过了很久不知不觉又绕回来后发现了这个贴了纸条的路标，知道自己走不出沙漠了，于是绝望自杀。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-29<br>soup base-taste-8 海上</p><p>小女孩是台风代号，死在了海上，所有周围陆地上的人都欣喜若狂。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-29<br>soup base-taste-9 花茶</p><p>男主人邀请他的妻子和朋友在家喝茶，蓝色是妻子的一杯，绿色是他的朋友的一杯。而故事背景中，妻子与男主朋友出轨，妻子以为被男主人察觉了这件事所以提前在他的红色花茶里下了毒药。但男主早已知道妻子了投毒，于是在自己的红色花茶里加了小苏打使其变成蓝色，在妻子的蓝色花茶里加入了柠檬汁变成红色，于是妻子死了。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-29<br>soup base-taste-10 光</p><p>男主妻子有心脏病，半夜突发心脏衰竭，紧急之下男人送到了家附近最近的一家私立小医院里，妻子用了呼吸机后男子在楼道里等待，光瞬间熄灭说明医院突发了断电，而因为是小医院没有备用电源，所以妻子靠呼吸机维持的生命也熄灭了，男子意识到了无可挽回的这点，所以瞬间崩溃。</p><p>注：改编中忽然很难过的一碗汤。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-29<br>soup base-taste-11 bird</p><p>他在已经开始降落的飞机上醒来，而这只鸟离飞机只剩一个危险的距离。之前的梦可以理解为对即将发生的事的心理暗示。</p><p>注：改编自焦糖小姐原创汤《一只鸟》，收录自公众号海龟汤推理大师。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-29<br>soup base-taste-12 救</p><p>女孩穿的凉鞋，里面有小石子，于是靠在一旁想抖出来， 但是她没注意到靠的是电线杆，她身后的男子看她一直再抖，以为被触电了，于是赶紧上来把她拖到，使之脱离发电体，而女孩以为要被坏人强奸，于是拼命呼喊。</p><p>注：收录改编自海龟汤推理大师.焦糖小姐的《少女路边被袭》。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-29<br>soup base-taste-13 鸡</p><p>老汉是一个精神分裂者，白天他是一个辛苦劳作的农民，晚上他就以为自己是各种动物，有一天晚上他以为自己是一只黄鼠狼，便生吃了一只鸡，第二天依然如此，吃了两只，第三天他吃了三只鸡后，去河边喝水，因为撑的太滚一头栽进河里，淹死了，尸体顺着河流搁浅在下游河岸边被人发现。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-29<br>soup base-taste-14 天台</p><p>两个人都在精神病院的天台，第一个人手里是块石头，另一个以为自己是块石头，他认为第一个人手里的石头是他的女朋友，他为了去救女朋友也一起扑下天台。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-29<br>soup base-taste-15 刺</p><p>男子死于自杀。方法是用尖锐的冰锥，冰锥化为水后无影无踪。</p><p>注：收录改编自焦糖小姐的《死后一滩水》。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-29<br>soup base-taste-16 草地和枪</p><p>男子在雪山下开了一枪，引起雪崩，被淹没后窒息而死，春天雪消融后尸体才被发现在草地上。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-29<br>soup base-taste-17 碎</p><p>两具尸体是两条鱼，凶手是小男孩，不小心撞碎了鱼缸，哭着跌跌撞撞去找妈妈。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-29<br>soup base-taste-18 黑</p><p>我回到家后家里太黑，我去开灯，因为家里煤气泄露，在我开灯的一瞬间发生爆炸，我进入了永恒的黑暗里。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-29<br>soup base-taste-19 出轨</p><p>妻子准备去闺蜜家，而老公和闺蜜出轨。妻子拿着ipad进闺蜜屋后发现wifi自动连接了，而老公说从未进过闺蜜的家，这是ipad里唯一的破绽。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-29<br>soup base-taste-20 悔</p><p>我是一个临产妇女，又难产而死，按生前遗愿我的眼睛和眼角膜都捐给了别人，受捐者抱着杀人凶手，也就是我的孩子，用我的眼睛看着我的手术记录和死亡证明，流下了眼泪。我并没有死，只不过换了一种方式去看着世界。</p><p>注：收录改编自我们的原创主之星.木鱼小姐的《被杀记录》。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-29<br>soup base-taste-21 醉酒的人</p><p>醉汉是一名积木爱好者，家里养着一只猴子，他这天由于大醉后睡姿问题，嘴巴张的很大，猴子受主人平时的影响，将他脸上的“洞”理解成了积木底盘，然后将一堆积木硬塞进去，醉汉活生生的在睡梦中窒息而死。</p><p>注：该本在进行中或被引起重口误会，请谨慎使用。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-29<br>soup base-taste-22 窗内</p><p>我是一个潜水员，我在海底一个漏水严重的潜水艇窗户外面看里面，尸体和物件在水中漂浮。缘由是这艘潜艇曾经发生船难，船舱里最后只剩两个人等待水慢慢淹进来，而手枪里只剩一颗子弹，两人都不想被淹死，所以通过打牌的方式决定谁能用枪自我了断。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-29<br>soup base-taste-23 溺</p><p>这人在森林的一条河里练习潜水，而恰好附近有片树林突发火灾，被派过来的消防飞机在就近取水的过程中，潜水的人被水泵的离心力吸附，溺水而亡，尸体被卷进水桶，喷洒出去落到森林深处了。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-29<br>soup base-taste-24 香</p><p>男子是养蜂人，工作的地点就在山林里。由于受强烈刺激的香水味影响，同时男子的熟悉气味也被遮盖，蜜蜂开始表现的具有攻击性，最终引起疯狂蛰叮。</p><p>注：收录改编自焦糖小姐的《致命香水》。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-29<br>soup base-taste-25 占线音</p><p>修理厂刚刚帮一个女人的车换了轮胎，但匆忙中忘了拧紧螺丝，修理工记起来后赶紧向女人打电话，但每次打过去都是占线，原来女人开出去后一直在接恋人的电话，在路上急转弯时车轮失去控制，于是发生事故。</p><p>注：收录改编自BlackStory黑故事。</p><p>soup base-fairy-1 红皇后的茶话会</p><p>从仙境重回现实世界后，似乎已经过去很久。爱丽丝常常怀疑那是否真的只是一场梦。<br>她照常去湖边看书。一天在森林里行走时忽然脚下一空，首先是无止境的坠落，紧接着是如此熟悉的、从耳旁穿过的风。</p><p>再度醒来，疯帽子已经站在身前。</p><p>他说，红皇后得知爱丽丝再度擅闯领地后勃然大怒，并下令如果她想离开，必须在茶话会上进行一次抽牌游戏，赢了就就放她走，否则将被砍下头颅。<br>“别怕，我会帮你的。”疯帽子温柔地抚摸着爱丽丝金色的头发。</p><p>茶话会开始了，侍女把扑克牌铺成一排，红皇后冷笑着说，三次机会，抽中红桃A，就放你走。<br>爱丽丝连续抽了两张都不是，绝望中记起疯帽子的话，他说买通了侍女，把赢的那张牌放在了第一张。</p><p>爱丽丝翻开了第一张牌，红色的A显露眼前。爱丽丝如释重负的扔给了红皇后。红皇后撇了一眼后，把这张牌扔在地上，侍卫凑上去一看，黑桃A。</p><p>刽子手手起斧落，金色的脑袋滚落在地上。<br>在爱丽丝因为困惑和恐惧而放大的瞳孔里，映出红皇后残忍肆虐的笑。</p><p>疯帽子欣赏的着这一幕，咬下一口黄油甜饼，陶醉于分泌的多巴胺之中。</p><p>爱丽丝，你还是像以前一样单纯，哪怕自己是红黑色盲，也对这张牌毫无防备。<br>可是，自从你那次抛下我回到你的世界，我就被思念和哀怨折磨至今。<br>我真的快被逼疯了。<br>所以这次，你终于再也不会离开了吧。</p><p>可是我没骗你啊，这张牌，的确是赢牌啊。</p><p>喷涌而出的血液把盛开的玫瑰染得更加娇艳，疯帽子站起来看着爱丽丝，那双空洞的眼睛仿佛还在同自己对视。</p><p>“爱丽丝，乌鸦为什么像写字台。”<br>“你为什么不留下，永远陪我呢。”</p><p>注：小垂原创，灵感取自自身梦境，极其珍贵的原创作品，请使用时务必尊重作者版权。</p><p>又：爱丽丝梦游仙境原著中，“乌鸦为什么像写字台”是一句表白语，意为喜欢你没有理由。所以汤面中疯帽子的话的大致意思为，现在你知道我有多爱你了吧。</p><p>soup base-event-1 斩手狂</p><p>大海上发生了船难，男主在救生艇上，但是救生艇已经达到承载人数的上限，许多溺水者仍然不断游过来，想要抓住救生艇。为了避免救生艇翻覆，男子只好将溺水者伸出来的手一一砍断。</p><p>注：算是海龟汤第一碗新闻汤，日本的大和战舰沉没时发生过这样的事情，《史记》中春秋时代的晋楚相争也有过记载。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-29<br>soup base-event-2 溺</p><p>沙漠的这块地方准备修建水坝，从一处溪谷里引来水流，冲进沙漠，流浪汉就是被这么淹死的。</p><p>注：改编自美国历史中著名的城市开发丑闻，二十世纪初，坐落在荒漠上大海边的洛杉矶缺乏淡水，需要修建水库储水，在此背景上，开发商与市政府合作，推出水坝工程，从远处的埃文斯溪谷引水。中间有三点，其一，开发商承包政府工程利润巨大。其二，为让此工程通过，开发商不惜将水库的储水倾倒大海，加剧城市水危机。其三，开发商大面积廉价购买了郊区荒漠，引来的溪水被用来将此地开发成有水之地，因此得以一本万利。该事件导致了埃文斯溪谷干涸，史称强奸埃文斯溪谷事件。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-29<br>soup base-event-3 冰激凌</p><p>故事发生在美国六七十年代，小孩们总爱钻进老式冰箱玩耍，他的弟弟才6岁，有天躲进冰箱，但是门被意外上锁，他们家的冰箱里只有巧克力味的冰激凌，他那天想吃其他口味的，于是出去买了，弟弟在冰箱无人回应，最终在又冷又窒息的环境中死去。</p><p>注：改编自某新闻案例。</p><p>又：美国六七十年代大部分家庭还是使用老式冰箱，类似于保险柜，冰箱采用门闩系统，外边的门把垂直锁上后，从里面根本无法打开，为了冷藏效率门关上后密不透风，隔音效果也相当优秀，同时阻拦了空气流通，因此注定使藏身其中的人遭受冰冻和窒息的后果。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-29<br>soup base-event-4 桥</p><p>我是一名黑人，故事发生在美国的开垦年代，我的居所和公园隔着一条河流，本来用于两地之间通行的桥被改建成了白人专用、禁止黑人及乘载黑人的汽车通行。</p><p>注：改编自美国公民权运动前真实事件。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-29<br>soup base-event-5 线</p><p>装有心脏起搏器的病人在做核磁共振时，起搏器的导线被共振产生的强大磁力折断，导致死亡。</p><p>注：出自新华网2001年8月新闻报道，美国发生的一项真实案例。</p><p>另，起搏器含有金属，因此才能被核磁共振的磁力吸引。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-29<br>soup base-event-6 男孩</p><p>男孩在接受核磁共振时，检查室里有一个氧气瓶没有被固定好，被强大的磁力吸入仪器内，砸死了男孩。</p><p>注：出自新华网2001年8月新闻报道，美国发生的一项真实案例。</p><p>另，氧气瓶为金属制，会受磁力牵引。<br>山法官<br>山法官​<br>(作者) 回复山法官​<br>(作者) 2020-11-29<br>soup base-event-7 口角</p><p>故事在美国旧金山，a是白人，b是黑人，且a一家三口都是强烈的黑人歧视者。<br>某天，b在街头撞到了a，因此引发了口角纠纷，a对其进行了强烈的种族侮辱。<br>b因此怀恨在心，跟踪了a几天后，趁a一个人在路上没有防备时背后打晕了a，并带到了自己开的纹身店，把a整个人全部纹成黑色，然后扔到街道上。<br>a醒来后，踉踉跄跄回到家中，但一进门就吓到了妻子，妻子拼命呼喊救命，还不等a去努力解释，a就背后中枪而死。<br>原来是a的儿子在卧室听到母亲尖叫声后，拿上猎枪从窗户翻出去绕到了门外，缓缓地将枪口指向了“黑人”的后背。</p><p>注：改编自盖·纳蒂弗的短篇电影《肤色Skin》(曾获91届奥斯卡金像奖）。</p><p>FROM BILIBILI:<br>①医学院惨案</p><p>汤面：</p><p>在一间医学院里，ABC是舍友，A的成绩很好，是班里的班长。B的身体比较虚弱。有一天有人发现AB的尸体，C疯了，请推理出故事全貌。</p><p>汤底：</p><p>学校最近有一门解剖考试。 A有梦游症，并且可以在梦游中学习知识，所以成绩优秀。因为是班长所以备有解剖室的钥匙，B因为担心考试挂科等大家都睡觉后偷了A的钥匙到解剖室独自练习，身体虚弱的B在练习完后索性睡在了解剖台上连门都没有关。当晚A梦游到了解剖室打算进行“解剖考试”。梦游中的A把B当作实验尸体把四肢绑在解剖台上一点一点的解剖。当A醒来后发现自己已经把B解剖得不堪入目，接受不了事实于是用刀自杀。室友C一早起床发现AB不在，非常担心于是就出去找，直到在开着门的解剖室发现了血肉模糊的B和自杀的A，吓疯了。</p><p>②出不去的厕所</p><p>汤面：</p><p>张三去了趟厕所，结果发现自己出不去了。</p><p>线索：张三的四段内心独白</p><p>…似乎又可以出去了？</p><p>…真的可以出去吗？</p><p>…不行！决不能出去！</p><p>…我想，我应该是出不去了…</p><p>汤底：</p><p>张三发现厕所外面有人在杀人，胆小的张三不敢制止所以出不去了。杀完人凶手好像离开了，所以又说能出去了。结果凶手杀完人其实是去拿了工具又回来分尸装进麻袋，所以又出不去了。这时尸体怨气不散成了鬼，杀了凶手又来杀了厕所里的张三，因为凶手杀人的时候张三没有制止。</p><p>③村子里的怪叫声</p><p>汤面:</p><p>某个村子每家每户过了0点必须关灯，于此同时半夜三更都会传来怪叫声，虽然把全村人都吵醒都没有人出去看。真相是什么？</p><p>汤底：</p><p>村中有个人人皆知的变态杀人狂，行迹神秘且有夜盲症，所以全村人都必须要在晚上关灯。由于杀人狂在没有灯的地方找不到人，于是就用怪叫声来吸引村民夜晚开灯并将其杀死。</p><p>④甜汤命案</p><p>汤面：</p><p>晚饭时，玛丽的爸爸抱怨妈妈做的汤太甜了，当晚，妈妈就死了</p><p>汤底：玛丽是个极端主义者，无法容忍家庭中有任何人对家庭不忠。玛丽最近发现父母的关系没有从前好了，并且还在厨房里发现了毒药，玛丽断定一定是爸爸妈妈之中有一人想毒害自己的伴侣。为了知道谁对这个家不忠，玛丽把毒药换成了糖，结果当晚喝到甜汤的是爸爸，于是玛丽便下毒药将妈妈毒死了。后来玛丽才知道，原来是爸爸想要杀了妈妈，而他已经知道毒药被玛丽发现，于是顺水推舟，让玛丽亲手害死妈妈。</p><p>⑤一杯冰水</p><p>汤面：</p><p>小蔡走进了一家餐厅，要了一杯冰水，</p><p>服务员掏出了枪对准了他，他说了一声谢谢。</p><p>为什么？</p><p>汤底：</p><p>小蔡打嗝难忍，想点一杯冰水止嗝，于是服务员掏出了一把假枪吓他，他的打嗝成功被吓没了，知道真相的小蔡感激不尽。</p><p>(混入了什么奇怪的东西啊喂！)</p><p>⑥敲门声</p><p>汤面：</p><p>小梅和老公小王驾车旅游，深夜在一条山路车抛锚了，小王说要走到前面的镇子里去找一位修理工，小梅先留在车里。在车内看不到外面的情况下，夫妻俩约定小王回来时敲三下车门小梅就开门，过了不久，小梅听到了很多次敲门声但从来都不是三下。请推理出故事全貌。</p><p>汤底：</p><p>小王刚走不久就被守株待兔的变态杀人犯杀了，拖着他的尸体回到了车旁边，把他吊在了旁边的树上，当时风很大，小王的头时常会撞到车门再回弹撞很多次。</p><p>⑦废旧古堡</p><p>汤面：</p><p>我和小伙伴约好一起去废弃的古堡参加万圣节变装派对，结果只剩下了我一个……请推理故事全貌</p><p>汤底：</p><p>我和小伙伴们约定好玩躲猫猫，我找了半天都没在古堡里发现什么好躲的地方。我只好打算躲在假棺材里吓他们一下，结果我等了好久好久，都没有人来，当我想推开棺材盖时，却发现棺材已经被锁上了，这时，我才发现不对劲，我被伙伴们送进了真棺材……</p><p>⑧不敢喝的水</p><p>汤面：</p><p>有一位男子常驻在了一家饭店，某一天他再也不敢喝饭店里的水了，请问为什么？</p><p>汤底：</p><p>某一天，一位女子在这个饭店里失踪了，</p><p>警察找了很久，都找不到。原来是男子杀了这位女子，并把她藏在饭点顶楼的水仓里。</p><p>改编自《蓝可儿事件》</p><p>⑨健身房</p><p>汤面：</p><p>最近来健身房的人越来越少，但老板的心情却越来越好，钱正前几天受伤找老板请假，发现了老板的秘密……请推理故事全貌</p><p>汤底：</p><p>钱正在跑步机上跑步的时候摔倒了，发现跑步机的履带上居然冒着油，仔细一闻居然好像是人油，钱正没再多想来到老板的办公室请假，发现刚才还在的人现在却不见了，没想到在钱正翻看书架时意外打开了老板的密室，眼前的一幕，把钱正吓坏了……</p><p>⑩三兄弟(经 典 永 流 传)</p><p>汤面：</p><p>A和B是一对双胞胎，他们和C关系非常好，三人每天都要睡在同一张床上，有一天A病死了，当晚C把B杀了。请推理出故事全貌</p><p>汤底：</p><p>A病死后，每天晚上睡在A和B中间的C因为心理怪癖无法忍受睡觉时一边没有人，于是把B纵向劈成了两半，睡觉时C在自己的左边放B的右半边，在自己的右边放B的左半边。以保证睡觉时的“安全感”<br>作者：九十九克游码<br><a href="https://www.bilibili.com/read/cv9200136/">https://www.bilibili.com/read/cv9200136/</a><br>出处： bilibili</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>远程桌面使用SSL证书</title>
      <link href="/blog/remote-desktop-use-ssl-certificates/"/>
      <url>/blog/remote-desktop-use-ssl-certificates/</url>
      
        <content type="html"><![CDATA[<p>远程桌面默认的证书是自签的，会报证书错误，为了安全起见使用CA签的证书。<br>去腾讯云TrustAsia弄个一年的免费证书，然后下载。因为windows不能识别这玩意，需要先转换成p12格式。<br><strong>openssl是git自带的</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">openssl pkcs12 -<span class="hljs-built_in">export</span> -clcerts -<span class="hljs-keyword">in</span> [xxx.pem] -inkey [xxx.key] -out [xxx.p12]<br></code></pre></td></tr></table></figure><p>把.p12文件拷到服务器，然后导入，并记下证书指纹。</p><p>还需要将导入后的密钥设置权限，添加<code>NETWORK SERVICE</code>用户的Read（读）权限。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">wmic /namespace:\\root\cimv2\TerminalServices PATH Win32_TSGeneralSetting Set SSLCertificateSHA1Hash=<span class="hljs-string">&quot;&lt;指纹&gt;&quot;</span> 。<br></code></pre></td></tr></table></figure><p>重启远程桌面服务，当你重新连接的时候你就会在上面的连接栏看到一把锁的图案，并且没有证书错误提示了。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">net stop termservice &amp;&amp; net start termservice<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 软件安装与配置 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Windows </tag>
            
            <tag> SSL </tag>
            
            <tag> 远程桌面 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VS静态编译设置</title>
      <link href="/blog/vs-static-compilation-setting/"/>
      <url>/blog/vs-static-compilation-setting/</url>
      
        <content type="html"><![CDATA[<p>有时候把自己写的程序拷到其他电脑上运行，会出现缺少msxxxx.dll的提示，这是因为目标电脑上没有安装对应版本的C++运行库。</p><p>这时候要么在目标电脑上安装C++运行库，要么在编译的时候把动态编译（不包含运行库）改成静态编译（自带运行库）。另外，动态编译生成的体积比静态编译下的的体积要小的多。</p><p>首先必须搞清楚项目-&gt;项目属性-&gt;配置属性-&gt;C&#x2F;C++-&gt;代码生成-&gt;运行库中四个选项的关系： </p><table><thead><tr><th>显示名</th><th>编译选项</th></tr></thead><tbody><tr><td>多线程调试Dll (&#x2F;MDd)</td><td>MD_DynamicDebug</td></tr><tr><td>多线程Dll (&#x2F;MD)</td><td>MD_DynamicRelease</td></tr><tr><td>多线程(&#x2F;MT)</td><td>MD_StaticRelease</td></tr><tr><td>多线程(&#x2F;MTd)</td><td>MD_StaticDebug</td></tr></tbody></table><p>在msdn中有详细解释:<br><a href="http://msdn.microsoft.com/en-us/library/2kzt1wy3(VS.80).aspx">http://msdn.microsoft.com/en-us/library/2kzt1wy3(VS.80).aspx</a></p><p>带有小d的（比如&#x2F;MDd，&#x2F;MTd）是Debug模式的。<br>带有D是动态（&#x2F;MD，&#x2F;MDd），带有T是静态（&#x2F;MT，&#x2F;MTd）。</p>]]></content>
      
      
      <categories>
          
          <category> 踩坑记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>refs坏处</title>
      <link href="/blog/refs-disadvantage/"/>
      <url>/blog/refs-disadvantage/</url>
      
        <content type="html"><![CDATA[<p>一年半前把我那块移动硬盘格式化为refs（好玩），用了这么久这玩意，随便写一点有啥缺点吧。（我只说我碰到的，老生常谈的什么无法引导我就省略了）</p><p>首先它不像NTFS那样可以检查错误，它如果碰到文件错误会直接删除，只会在日志上留条记录，不会跟你说一声<br>其次如果把steam的库文件夹放到这玩意上，我更新窝窝屎的时候老是出现磁盘写入错误，结果发现那个文件在硬盘上已经没有了，但是还是显示在文件上（就是删除的时候会显示什么未找到xxx，请确认之类的）。<br>兼容性非常差，不同win10之间都读不出来。更新个测试版的系统，发现天天崩溃，想回去用原来的系统，结果发现原来系统读不出来refs盘，最后只能被绑架用这个天天绿屏的玩意。。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>cobalt-strike笔记</title>
      <link href="/blog/cobalt-strike-notes/"/>
      <url>/blog/cobalt-strike-notes/</url>
      
        <content type="html"><![CDATA[<h2 id="Windows-Executeable（s）和-Windows-Executeable的区别"><a href="#Windows-Executeable（s）和-Windows-Executeable的区别" class="headerlink" title="Windows Executeable（s）和&gt;Windows Executeable的区别"></a>Windows Executeable（s）和&gt;Windows Executeable的区别</h2><p>Windows Executeable（s）对应的是stage(stageless)<br>Windows Executeable 对应的是stager<br>stager是一个小程序，作用是下载stage并运行。stage则就是包含了很多功能的大马，用于接受和执行我们控制端的任务并返回结果。<br>stager通过各种方式下载stage并运行这个过程称为Payload Staging。同样Cobalt strike也提供了类似传统远控上线的方式，把功能打包好直接运行后便可以与teamserver通讯，这个称为Payload Stageless，如果需要生成Stageless，可以直接在Attack-&gt;Package-&gt;Windows Executeable（s）下生成。</p><h2 id="去除CS证书特征"><a href="#去除CS证书特征" class="headerlink" title="去除CS证书特征"></a>去除CS证书特征</h2><p>cs证书库默认密码123456，先添加证书，然后再删除默认的证书。</p><p>查看证书</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">keytool -list -v -keystore cobaltstrike.store<br></code></pre></td></tr></table></figure><p>添加证书</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">keytool -keystore ./cobaltstrike.store -storepass 123456 -keypass 123456 -genkey -keyalg RSA -alias microsoft -dname &quot;CN=microsoft, OU=Microsoft, O=SoftwareSecurity, L=Washington, S=DC, C=US&quot;<br></code></pre></td></tr></table></figure><p>删除默认证书</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">keytool -delete -alias cobaltstrike<br></code></pre></td></tr></table></figure><h2 id="DSN-beacon"><a href="#DSN-beacon" class="headerlink" title="DSN beacon"></a>DSN beacon</h2><p>一般来讲系统有个叫<code>systemd-resolved</code>的玩意会占用53端口，需要手动解除占用，才能使用cs的dns监听器</p><p>最后用nslook ns1.xxxxx来检验是否配置正确。</p><p>设置listener的时候，DNS Host(Stager)不是一定要填IP地址，可以填上面DNS Host的任意一条就行。</p><h2 id="使用Cloudflare隐匿C-C"><a href="#使用Cloudflare隐匿C-C" class="headerlink" title="使用Cloudflare隐匿C&amp;C"></a>使用Cloudflare隐匿C&amp;C</h2><p>去Freenom注册个域名，然后挂到Cloudflare下。</p><p>Cloudflare -&gt; SSL&#x2F;TLS -&gt; 源服务器 -&gt; 创建证书</p><p>选择PEM格式，把源证书复制下来叫server.pem。私钥复制下来叫server.key。<br>然后</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">openssl pkcs12 -<span class="hljs-built_in">export</span> -<span class="hljs-keyword">in</span> server.pem -inkey server.key -out cfcert.p12 -name cloudflare_cert -passout pass:123456<br><br><span class="hljs-built_in">sudo</span> keytool -importkeystore -deststorepass 123456 -destkeypass 123456 -destkeystore cfcert.store -srckeystore cfcert.p12  -srcstoretype PKCS12 -srcstorepass 123456 -<span class="hljs-built_in">alias</span> cloudflare_cert<br></code></pre></td></tr></table></figure><p>然后在Malleable C2里加上这个</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">https-certificate</span> &#123;<br>    <span class="hljs-string">set</span> <span class="hljs-string">keystore</span> <span class="hljs-string">&quot;cfcert.store&quot;</span><span class="hljs-string">;</span><br>    <span class="hljs-string">set</span> <span class="hljs-string">password</span> <span class="hljs-string">&quot;123456&quot;</span><span class="hljs-string">;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>另外一定要记得修改X-Forwarded-For 头配置，不然上线IP就是Cloudflare的数据中心了。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">http-config</span> &#123;<br>    <span class="hljs-string">set</span> <span class="hljs-string">trust_x_forwarded_for</span> <span class="hljs-string">&quot;true&quot;</span><span class="hljs-string">;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>然后可以访问<a href="https://www.cloudflare.com/ips/">https://www.cloudflare.com/ips/</a>，去把cloudflare的地址都加入云服务器的安全组，只允许cloudflare链接。</p>]]></content>
      
      
      <categories>
          
          <category> 学习 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Office E5订阅</title>
      <link href="/blog/office-e5/"/>
      <url>/blog/office-e5/</url>
      
        <content type="html"><![CDATA[<p><strong>！！！2024年4月开始，微软开始大规模整治E5，大量封号，建议不要尝试本文方法！！！</strong></p><p>其实这玩意去年年末我已经开始搞了，中间想写一篇关于如何白嫖的文章，但是我担心没法续订，所以拖到现在才写。</p><h2 id="什么是Office-E5"><a href="#什么是Office-E5" class="headerlink" title="什么是Office E5"></a>什么是Office E5</h2><p>Office 365 开发版 E5 是为开发人员提供的。申请Office 365开发者计划，可以获得为期3个月的免费Office 365 E5。</p><p>注册成功之后可以获得为其90天的全套Office 365，每个人拥有5T Onedrive网盘。<br>（该许可证最多可添加25个用户，就相当于25个Office 365订阅，5T×25的Onedrive容量）</p><p>快到90天的时候微软如果认为你是开发者，会自动进行续订，再给你90天的订阅时间，并发送一封续订成功的电子邮件。<br><strong>网上有人说，如果到了90天之后，微软会给你点时间进行数据备份，然后微软会删除你的数据，到了这个时候就乖乖备份吧（我没到过这个阶段，你可以赌一下）</strong></p><p>顺便晒一下续订成功的邮件<br><img src="https://cdn.jsdelivr.net/gh/Tokisaki-Galaxy/res/post/office-e5/1.jpg" alt="续订成功邮件"></p><h2 id="申请教程"><a href="#申请教程" class="headerlink" title="申请教程"></a>申请教程</h2><h3 id="申请Office-E5"><a href="#申请Office-E5" class="headerlink" title="申请Office E5"></a>申请Office E5</h3><p>1.进入<a href="https://developer.microsoft.com/zh-cn/microsoft-365/dev-program">官网</a>后，点击立即加入。<br><img src="https://cdn.jsdelivr.net/gh/Tokisaki-Galaxy/res/post/office-e5/2.jpg" alt="立即加入"></p><h3 id="用自己的微软账户登录"><a href="#用自己的微软账户登录" class="headerlink" title="用自己的微软账户登录"></a>用自己的微软账户登录</h3><h3 id="登录之后填写国家地区、基本信息就不说了，自己写就好了"><a href="#登录之后填写国家地区、基本信息就不说了，自己写就好了" class="headerlink" title="登录之后填写国家地区、基本信息就不说了，自己写就好了"></a>登录之后填写国家地区、基本信息就不说了，自己写就好了</h3><h3 id="创建订阅"><a href="#创建订阅" class="headerlink" title="创建订阅"></a>创建订阅</h3><p>这一步很关键，</p><p>第一个国家的意思是你的onedrive数据等存储位置。比如我选择US，那么我的数据就是放在美国的微软数据中心。所以根据你自己的真实位置去选择。（当然一般建议如果都很远就选美国，因为美国的网络基础建设很好，以后搭网盘也快一点）</p><p>第二个用户名随意，admin或者root再或者iamsb随便挑。</p><p>第三个域名，是登录时的后缀。是由microsoft给你的免费二级域名。其实也是个邮箱地址的后缀。</p><p>随便写一个自己喜欢的就好，只要不是已经被注册的就行。但是注意，这个注册完就不能改了。</p><p><img src="https://cdn.jsdelivr.net/gh/Tokisaki-Galaxy/res/post/office-e5/3.jpg" alt="创建订阅"><br>然后会让你验证一个手机号。用国内的也行。</p><hr><h3 id="添加许可证"><a href="#添加许可证" class="headerlink" title="添加许可证"></a>添加许可证</h3><p>接着上面，验证完手机号之后你会跳转到<a href="https://developer.microsoft.com/zh-cn/microsoft-365/profile">这个页面</a>，<strong>（当然你应该是显示91天，我这里是因为续订了，才显示120天）</strong>。点击那个用红框框出来的按钮，进入后台。<br><img src="https://cdn.jsdelivr.net/gh/Tokisaki-Galaxy/res/post/office-e5/4.jpg" alt="转到订阅"></p><p>现在，我们已经申请好了E5订阅了。如果你只是自己用，现在已经可以使用“用户名@域.onmicrosoft.com”和之前设置的密码登录你电脑上的Office和Onedrive了。</p><p><strong>进后台最好挂个梯子，不然国内有些地区加载不了。</strong></p><p>进入 管理 - &gt; 用户 -&gt; 活跃用户 -&gt; 点击用户名 -&gt; 许可证和用户 ,添加好后点击应用就可以了<br><img src="https://cdn.jsdelivr.net/gh/Tokisaki-Galaxy/res/post/office-e5/5.jpg" alt="“管理”按钮在哪"></p><hr><h3 id="Onedrive网盘"><a href="#Onedrive网盘" class="headerlink" title="Onedrive网盘"></a>Onedrive网盘</h3><h4 id="设置5T网盘容量"><a href="#设置5T网盘容量" class="headerlink" title="设置5T网盘容量"></a><strong>设置5T网盘容量</strong></h4><p>默认onedrive容量是1T，但是可以通过设置更改为5T。（强烈建议去改成5T）</p><p>一个域名下最多有25个用户，所以最多有25*5T&#x3D;125T的云存储空间。还可以改回收站保留时间。</p><p>修改默认容量大小：</p><ol><li><p>打开微软365管理中心，<a href="https://admin.microsoft.com/">点击前往✈</a> 登陆上你的E5管理员账号。</p></li><li><p>点击左侧下方的全部显示，点击展开后显示的“SharePoint”，点击打开，选到左边设置，就可以修改默认Onedrive分配大小。</p><p><img src="https://cdn.jsdelivr.net/gh/Tokisaki-Galaxy/res/post/office-e5/6.jpg" alt="修改默认分配大小"></p></li></ol><p>其他自己去慢慢探索吧，就不详细说了。</p><hr><h3 id="零零碎碎的其他注意事项"><a href="#零零碎碎的其他注意事项" class="headerlink" title="零零碎碎的其他注意事项"></a>零零碎碎的其他注意事项</h3><p>最好给<a href="admin.microsoft.com">管理员控制面板</a>加个书签，免得找不到</p><hr><h2 id="自动续订教程"><a href="#自动续订教程" class="headerlink" title="自动续订教程"></a>自动续订教程</h2><p><strong>Office E5订阅第一次订阅有效期是90天，到期后会进行一次检测，以此判断你是否有资格继续白嫖。</strong></p><p>无限续期的原理是多次调用API来达到让microsoft认为你是开发者，然后给你白嫖（自动续期）E5的效果。所以续订不是100%成功的，要看巨硬心情。</p><p>（虽然挺大概率成功的，但总归要提醒一下，以防万一</p><h3 id="Telegram法"><a href="#Telegram法" class="headerlink" title="Telegram法"></a>Telegram法</h3><p>首推这个方法，最简单的。<br>添加<a href="https://t.me/E5Sub_bot">这个机器人</a>，然后按提示一步一步走就行了，记得设机器人为免打扰，不然吵死你。</p><h3 id="Github-Actions法"><a href="#Github-Actions法" class="headerlink" title="Github Actions法"></a>Github Actions法</h3><p>论Github Actions的无数种用法。</p><p><a href="https://github.com/ishadows/AutoApiP">传送门</a></p><p>根据教程一步一步做就行了，挺简单的。</p><h3 id="OneIndex法"><a href="#OneIndex法" class="headerlink" title="OneIndex法"></a>OneIndex法</h3><p>这个严格来说不能算一个单独的续订方法，续订只是它的一个副产品而已，但是也顺便加上了（毕竟怎么说都是能续订的）。</p><p>这个说的东西有点多，有空哪天再开个坑详细讲吧。这个玩意已经算是个Onedrive的第三方客户端了。今天彩六新赛季，要去上分了。</p>]]></content>
      
      
      <categories>
          
          <category> 软件安装与配置 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Office </tag>
            
            <tag> 激活 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>《C++入门经典（第10版）》学习笔记</title>
      <link href="/blog/c-study-notes/"/>
      <url>/blog/c-study-notes/</url>
      
        <content type="html"><![CDATA[<p>写在学《C++入门经典（第10版）》的时候，主要是记录一些以前没有注意，不知道的地方。</p><p>强力安利这本书，讲的浅显易懂，而且使用的技术都比较新，非常适合自学的人。</p><p>全文都是我一个字一个字打上来的，为了省事，会适量忽略一些不重要信息（比如要包含声明头文件，反正vs有提示，就不打了）。</p><h2 id="第2章-C-基础知识"><a href="#第2章-C-基础知识" class="headerlink" title="第2章 C++基础知识"></a>第2章 C++基础知识</h2><h3 id="转义序列"><a href="#转义序列" class="headerlink" title="转义序列"></a>转义序列</h3><table><thead><tr><th>名称</th><th>转义序列</th></tr></thead><tbody><tr><td>换行符</td><td>\n</td></tr><tr><td>水平制表符</td><td>\t</td></tr><tr><td>响铃符</td><td>\a</td></tr><tr><td>反斜杠</td><td>\</td></tr><tr><td>双引号</td><td>&quot;</td></tr></tbody></table><p>此外， C++11 支持<strong>原始字符串字面值</strong>，适合于有大量字符需要转义的情况。<br>要求以<code>R</code>开头，而且字符串内容要放到圆括号内，圆括号外还要再加一对双引号。<br>以下代码输出字符串字面值 “c:\Windows&quot;。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c++">cout &lt;&lt; <span class="hljs-string">R&quot;(c:\Windows\)&quot;</span>;<br></code></pre></td></tr></table></figure><h3 id="格式化带小数点的数字"><a href="#格式化带小数点的数字" class="headerlink" title="格式化带小数点的数字"></a>格式化带小数点的数字</h3><p><a href="#%E7%94%A8%E6%B5%81%E5%87%BD%E6%95%B0%E6%A0%BC%E5%BC%8F%E5%8C%96%E8%BE%93%E5%87%BA">传送门</a></p><h2 id="第3章-更多的控制流程"><a href="#第3章-更多的控制流程" class="headerlink" title="第3章 更多的控制流程"></a>第3章 更多的控制流程</h2><h3 id="枚举类型（选读）"><a href="#枚举类型（选读）" class="headerlink" title="枚举类型（选读）"></a>枚举类型（选读）</h3><p><strong>枚举类型</strong>是值用一组 int 类型的常量来定义的类型。枚举类型就像是包含了一组声明常量的列表。<br>枚举类型中，两个或更多的命名常量可接受同一个 int 值。<br>如果不指定任何数值，枚举类型中的标识符会被自动分配一组连续的值，这些值的第一个是0，其余常量是上一个值增加1——除非显式指定了一个或多个枚举常量的值。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-keyword">enum</span> <span class="hljs-title class_">Direction</span> &#123; NORTH = <span class="hljs-number">0</span>, SOUTH = <span class="hljs-number">1</span>, EAST = <span class="hljs-number">2</span>, WEST = <span class="hljs-number">3</span> &#125;<br><span class="hljs-keyword">enum</span> Direction &#123; NORTH, SOUTH, EAST, WEST &#125;<br><span class="hljs-comment">//以上两条语句等价。</span><br></code></pre></td></tr></table></figure><p>C++11 中引入了一种新的枚举，称为<strong>强枚举</strong>或<strong>枚举类</strong>。<br>为定义强枚举，在 enum 后添加关键字 class 就可以了。</p><h3 id="再论递增操作符和递减操作符"><a href="#再论递增操作符和递减操作符" class="headerlink" title="再论递增操作符和递减操作符"></a>再论递增操作符和递减操作符</h3><p>++在变量之前，先递增再返回值；++在变量之后，先返回值再递增。</p><h2 id="第4章-过程抽象和返回值的函数"><a href="#第4章-过程抽象和返回值的函数" class="headerlink" title="第4章 过程抽象和返回值的函数"></a>第4章 过程抽象和返回值的函数</h2><h3 id="一些预定义函数"><a href="#一些预定义函数" class="headerlink" title="一些预定义函数"></a>一些预定义函数</h3><table><thead><tr><th>名称</th><th>说明</th></tr></thead><tbody><tr><td>sqrt</td><td>平方根</td></tr><tr><td>pow</td><td>乘方（幂）（实参，返回值均为 double ）</td></tr><tr><td>abs</td><td>取 int 的绝对值</td></tr><tr><td>labs</td><td>取 long 的绝对值</td></tr><tr><td>fabs</td><td>取 double 的绝对值</td></tr><tr><td>ceil</td><td>向上取整</td></tr><tr><td>floor</td><td>向下取整</td></tr><tr><td>srand</td><td>为随机数生成器提供种子值</td></tr><tr><td>rand</td><td>随机数</td></tr></tbody></table><h3 id="强制类型转换"><a href="#强制类型转换" class="headerlink" title="强制类型转换"></a>强制类型转换</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-built_in">static_cast</span>&lt;目标类型&gt;(表达式);<br><span class="hljs-comment">// int 转 double</span><br><span class="hljs-built_in">static_cast</span>&lt;<span class="hljs-type">double</span>&gt;(<span class="hljs-number">3</span>);<br><br><span class="hljs-comment">//强制类型转换的古老形式</span><br>类型名(表达式);<br><span class="hljs-built_in">double</span>(<span class="hljs-number">3</span>);<br><br><span class="hljs-comment">//虽然说要尽量使用第一种，但是第二种打的字少一些，所以...</span><br></code></pre></td></tr></table></figure><h3 id="另一种形式的函数声明"><a href="#另一种形式的函数声明" class="headerlink" title="另一种形式的函数声明"></a>另一种形式的函数声明</h3><p>函数声明中不一定要列出形参名称，以下两个函数声明等价：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">abc</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">double</span> b)</span></span>;<br><span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">abc</span><span class="hljs-params">(<span class="hljs-type">int</span>, <span class="hljs-type">double</span>)</span></span>;<br></code></pre></td></tr></table></figure><p>但应坚持使用第一种形式，以确保可读性。</p><h2 id="第5章-用函数完成所有子任务"><a href="#第5章-用函数完成所有子任务" class="headerlink" title="第5章 用函数完成所有子任务"></a>第5章 用函数完成所有子任务</h2><h3 id="传引用参数"><a href="#传引用参数" class="headerlink" title="传引用参数"></a>传引用参数</h3><p>有时候有奇效，用起来超级舒服。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-comment">// 普通的（传值调用函数）声明方法</span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">abc</span><span class="hljs-params">(<span class="hljs-type">int</span> a)</span></span>;<br><span class="hljs-comment">// 传引用函数声明方法</span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">abc</span><span class="hljs-params">(<span class="hljs-type">int</span>&amp; a)</span></span>;<br></code></pre></td></tr></table></figure><h2 id="第6章-I-O流——对象和类入门"><a href="#第6章-I-O流——对象和类入门" class="headerlink" title="第6章 I&#x2F;O流——对象和类入门"></a>第6章 I&#x2F;O流——对象和类入门</h2><h3 id="文件I-O"><a href="#文件I-O" class="headerlink" title="文件I&#x2F;O"></a>文件I&#x2F;O</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br>ifstream inStream;<br>ofstream outStream;<br><br>inStream.<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;infile.dat&quot;</span>);<br>outStream.<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;outfile.dat&quot;</span>);<br><br>inStream.<span class="hljs-built_in">close</span>();<br>outStream.<span class="hljs-built_in">close</span>();<br></code></pre></td></tr></table></figure><h4 id="追加到文件（选读）"><a href="#追加到文件（选读）" class="headerlink" title="追加到文件（选读）"></a>追加到文件（选读）</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c++">ofstream fout;<br>fout.<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;data.txt&quot;</span>,ios::app);<br></code></pre></td></tr></table></figure><h3 id="用流函数格式化输出"><a href="#用流函数格式化输出" class="headerlink" title="用流函数格式化输出"></a>用流函数格式化输出</h3><p>每个输出流的成员函数（部分）：</p><table><thead><tr><th>标志</th><th>含义</th></tr></thead><tbody><tr><td>precision()</td><td>指定小数点后不同位数</td></tr><tr><td>setf()</td><td>设置标志</td></tr><tr><td>width()</td><td>输出项占多少个空格（域宽）（用于左右对齐）</td></tr></tbody></table><p>setf()的格式化标志：</p><table><thead><tr><th>标志</th><th>含义</th></tr></thead><tbody><tr><td>ios::fixed</td><td>不用科学计数法</td></tr><tr><td>ios::scientific</td><td>用科学计数法</td></tr><tr><td>ios::showpoint</td><td>显示浮点数后面所有0</td></tr><tr><td>ios::showpos</td><td>正整数之前会输出正号</td></tr><tr><td>ios::right</td><td>右对齐</td></tr><tr><td>ios::left</td><td>左对齐</td></tr></tbody></table><p>任何标志都可以使用unsetf()取消。</p><h3 id="操纵元"><a href="#操纵元" class="headerlink" title="操纵元"></a>操纵元</h3><table><thead><tr><th>标志</th><th>含义</th></tr></thead><tbody><tr><td>endl</td><td>这个不说了</td></tr><tr><td>setw</td><td>和width完全一样</td></tr><tr><td>setprecision</td><td>和precision完全一样</td></tr></tbody></table><p>这玩意感觉挺多余的。。</p><h3 id="字符串I-O"><a href="#字符串I-O" class="headerlink" title="字符串I&#x2F;O"></a>字符串I&#x2F;O</h3><p>put(),get(),putback()</p><h4 id="万用型流参数"><a href="#万用型流参数" class="headerlink" title="万用型流参数"></a>万用型流参数</h4><p>适用于有时候是cin，有时候是输入文件流的情况。</p><table><thead><tr><th>名称</th><th>关键字</th></tr></thead><tbody><tr><td>输入流</td><td>istream</td></tr><tr><td>输出流</td><td>ostream</td></tr></tbody></table><h4 id="函数的默认实参（选读）"><a href="#函数的默认实参（选读）" class="headerlink" title="函数的默认实参（选读）"></a>函数的默认实参（选读）</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">newLine</span><span class="hljs-params">(istream&amp; inStream = cin)</span></span>;<br></code></pre></td></tr></table></figure><h4 id="检查文件结尾"><a href="#检查文件结尾" class="headerlink" title="检查文件结尾"></a>检查文件结尾</h4><p>方法1：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-type">double</span> next, sum = <span class="hljs-number">0</span>;<br><span class="hljs-type">int</span> count = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">while</span> (inStream &gt;&gt; next)<br>&#123;<br>    sum += next;<br>    count++;<br>&#125;<br></code></pre></td></tr></table></figure><p>方法2：<br>eof成员函数。</p><h4 id="预定义字符函数"><a href="#预定义字符函数" class="headerlink" title="预定义字符函数"></a>预定义字符函数</h4><p>略</p><h2 id="第7章-数组"><a href="#第7章-数组" class="headerlink" title="第7章 数组"></a>第7章 数组</h2><h3 id="C-11基于范围的for语句"><a href="#C-11基于范围的for语句" class="headerlink" title="C++11基于范围的for语句"></a>C++11基于范围的for语句</h3><p>C++11中一种新的for循环，用于快速遍历数组元素。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-type">int</span> arr[]=&#123;<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>&#125;;<br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span> i : arr)<br>    cout&lt;&lt;i;<br></code></pre></td></tr></table></figure><p>甚至可以这样</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-type">int</span> arr[]=&#123;<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>&#125;;<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span>&amp; i : arr)<br>    i++;<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i : arr)<br>    cout&lt;&lt;i;<br></code></pre></td></tr></table></figure><h3 id="整个数组作为函数参数"><a href="#整个数组作为函数参数" class="headerlink" title="整个数组作为函数参数"></a>整个数组作为函数参数</h3><p>和传引用参数用法差不多。<br><strong>为了防止不经意间的修改，一般使用const修饰。</strong></p><h2 id="第8章-字符串和向量"><a href="#第8章-字符串和向量" class="headerlink" title="第8章 字符串和向量"></a>第8章 字符串和向量</h2><h3 id="预定义C字符串函数"><a href="#预定义C字符串函数" class="headerlink" title="预定义C字符串函数"></a>预定义C字符串函数</h3><table><thead><tr><th>函数</th><th>说明</th><th>提示</th></tr></thead><tbody><tr><td>strcpy(Target_string,Src_string)</td><td>将Src_string中的值复制到Target_string中</td><td>不检查Target_string中最大可存储的容量</td></tr><tr><td>strcat(Target_string,Src_string)</td><td>将Src_string中的值连接到Target_string末尾</td><td>不检查Target_string中最大可存储的容量</td></tr><tr><td>strlen(Src_string)</td><td>返回Src_string长度的整数（空字符’\0’不计算在内）</td><td></td></tr><tr><td>strcmp(String_1, String_2)</td><td>如果两个字符串相等，就返回0</td><td>如果相等，会返回0，它会转换成false。注意这可能与你想象的相反。</td></tr></tbody></table><p>如果需要检查Target_string中最大可存储的容量，可以使用例如strcpy_s，后面带_s的函数。</p><h3 id="标准string类"><a href="#标准string类" class="headerlink" title="标准string类"></a>标准string类</h3><h4 id="getline成员函数"><a href="#getline成员函数" class="headerlink" title="getline成员函数"></a>getline成员函数</h4><p>有两个版本</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function">istream&amp; <span class="hljs-title">getline</span><span class="hljs-params">(istream&amp; ins, string&amp; strVar, <span class="hljs-type">char</span> delimiter)</span></span>;<br><span class="hljs-function">istream&amp; <span class="hljs-title">getline</span><span class="hljs-params">(istream&amp; ins, string&amp; strVar)</span></span>;<br></code></pre></td></tr></table></figure><p>第一个版本允许你自定义定界符，第二个版本默认定界符为’\n’</p><p><strong>注意，混用cin和getline的时候需要注意，cin会把’\n’给getline，导致getline读到空字符串。</strong></p><h4 id="成员函数"><a href="#成员函数" class="headerlink" title="成员函数"></a>成员函数</h4><table><thead><tr><th>示例</th><th>说明</th></tr></thead><tbody><tr><td><strong>元素访问</strong><br>str[i]<br>str.at(i)<br><br>str.substr(position, length)<br>str,length()</td><td><br>返回对索引i处的引用，不检查非法索引<br>和上面一样，但是这个版本会检查非法索引<br>返回调用对象的一个子字符串，从position开始，含有length个字符<br>返回长度</td></tr><tr><td><strong>赋值&#x2F;修改</strong><br>str.empty()<br>str.insert(pos, str2)<br>str.erase(pos, length)</td><td><br>如果str为空字符串，就返回true，否则返回false<br>在str的pos处插入str2<br>删除长度为length的子字符串，从pos处开始</td></tr><tr><td><strong>查找</strong><br>str.find(str1)<br><br>str.find(str1, pos)<br>str.find_first_of(str1, pos)<br>str.find_first_not_of(str1, pos)</td><td><br>返回str1在str中首次出现的索引。如果str1没找到，返回特殊值string::npos<br>返回str1在str中首次出现的索引，从pos出开始查找<br>返回str1的任何字符在str中首次出现的索引，从pos处开始查找<br>返回不属于str1的任何字符在str中首次出现的索引，从pos处开始查找</td></tr></tbody></table><h4 id="小细节"><a href="#小细节" class="headerlink" title="小细节"></a>小细节</h4><p>赋值操作不适应于C字符串，所以下面这个看似合法的语句其实是非法的。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c++">aCString = stringVariable.<span class="hljs-built_in">c_str</span>();  <span class="hljs-comment">//非法</span><br></code></pre></td></tr></table></figure><h4 id="字符串转换"><a href="#字符串转换" class="headerlink" title="字符串转换"></a>字符串转换</h4><p>C++11下的函数（C++11前滚）<br>转化到数字<br>stof(不会吧还有人用float),stod,stoi,stol<br>各种奇怪的类型转换为字符串<br>to_string</p><h3 id="向量"><a href="#向量" class="headerlink" title="向量"></a>向量</h3><p>最喜欢的功能之一，必须拥有名字，安排上。<br><em>可以自动扩充还一下子就知道长度的高级数组谁不喜欢呢</em></p><h2 id="第9章-指针和动态数组"><a href="#第9章-指针和动态数组" class="headerlink" title="第9章 指针和动态数组"></a>第9章 指针和动态数组</h2><h3 id="基本内存管理"><a href="#基本内存管理" class="headerlink" title="基本内存管理"></a>基本内存管理</h3><p>new完了记得要delete。<br>另外delete之后的虚悬指针记得要指向nullptr。</p>]]></content>
      
      
      <categories>
          
          <category> 学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
            <tag> 学习笔记 </tag>
            
            <tag> 编程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>jsdelivrCDN使用方法</title>
      <link href="/blog/jsdelivr-cdn/"/>
      <url>/blog/jsdelivr-cdn/</url>
      
        <content type="html"><![CDATA[<p>博客上用了很多js和css，如果都通过服务器加载，加载速度会很慢（一开始我用这个主题，GithubPages托管的时候，第一次加载用来40s+）。所以需要把js和css文件放到CDN上。<br>我知道的公共CDN有<a href="https://www.bootcdn.cn/">BootCDN</a>和<a href="https://www.jsdelivr.com/">JSDELIVR</a>。<br>jsdelivr可以直接加载github上的文件，bootcdn不行。<br>我原来使用的是BootCDN，但是这玩意比jsdelivr慢，并且只能用官方的库，所以改用了jsdelivr。</p><h2 id="jsdelivr的加载方法"><a href="#jsdelivr的加载方法" class="headerlink" title="jsdelivr的加载方法"></a>jsdelivr的加载方法</h2><h3 id="Github"><a href="#Github" class="headerlink" title="Github"></a>Github</h3><p><strong>一言蔽之，就是<code>https://cdn.jsdelivr.net/gh/用户名称/仓库名称@版本号/目录</code>。</strong></p><p>详细版：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-comment">// 加载任何GitHub的发布、提交或分支</span><br><span class="hljs-comment">// 注意:我们建议在支持npm的项目中使用npm</span><br>https<span class="hljs-punctuation">:</span><span class="hljs-comment">//cdn.jsdelivr.net/gh/user/repo@version/file</span><br><br><span class="hljs-comment">// 加载 jQuery v3.2.1</span><br>https<span class="hljs-punctuation">:</span><span class="hljs-comment">//cdn.jsdelivr.net/gh/jquery/jquery@3.2.1/dist/jquery.min.js</span><br><br><span class="hljs-comment">// 使用一个版本范围而不是特定的版本</span><br>https<span class="hljs-punctuation">:</span><span class="hljs-comment">//cdn.jsdelivr.net/gh/jquery/jquery@3.2/dist/jquery.min.js</span><br>https<span class="hljs-punctuation">:</span><span class="hljs-comment">//cdn.jsdelivr.net/gh/jquery/jquery@3/dist/jquery.min.js</span><br><br><span class="hljs-comment">// 完全省略版本以获得最新的版本</span><br><span class="hljs-comment">// 你不应该在生产中使用它</span><br>https<span class="hljs-punctuation">:</span><span class="hljs-comment">//cdn.jsdelivr.net/gh/jquery/jquery/dist/jquery.min.js</span><br><br><span class="hljs-comment">// 添加 &quot;.min&quot; 到任何js/css文件</span><br><span class="hljs-comment">// 如果它不存在，我们将为您生成它（并帮你压缩</span><br>https<span class="hljs-punctuation">:</span><span class="hljs-comment">//cdn.jsdelivr.net/gh/jquery/jquery@3.2.1/src/core.min.js</span><br><br><span class="hljs-comment">// 在末尾添加 &quot;/&quot; 以获得目录列表</span><br>https<span class="hljs-punctuation">:</span><span class="hljs-comment">//cdn.jsdelivr.net/gh/jquery/jquery/</span><br></code></pre></td></tr></table></figure><h3 id="npm"><a href="#npm" class="headerlink" title="npm"></a>npm</h3><p>gh换成npm，没有用户名。其他不变。</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs json">https<span class="hljs-punctuation">:</span><span class="hljs-comment">//cdn.jsdelivr.net/npm/包名@版本号/目录</span><br></code></pre></td></tr></table></figure><h2 id="刷新CDN"><a href="#刷新CDN" class="headerlink" title="刷新CDN"></a>刷新CDN</h2><p>把链接中的<code>https://cdn.jsdelivr.net/</code>换成<code>https://purge.jsdelivr.net/</code>就行了。</p>]]></content>
      
      
      <categories>
          
          <category> blog </category>
          
      </categories>
      
      
        <tags>
            
            <tag> jsdelivr </tag>
            
            <tag> 优化 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cron表达式结构</title>
      <link href="/blog/cron-expressions/"/>
      <url>/blog/cron-expressions/</url>
      
        <content type="html"><![CDATA[<blockquote><p>工具型软件cron是一款类Unix的操作系统下的基于时间的任务管理系统。用户们可以通过cron在固定时间、日期、间隔下，运行定期任务（可以是命令和脚本）。cron常用于运维和管理，但也可用于其他地方，如：定期下载文件和邮件。cron该词来源于希腊语chronos（χρόνος），原意是时间。</p></blockquote><h2 id="cron表达式结构"><a href="#cron表达式结构" class="headerlink" title="cron表达式结构"></a>cron表达式结构</h2><h3 id="一般形式"><a href="#一般形式" class="headerlink" title="一般形式"></a>一般形式</h3><table><thead><tr><th>&#x2F;</th><th>第一位</th><th>第二位</th><th>第三位</th><th>第四位</th><th>第五位</th></tr></thead><tbody><tr><td>内容</td><td>分钟</td><td>小时</td><td>日</td><td>月</td><td>星期</td></tr><tr><td>取值范围</td><td>0-59</td><td>0-23</td><td>1-31</td><td>1-12</td><td>0-6（周日为0）（如果不确定填?)</td></tr><tr><td>月也可以写成JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC。</td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>星期也可以写成SUN,MON,TUE,WED,THU,FRI,SAT。</td><td></td><td></td><td></td><td></td><td></td></tr><tr><td><strong>注意，范围必须为int整数。</strong></td><td></td><td></td><td></td><td></td><td></td></tr></tbody></table><h3 id="特殊形式"><a href="#特殊形式" class="headerlink" title="特殊形式"></a>特殊形式</h3><p>有一些地方会用到，<strong>比起一般形式没有秒和年，其余一样</strong></p><p>&#x2F; | 第一位 | 第二位 | 第三位 | 第四位 | 第五位<br>—|—|—|—|—|–|–|–<br>内容 | 分钟 | 小时 | 日 | 月 | 星期<br>取值范围|0-59|0-23|1-31|1-12|0-6（周日为0）（如果不确定填?)|1970-2099</p><h2 id="通配符"><a href="#通配符" class="headerlink" title="通配符"></a>通配符</h2><p>cron表达式结构所有值，所有形式一般均支持通配符。</p><table><thead><tr><th>&#x2F;</th><th>含义</th></tr></thead><tbody><tr><td>*</td><td>任何。例如填在月份里，就是每个月的意思</td></tr><tr><td>&#x2F;</td><td>整除，第一个值表开始的时间，第二个是除数。例如在秒里填上<code>1-20</code>，1，21，41，1，21，41这样轮下去。</td></tr><tr><td>-</td><td>周期，第一个值表开始，第二个结束。例如在月份里填上<code>1-4</code>，就是1，2，3，4这四个月。</td></tr><tr><td>,</td><td>列举。例如在月份里填上<code>4,6,7,8</code>，就是4，6，7，8这四个月。</td></tr></tbody></table><h2 id="在线Cron表达式解释生成"><a href="#在线Cron表达式解释生成" class="headerlink" title="在线Cron表达式解释生成"></a>在线Cron表达式解释生成</h2><p><a href="https://cron.qqe2.com/">https://cron.qqe2.com/</a></p>]]></content>
      
      
      <categories>
          
          <category> 学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> cron </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>美化Windows Terminal</title>
      <link href="/blog/beautify-windows-terminal/"/>
      <url>/blog/beautify-windows-terminal/</url>
      
        <content type="html"><![CDATA[<p><img src="https://cdn.jsdelivr.net/gh/Tokisaki-Galaxy/res/post/beautify-windows-terminal/1.webp" alt="最后的效果"></p><h2 id="安装Windows-Terminal"><a href="#安装Windows-Terminal" class="headerlink" title="安装Windows Terminal"></a>安装Windows Terminal</h2><p>有两种下载方法，去<a href="https://github.com/microsoft/terminal/releases">Github</a>或者Windows Store。<br>建议去Windows Store下，可以自动更新。</p><h3 id="更新Windows-Powershell"><a href="#更新Windows-Powershell" class="headerlink" title="更新Windows Powershell"></a>更新Windows Powershell</h3><p><strong>这一步是可选的</strong><br>Windows自带的是万年不变的5.0，可以更新到新的版本，目前为止，最新的LTS长期支持是7.0.5版本。<br><a href="https://aka.ms/PSWindows">更新方法</a></p><h2 id="更改Windows-Terminal配色方案"><a href="#更改Windows-Terminal配色方案" class="headerlink" title="更改Windows Terminal配色方案"></a>更改Windows Terminal配色方案</h2><p><a href="https://docs.microsoft.com/zh-cn/windows/terminal/customize-settings/color-schemes">https://docs.microsoft.com/zh-cn/windows/terminal/customize-settings/color-schemes</a></p><h2 id="设置脚本运行权限"><a href="#设置脚本运行权限" class="headerlink" title="设置脚本运行权限"></a>设置脚本运行权限</h2><p>默认是禁止所有脚本运行，可以通过<code>Get-ExecutionPolicy</code>来查看当前脚本运行策略，然后通过<code>Set-ExecutionPolicy</code>来设置新的策略。<br>可选的策略</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs json">Restricted——默认的设置， 不允许任何script运行<br>AllSigned——只能运行经过数字证书签名的script<br>RemoteSigned——运行本地的script不需要数字签名，但是运行从网络上下载的script就必须要有数字签名<br>Unrestricted——允许所有的script运行<br></code></pre></td></tr></table></figure><p>可以输入<code>Set-ExecutionPolicy all</code>来使用<code>AllSigned</code>策略，即允许只输入前面几个字符。</p><p>为了之后的美化设置，我们需要设置为<code>RemoteSigned</code>。<br>输入<code>Set-ExecutionPolicy remote</code>即可。</p><h2 id="安装美化模块"><a href="#安装美化模块" class="headerlink" title="安装美化模块"></a>安装美化模块</h2><h3 id="安装模块命令语法"><a href="#安装模块命令语法" class="headerlink" title="安装模块命令语法"></a>安装模块命令语法</h3><p>Powershell下安装模块的命令<br><code>Install-Module [moudel name]</code><br><code>Install-Module [moudel name] -Scope CurrentUser  #只为当前用户安装</code></p><h2 id="安装模块"><a href="#安装模块" class="headerlink" title="安装模块"></a>安装模块</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">Install-Module posh-git<br>Install-Module oh-my-posh<br>Install-Module DirColors  #让 ls (Get-ChildItem) 像 Unix 系终端一样具有多彩色<br></code></pre></td></tr></table></figure><h2 id="加载模块与设置主题"><a href="#加载模块与设置主题" class="headerlink" title="加载模块与设置主题"></a>加载模块与设置主题</h2><p><strong>注意，加载主题的命令是<code>Set-PoshPrompt -Theme powerline</code>，而不是<code>Set-Theme powerline</code>！！！</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">Import-Module DirColors<br>Import-Module posh-git<br>Import-Module oh-my-posh<br>Set-PoshPrompt -Theme powerline<br></code></pre></td></tr></table></figure><p><a href="https://ohmyposh.dev/docs/">这里是oh-my-posh的链接</a>，放在这里给有可能需要的人用。<br>这时已经可以看到美化后的终端了，但是关闭后就会重置之前的设置，所以需要把刚才这几段命令放到每次打开终端自动加载的脚本里。</p><h2 id="保存设置"><a href="#保存设置" class="headerlink" title="保存设置"></a>保存设置</h2><h3 id="为你一个用户保存"><a href="#为你一个用户保存" class="headerlink" title="为你一个用户保存"></a>为你一个用户保存</h3><p>输入<code>$PROFILE</code>，然后它会显示你个人用户每次打开终端自动运行的脚本，然后用notepad编辑那个文件，把下面这一段添加进去。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">Import-Module DirColors<br>Import-Module posh-git<br>Import-Module oh-my-posh<br>Set-PoshPrompt -Theme powerline<br></code></pre></td></tr></table></figure><h3 id="为这台电脑上所有用户保存"><a href="#为这台电脑上所有用户保存" class="headerlink" title="为这台电脑上所有用户保存"></a>为这台电脑上所有用户保存</h3><p>一样的操作，只不过要修改的文件在<code>&quot;%windir%\system32\WindowsPowerShell\v1.0\Microsoft.PowerShell_profile.ps1&quot;</code>。</p><h2 id="乱码的解决方法"><a href="#乱码的解决方法" class="headerlink" title="乱码的解决方法"></a>乱码的解决方法</h2><p>乱码是因为oh-my-posh使用了图标，但是你的字体里又没有包含图标，所以需要换一个新的，带图标的字体。<br><a href="https://www.nerdfonts.com/">Nerd字体下载地址</a><br>我自用的是Nerd里面的<a href="https://github.com/ryanoasis/nerd-fonts/releases/download/v2.1.0/CascadiaCode.zip">Cascadia Cove Nerd Font</a>，感觉挺舒服的。<br>下载完之后安装到电脑，然后在Windows Terminal设置里面使用该字体就好了。</p><h2 id="自用的设置文件-只是颜色的那一部分"><a href="#自用的设置文件-只是颜色的那一部分" class="headerlink" title="自用的设置文件(只是颜色的那一部分)"></a>自用的设置文件(只是颜色的那一部分)</h2><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-attr">&quot;profiles&quot;</span><span class="hljs-punctuation">:</span><br>    <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;defaults&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-comment">// Put settings here that you want to apply to all profiles.</span><br>        <span class="hljs-attr">&quot;acrylicOpacity&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0.6</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">//背景透明度(0-1)</span><br>        <span class="hljs-attr">&quot;useAcrylic&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// 启用毛玻璃</span><br>        <span class="hljs-attr">&quot;backgroundImage&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;C:\\Users\\Tokisaki_Galaxy\\OneDrive\\图片\\SCP.jpg&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">//背景图片</span><br>        <span class="hljs-attr">&quot;backgroundImageOpacity&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0.1</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">//图片透明度（0-1）</span><br>        <span class="hljs-attr">&quot;experimental.retroTerminalEffect&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span> <span class="hljs-comment">//复古的CRT 效果</span><br>        <span class="hljs-attr">&quot;backgroundImageStretchMode&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;uniformToFill&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">//填充模式</span><br>        <span class="hljs-attr">&quot;fontFace&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;CaskaydiaCove Nerd Font&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">//字体名称</span><br>        <span class="hljs-attr">&quot;fontSize&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">12</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">//文字大小</span><br>        <span class="hljs-attr">&quot;fontWeight&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;normal&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">//文字宽度，可设置加粗</span><br>        <span class="hljs-attr">&quot;colorScheme&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Solarized Light&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">//主题名字</span><br>        <span class="hljs-attr">&quot;cursorColor&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;#FFFFFF&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">//光标颜色</span><br>        <span class="hljs-attr">&quot;cursorShape&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;bar&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">//光标形状</span><br>        <span class="hljs-attr">&quot;antialiasingMode&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;cleartype&quot;</span> <span class="hljs-comment">//ClearType</span><br>      <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 软件安装与配置 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 美化 </tag>
            
            <tag> Windows Terminal </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NTFS文件系统修复经历</title>
      <link href="/blog/ntfs-file-system/"/>
      <url>/blog/ntfs-file-system/</url>
      
        <content type="html"><![CDATA[<p>玩office e5订阅里的5TOnedrive空间时候，发现有个文件死活删不掉。<br>然后我手贱的尝试命令行，粉碎机，发现均没用的时候就祭出了dg。（我有Bitlocker，所以不想用PE）<br>发现dg用来依然没用，并且文件越来越多了，还出现各种乱码文件。<br>马上警觉.jpg。chkdsk&#x2F;f走起，是否在下一次重启检查文件系统，是。<br>结果重启直接NTFS_FILE_SYSTEM蓝屏。发现dg直接把我NTFS文件系统搞炸了。。。<br>然后只好进PE里用chkdsk。<br>结语：没事别用dg。。。</p>]]></content>
      
      
      <categories>
          
          <category> 技术分享 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> NTFS </tag>
            
            <tag> 文件系统 </tag>
            
            <tag> OneDrive </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【碧蓝航线】Azur Lane Crosswave 解包指南+探索历程</title>
      <link href="/blog/unload-azur-lane-crosswave/"/>
      <url>/blog/unload-azur-lane-crosswave/</url>
      
        <content type="html"><![CDATA[<blockquote><p>本文转载自<a href="https://sxjeru.wordpress.com/2020/04/17/%e3%80%90%e7%a2%a7%e8%93%9d%e8%88%aa%e7%ba%bf%e3%80%91azur-lane-crosswave-%e8%a7%a3%e5%8c%85%e6%8c%87%e5%8d%97%e6%8e%a2%e7%b4%a2%e5%8e%86%e7%a8%8b/">ERU博客</a></p></blockquote><blockquote><p><a href="https://github.com/Tokisaki-Galaxy/Azur-Lane-Crosswave-Res-Extractor-Tools">工具，船名对照表</a><br><strong>前排注意：任何解包行为需把握资源用途，为尊重作品著作权，请勿用于商业行为或大范围传播！</strong></p></blockquote><p><strong>此处仅提供教程与经验，无资源。</strong></p><p>本人共计探索了超过4天，终于摸透了包里的数据。目前除了3D模型还未测试（已可提取），其余资源都可成功提取。</p><p>大体流程（目录）：</p><p>PAK数据包解包<br>虚幻4资源文件提取（CG get~）<br>Spine动画提取*<br>3D模型构建*（暂无，有生之年更新）</p><p>探索历程的无关文字会被折叠，请只看教程的读者放心食用。</p><p>文中用到的工具会给出官网与网盘地址，本人希望诸位能支持官方下载。网盘文件可能无法做到及时更新，敬请谅解。</p><h2 id="一、裂解PAK"><a href="#一、裂解PAK" class="headerlink" title="一、裂解PAK"></a>一、裂解PAK</h2><p>或许是幸运，或许是“自知之明”，总之地雷社没有给ALC的数据包加密，这也使得解包变得异常简单。这一步并没有坑，因而也就没有探索文字啦。</p><p>准备解包工具QuickBMS（<a href="https://aluigi.altervista.org/quickbms.htm">官网</a>、<a href="http://sxj.mcmod.cn/tutorial/quickbms.zip">网盘</a>）与UE4解包脚本（<a href="https://aluigi.altervista.org/quickbms.htm">官网同上</a>、<a href="http://sxj.mcmod.cn/tutorial/unreal_tournament_4.bms">网盘</a>）。<br><img src="https://sxjeru.files.wordpress.com/2020/04/znarqh5exmviggm.png" alt="znarqh5exmviggm"></p><p>双击“quickbms.exe”，依次选择脚本、PAK数据包（通常位于“~\Azur Lane Crosswave\Azurlane\Content\Paks”）、解包位置（资源保存至何处）。<br>等待……  Done！</p><h2 id="二、渗透UE4"><a href="#二、渗透UE4" class="headerlink" title="二、渗透UE4"></a>二、渗透UE4</h2><p>ALC采用UE4（v4.21.2.0）游戏引擎，导致所有资源文件都被“加密”成uasset、uexp等文件，如何将这些还原成原始文件是这一关的核心任务。</p><blockquote><p>吐槽<br>手贱用umodel选游戏路径时把所有解包出来的资源文件全选了，结果分析就花了半个多小时……<br>而且umodel稳定性也不太好，在我手上至少崩了30多回。另外它无法提取所有文件，这可着实坑惨我了……</p></blockquote><p>1.准备提取工具UE Viewer（官网、网盘）。</p><p>2.双击“umodel.exe”，按图中配置参数，路径自选，不建议选择根路径（Content），否则所需时间较长。我在下面列出了子目录中包含的部分资源，可参考个人需要选择相应路径。<br>最后点击“OK”，等待处理。（此时命令符窗口无显示，请耐心等待）<br><img src="https://sxjeru.files.wordpress.com/2020/04/7p0j57voq0ullllq.png" alt="7~$P0%ULLLLQ.png"><br>Battle：含有战斗场景下的各种3D模型，2D UI设计等。<br>Event：含有VN（视觉小说）界面下的各种立绘、CG。<br>Sound：含有游戏内所有的BGM、SE、Voice（配音）。<br>System：含有游戏主页面的UI设计文件。<br>World*：含有主线剧情内世界场景的资源文件，包括地图架构，2D动态Q版人物等。</p><p>4.处理完成后弹出资源选择窗口，左侧目录树找到目标后可在右侧双击感兴趣的资源来预览。建议预览较大的文件，这些文件通常是图片、模型、音乐。<br><img src="https://sxjeru.files.wordpress.com/2020/04/td7s7sro_o4hp6kok.png" alt="TD7S7SR{O_O$4HP"></p><p>5.预览完毕后可以直接在预览器的“Tools”菜单中导出，或在文件浏览窗口批量选择需导出的文件，点击下方“Export”，选好路径与图片格式（仅影响图片文件）后确认导出即可。<br><img src="https://sxjeru.files.wordpress.com/2020/04/31q40q0eth2mxcb1.png" alt="a"></p><p><strong>注：UE Viewer仅能导出部分资源文件，一些数据文件无法识别与导出。</strong></p><p><em>通常没有什么刚需的话，止步于此即可。也就只有我这么死脑筋的人会去想下面的内容了……</em></p><h2 id="三、​​啊Q版小人太可爱了还会动-i了i了-一定要把她们导出来！"><a href="#三、​​啊Q版小人太可爱了还会动-i了i了-一定要把她们导出来！" class="headerlink" title="三、​​啊Q版小人太可爱了还会动 i了i了 一定要把她们导出来！~~"></a>三、​​啊Q版小人太可爱了还会动 i了i了 一定要把她们导出来！~~</h2><p>闹着玩嘛，这节主要是来提取ALC地图场景那些Q版小人。在这个坑里花了70%的时间才爬出来，获得不少经验的同时也感谢各位提供神奇工具的开源作者。</p><p>在这节里，经验伴你同行。</p><blockquote><p>人生经验（点击查看）<br>一开始就花了半小时分析数据包文件架构，才找到路径“~\Azurlane\Content\World\Spine”。本以为是CG一样的玩意，结果用Umodel（UE Viewer）一看——Ch001.png<br><img src="https://sxjeru.files.wordpress.com/2020/04/ch001.png?w=1024" alt="aab"><br>【心脏骤停】誒呀好难受啊……与六年前拆CS1.6素材文件是一样的感觉呢。</p></blockquote><ol><li>经分析可知此类2D建模由Spine软件设计，单个建模包含json<em>1、atlas</em>1、png*1，对应解包后的路径为“~\Azurlane\Content\World\Spine”。其中“Ch001”即岛风，“Ch002”即…… 额这是谁来着？</li></ol><p><img src="https://sxjeru.files.wordpress.com/2020/04/ch002_touch.png" alt="Ch002_touch.png"></p><p>是绫波吗…？是她吧…… 誒别打我啊！</p><p>剩下52位诸位若学成的话就可以自己提取哦~ 请自行探索吧~~（按道理每艘秘书舰都有的说）</p><ol start="2"><li>准备文本编辑器（无脑推荐VS Code、Sublime Text 3，Notepad++ 因过于自由而不推荐），Spine Viewer WPF（作者：kiletw）。</li></ol><p>注：SpineViewerWPF需要.NET Framework 4.7.2与Microsoft XNA Framework Redistributable 4.0作为前置库。</p><blockquote><p>经验+1（点击查看）<br>这一步就着实不容易呐，Spine Viewer出奇的好用，虽然有点小Bug但作者很快就修复了，真得感谢他，不然可能就得买原装Spine了。（试用版无法导出图像，基础版就要69刀……）<br>悲惨的是，到最后我才找到这玩意。<br>辛运的是，你们的时间不会浪费了</p></blockquote><ol start="3"><li><p>利用第二节的方法，通过 umodel 从“~\Azur Lane Crosswave\World\Spine\Chxxx\Textures”（xxx指数字，为避免误解下面采用001，毕竟小岛风辣么可爱，拿来练手也不错~）得到Ch001.png。</p></li><li><p>神奇又关键的一步。资源管理器定位至“~\Azurlane\Content\World\Spine\Ch001”，将“Ch001.uexp”用文本编辑器打开，得到下图内容。（可能会有所卡顿）<br><img src="https://sxjeru.files.wordpress.com/2020/04/z9ykx_8ejqg4fckfxbgzl.png?w=768&h=455" alt="Z9YKX_8KFXBGZL.png"></p></li></ol><p>将分界线（一排乱码）上端的文字复制，注意顶端乱码不用，按岛风举例是从“Ch001.png”到“index: -1”，创建一个新文本文件，重命名为Ch001.atlas，将内容粘贴进去，保存。</p><p>再将分界线下端文字复制，底端乱码不用，同样以岛风为例是从“{“skeleton”:”到“”angle”:-0.05}]}}}}}”。注意编辑器显示缺陷导致的复制不全。<br><img src="https://sxjeru.files.wordpress.com/2020/04/3r_huhh4nxd40bgtn.png?w=768&h=455" alt="523N.png"></p><p>创建新文本文件，命名为Ch001.json，将内容粘贴进去，保存。</p><p>建议移至同个文件夹，便于处理。顺便吹一波QTTabBar。</p><p><img src="https://sxjeru.files.wordpress.com/2020/04/bc_erkjahts3lq0.png" alt="JAHTS3LQ0.png"></p><blockquote><p>痛苦不堪的经历（点击查看）<br>知道是Spine模型后，我苦思冥想地雷社把json藏哪了。当时用umodel找了一晚上也没找着，倒是在预览窗口发现了端倪，但问题是——根本不能导出啊！！<br><img src="https://sxjeru.files.wordpress.com/2020/04/g4luort5b4hkd26pcuu.png" alt="G4LUO5B4HPCUU.png"><br>诶呦真的火气来了。在解包文件中浏览，突然一个“Azurlane.uproject”让我眼前一亮。woc，这不就是ALC的工程文件吗！感觉胜利的曙光都要照到身上了，赶紧双击，结果报错……<br><img src="https://sxjeru.files.wordpress.com/2020/04/hpzlaa7_kp_q2cdno04.png" alt="Q2CDNO04.png"><br>凉拌，这胜利曙光刺激啊，把我眼都给亮瞎了。<br>接着网上冲浪，但几乎丧失了信心，直到有一次想复制“Ch001.uasset”文件名，不小心双击打开了它……<br><img src="https://sxjeru.files.wordpress.com/2020/04/5gatfi723o9nqeg40w3.png?w=1024" alt="5GATFI73.png"><br>？？梦寐以求的json与atlas，简直就是乱码丛中的那两颗耀眼的钻石啊！<br>顺手打开和它在一起的“Ch001.uexp”，便出现教程里这一幕。简直泪流满面……辛苦没有白费！</p></blockquote><p>接下去我会分成两种情况，<strong>5富人党（购买了Spine正式版）<strong>与</strong>6穷人党（如本人）</strong>，分别用两种颜色描述。</p><p>由于个人经济情况限制，以下步骤可能不准确，以Spine客服为准。</p><p>5-1. 发动钞能力，购买Spine！</p><p>5-2. Spine中新建项目，选择“导入数据”，导入Ch001.json。再选择“纹理解包器”，图集文件导入Ch001.atlas，确保Ch001.png在同一文件夹，选择输出文件夹后确定。</p><p>5-3. 将导出的许多单张图与Ch001.json放在一起，就能在Spine中预览到了。更多功能请自行探索，此处不再赘述。毕竟这不是教程想表达的方法。</p><p>5-4. 选择导出，各种图片视频格式任君挑选。</p><ol start="6"><li>接上第4步。双击打开“SpineViewerWPF.exe”，在“Use Version”菜单中选择“3.7.83”（注意不是最新的3.8.x）。再点击“File -&gt; Load Spine”，选择Ch001.atlas文件路径，并保证png与json在同一文件夹，能看到如下图。<br><img src="https://sxjeru.files.wordpress.com/2020/04/t6kpemfn559qp3plm.png" alt="ASG.PNG"></li></ol><p>其中左侧“Anime”可选择不同动画，一个角色通常有多种动画（如岛风有3种）。下方是播放控件与截图（相机键）还有Gif导出（摄像键）。</p><p>没错，白嫖就是那么简单~~  不过探索出这条路来并不是那么简单的……</p><p><strong>在此提醒下，导出Gif时会占用大量内存资源，请留出足够的内存，否则程序会崩溃。</strong></p><blockquote><p>现在让我们看看探索历程的艰辛——<br>一开始我用Spine 试用版，它可以导入json数据文件。然而Spine不认atlas，而“纹理解包器”功能试用版又无法使用，导致只有骨架，材质全部遗失…… 简直就是死路一条啊。<br><img src="https://sxjeru.files.wordpress.com/2020/04/u49e0tfy_dri.png" alt="ab"><br>然后就开始考虑分割图集（那张大png），网上找了近乎两天，测试了各种软件：Skeleton Viewer、Texture Packer、Sprite UV、Gdx Texture Packer、Dragon Bones Pro 等等。<br>最后找到了“splitAtlas.py”，可惜没有原出处了。不过它成功帮我分割了大图，当时怕是都感动到哭了</p><p>一言难尽，其中的辛酸没人能理解，文字完全没法描述。这几天已经处于返校倒计时，我是多么想在返校前作出一番成就呢！终于——<br><img src="https://sxjeru.files.wordpress.com/2020/04/ota55_asbp2om95gt2xu.png" alt="KP89O26YGB7SN.png"><br>热泪盈眶，终于在游戏外看到成品了！！虽然不能导出，但也足矣。<br>我并非没想过找破解版的Spine，可这设计软件太小众了，以至于根本没人破解，或许也有联网激活难破解的原因吧。<br>也尝试了替代品，Dragon Bones Pro。可这玩意有Bug，硬生生把可怜岛风的头发给整没了…… （wdnmd！！毁谁形象呢？！）受害者照片如下：<br><img src="https://sxjeru.files.wordpress.com/2020/04/e94057woete1404k5dc.png?w=1024" alt="4K5DC.png"><br>最后的最后，我看到了真正的曙光——Spine Viewer WPF！</p></blockquote><p>感谢你能看到最后，祝提取顺利。</p><p>当然如果有了解Spine Web用法的盆友，欢迎联系我，我实在是无法玩明白这东西。这是我搭建的测试网址：<a href="http://sxj.mcmod.cn/123.html">http://sxj.mcmod.cn/123.html</a><br>不知道为什么就是不显示……</p><p>插一句，岛风这憨憨，我要定了，都礼貌点儿，别抢。</p><p>最后有个<a href="https://www.bilibili.com/video/BV1da4y147Qq">彩蛋</a>~ 虽与教程无关，但挺有趣的。</p>]]></content>
      
      
      <categories>
          
          <category> 游戏 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> azur-lane </tag>
            
            <tag> 解包 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>完全卸载联想电脑管家</title>
      <link href="/blog/how-to-uninstall-lenovo-im/"/>
      <url>/blog/how-to-uninstall-lenovo-im/</url>
      
        <content type="html"><![CDATA[<p>Lenovo管家（包括UWP）卸载之后会在系统内留下一堆Lenovo.imxxxx的进程，直接定位目录删除，windowsupdate又给下回来了。找了好久才找到卸载的方法。<br>方法1.<br>从<strong>设备管理器</strong>中展开系统设备类别。右键单击<strong>系统接口基础V2设备</strong>，然后选择<strong>卸载</strong>。</p><p>方法2.</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">c:\windows\system32\imcontroller.infinstaller.exe -uninstall<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 软件安装与配置 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Lenovo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>裸连R6</title>
      <link href="/blog/direct-connection-rain6/"/>
      <url>/blog/direct-connection-rain6/</url>
      
        <content type="html"><![CDATA[<blockquote><ul><li>本方法并不保证一定可行，只是根据我的个人实际经历编写</li><li>本方法无法完全代替加速器，只是提供一种省钱（不用加速器）的方法</li></ul></blockquote><p><strong>本方法只是提供不使用加速器连接到服务器，游玩彩六的一种方法，实际使用效果并不比加速器好。打开游戏时的连接到服务器和加载对战列表需要2,3分钟，每次对战结束都要等一分钟回到主页面</strong></p><p><em>但是不用加速器就代表省钱啊，我最喜欢不要钱的东西了</em></p><p>上个星期刚重装完系统，结果发现加速器加速之后彩六语音用不了（腾讯加速器），但是上周有VIP，又不是不能玩，所以就没管它。但是这个星期加速器到期了，只好去修复一下NAT类型碰碰运气，看看能不能裸连上去。</p><blockquote><p>话说腾讯加速器是真的恶心，加速效果堪比三流加速器，而且还整什么VIP和SVIP。。</p></blockquote><blockquote><p>插句题外话，育碧的阿三客服真的睿智，上周周日晚上跟我说什么由于恶劣行为永久封禁，然后周一发个工单，周三还不回，周三再发一个，周五才解决封禁，然后最后跟我说什么“出于技术原因，您的账号被误封了。”，害我在学校担心了一个星期。。。</p></blockquote><p>按下WIN+I打开设置，进入游戏-&gt;Xbox网络，等圈圈转完之后查看<code>Xbox Live多人游戏</code>那一栏，<code>NAT类型</code>如果是<strong>开放</strong>，请按下CTRL+W，这篇博客对你没用。</p><p>我的ISP是移动，当时是看他宽带便宜装的，结果玩游戏比同学的电信差了一大截。移动在你的入户路由外面又套了层小区（或者城区）的大型局域网，所以被人称作墙中墙~~2333~，导致游戏很难连上处在国外的服务器。</p><p>首先点击<code>Xbox Live多人游戏</code>最下面的修复，并重启电脑后重新检查<code>NAT类型</code>是否已经变为开放，如果这样就能解决，那么自然皆大欢喜。</p><h2 id="手动启用teredo"><a href="#手动启用teredo" class="headerlink" title="手动启用teredo"></a>手动启用teredo</h2><p>如果很不幸的（事实上大部分人都没法通过简单的修复按钮修复）无法修复，那需要手动启用teredo。</p><p>打开powershell或者cmd，输入</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">netsh interface Teredo set state servername=default<br>netsh interface Teredo set state type=natawareclient<br></code></pre></td></tr></table></figure><p>&#x2F;&#x2F; 网上有人说<code>natawareclient</code>比<code>enterpriseclient</code>更适合家庭使用，如果<code>natawareclient</code>不行就试试<code>enterpriseclient</code>。</p><p>重启电脑，再次查看NAT类型</p><p>我自己到这里就已经解决了，并且彩六里语音也可以使用了（惊喜）。</p>]]></content>
      
      
      <categories>
          
          <category> 游戏 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 中国移动 </tag>
            
            <tag> 游戏 </tag>
            
            <tag> 彩虹六号 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>临时关闭Hyper-V</title>
      <link href="/blog/temporarily-closed-hyperv/"/>
      <url>/blog/temporarily-closed-hyperv/</url>
      
        <content type="html"><![CDATA[<p>win10的wsl2中可以装metasploit和hackrf，对我来说实在无法拒绝（windows是最好的linux发行版！），但是wsl2需要HyperV。<br>但是我用来玩游戏的安卓模拟器却无法和hyperv兼容，在无数次尝试之后（蓝叠那个beta版也不行），还是选择用代码临时关闭开启hypver-v，需要玩游戏的时候关闭hypver-v，需要用wsl的时候开启hypver-v（真麻烦。</p><p><strong>开启</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">bcdedit /set hypervisorlaunchtype auto<br></code></pre></td></tr></table></figure><p><strong>关闭</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">bcdedit /set hypervisorlaunchtype off<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 踩坑记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> hackrf </tag>
            
            <tag> WSL </tag>
            
            <tag> metasploit </tag>
            
            <tag> hyper-v </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WSL安装metasploit</title>
      <link href="/blog/wsl-metasploit-config/"/>
      <url>/blog/wsl-metasploit-config/</url>
      
        <content type="html"><![CDATA[<p><a href="https://mirrors.tuna.tsinghua.edu.cn/help/debian/%E6%B8%85%E5%8D%8E%E7%9A%84debian%E5%9B%BD%E5%86%85%E9%95%9C%E5%83%8F">https://mirrors.tuna.tsinghua.edu.cn/help/debian/清华的debian国内镜像</a></p><h2 id="将系统语言改为中文"><a href="#将系统语言改为中文" class="headerlink" title="将系统语言改为中文"></a>将系统语言改为中文</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo dpkg-reconfigure locales<br><span class="hljs-meta prompt_">#</span><span class="language-bash">勾上zh_CN GB2312   zh_CN.GBK GBK   zh_CN.UTF-8 UTF-8</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">重启生效</span><br></code></pre></td></tr></table></figure><h2 id="安装metasploit-framework"><a href="#安装metasploit-framework" class="headerlink" title="安装metasploit-framework"></a>安装metasploit-framework</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo nano /etc/apt/sources.list<br><span class="hljs-meta prompt_">#</span><span class="language-bash">加入下面这一行</span><br>deb http://mirrors.aliyun.com/kali kali-rolling main non-free contrib<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo wget -q -O - https://archive.kali.org/archive-key.asc | sudo apt-key add<br>sudo apt update<br>sudo apt install metasploit-framework<br></code></pre></td></tr></table></figure><h2 id="连接数据库"><a href="#连接数据库" class="headerlink" title="连接数据库"></a>连接数据库</h2><p>WSL中metasploit链接数据库有点麻烦，如果按照正常操作会报下面这个错误。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">msfconsole<br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">db_status</span><br>postgresql selected,no connect<br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">msfdb init</span><br>System has not been booted with systemd as init system (PID 1). Can&#x27;t operate.<br></code></pre></td></tr></table></figure><p>原理是wsl启动的时候没systemd。</p><h3 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h3><p>启动数据库服务</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">msfdb init<br>sudo service postgresql start<br>sudo service postgresql status<br></code></pre></td></tr></table></figure><p>手动建立数据库用户，数据库</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash"></span><br><span class="language-bash"><span class="hljs-built_in">cd</span> /etc/postgresql/13/main</span><br>sudo -u postgres psql<br>alter user postgres password &#x27;root&#x27;;<br>create user msf with password &#x27;metasploit&#x27; createdb;<br>create database msf with owner=msf;<br>quit<br></code></pre></td></tr></table></figure><p>在metasploit中链接</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">msfconsole<br><span class="hljs-meta prompt_">#</span><span class="language-bash">db_connect 数据库用户名:数据库密码@数据库ip[:数据库端口]/数据库名</span><br>db_connect msf:metasploit@127.0.0.1:5958/msf<br>db_status<br></code></pre></td></tr></table></figure><p>设置自动连接</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo nano /usr/share/metasploit-framework/config/database.yml<br></code></pre></td></tr></table></figure><p>将里面username,password改成自己设置的。</p>]]></content>
      
      
      <categories>
          
          <category> 软件安装与配置 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> Windows </tag>
            
            <tag> WSL </tag>
            
            <tag> metasploit </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DnsPod，cloudflare启用DNSSEC</title>
      <link href="/blog/cloudflare-dnspod-enable-dnssec/"/>
      <url>/blog/cloudflare-dnspod-enable-dnssec/</url>
      
        <content type="html"><![CDATA[<h2 id="DNSSEC介绍"><a href="#DNSSEC介绍" class="headerlink" title="DNSSEC介绍"></a>DNSSEC介绍</h2><p>DNSSEC 可抵御伪造的 DNS 应答。受 DNSSEC 保护的区域将通过密码进行签名，以确保收到的 DNS 记录与域所有者发布的 DNS 记录相同。</p><h2 id="cloudflare开启DNSSEC"><a href="#cloudflare开启DNSSEC" class="headerlink" title="cloudflare开启DNSSEC"></a>cloudflare开启DNSSEC</h2><p>首先在cloudflare中打开dns页面</p><p><img src="https://cdn.jsdelivr.net/gh/Tokisaki-Galaxy/res/post/cloudflare-dnspod-enable-dnssec/1.webp" alt="cloudflare打开DNSSEC页面"></p><p>下滑找到DNSSEC，点击启用，并且点击右下角那个<code>DS 记录</code>展开。</p><p><img src="https://cdn.jsdelivr.net/gh/Tokisaki-Galaxy/res/post/cloudflare-dnspod-enable-dnssec/2.webp" alt="启用DNSSEC"></p><p><img src="https://cdn.jsdelivr.net/gh/Tokisaki-Galaxy/res/post/cloudflare-dnspod-enable-dnssec/3.webp" alt="展开DS记录"></p><h2 id="打开腾讯云DNSSEC功能"><a href="#打开腾讯云DNSSEC功能" class="headerlink" title="打开腾讯云DNSSEC功能"></a>打开腾讯云DNSSEC功能</h2><p><a href="https://console.cloud.tencent.com/domain">https://console.cloud.tencent.com/domain</a>，点击域名那一栏的<code>管理</code>-&gt;<code>域名安全</code>，点击下面<code>DNSSEC设置</code>右边蓝色的设置。<br><img src="https://cdn.jsdelivr.net/gh/Tokisaki-Galaxy/res/post/cloudflare-dnspod-enable-dnssec/4.webp" alt="腾讯云DNSSEC"></p><p>第一次进去会有个什么东西让你了解，点击了解就完了。然后按照下面输进去。</p><p><img src="https://cdn.jsdelivr.net/gh/Tokisaki-Galaxy/res/post/cloudflare-dnspod-enable-dnssec/5.webp" alt="dnspod启用DNSSEC"></p><h2 id="验证DNSSEC情况"><a href="#验证DNSSEC情况" class="headerlink" title="验证DNSSEC情况"></a>验证DNSSEC情况</h2><p>回到cloudflare的dns页面，已经变成了下面这一个样子。<br><img src="https://cdn.jsdelivr.net/gh/Tokisaki-Galaxy/res/post/cloudflare-dnspod-enable-dnssec/6.webp" alt="启用成功DNSSEC"></p><p>也可以使用第三方检测你的网站是否成功启用DNSSEC。<br><a href="https://dnsviz.net/d/tokisakigalaxy.xyz/dnssec/">https://dnsviz.net/d/tokisakigalaxy.xyz/dnssec/</a></p><p><img src="https://cdn.jsdelivr.net/gh/Tokisaki-Galaxy/res/post/cloudflare-dnspod-enable-dnssec/tokisakigalaxy-xyz-DNSViz.webp" alt="dnsviz中检测启用成功DNSSEC"></p>]]></content>
      
      
      <categories>
          
          <category> blog </category>
          
      </categories>
      
      
        <tags>
            
            <tag> cloudflare </tag>
            
            <tag> DNSPod </tag>
            
            <tag> DNSSEC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用hackrf伪造GPS信号</title>
      <link href="/blog/hackrf/"/>
      <url>/blog/hackrf/</url>
      
        <content type="html"><![CDATA[<p>环境：Windows 10<br><em>win10都可以，linux不会有问题的吧</em><br><strong>关于本文中的所有链接，文末有整合地址，如果你们不嫌弃慢可以去那里下载</strong></p><h2 id="伪造GPS信号原理"><a href="#伪造GPS信号原理" class="headerlink" title="伪造GPS信号原理"></a>伪造GPS信号原理</h2><p>这个没啥好说的，就是用一个更强的信号覆盖掉微弱的GPS信号。</p><h2 id="下载Hackrf-Tools"><a href="#下载Hackrf-Tools" class="headerlink" title="下载Hackrf_Tools"></a>下载Hackrf_Tools</h2><p>这个不好找，只能去Github下，然后编译。我提供的整合包里有这些文件。</p><h2 id="下载gps-sdr-sim"><a href="#下载gps-sdr-sim" class="headerlink" title="下载gps-sdr-sim"></a>下载gps-sdr-sim</h2><p><a href="https://github.com/osqzss/gps-sdr-sim">Github地址</a></p><p>建议下载Release，不用自己编译，而且windows直接用。</p><p>生成仿真信号的时候需要RINEX星历数据，Release版的gps-sdr-sim已经自带一个上古版本的星历了（2014年的），更新一下。<br><a href="ftp://cddis.gsfc.nasa.gov/pub/gps/data/daily/2020/brdc/">RINEX星历数据下载地址</a><br><strong>地址中的2020可以换成你当前年份</strong><br>拉到最下面，下载brdc2780.20n.Z，然后解压就是了。（注意要是以n结尾的星历）<br><img src="https://cdn.jsdelivr.net/gh/Tokisaki-Galaxy/res/post/hackrf/RINEX.png" alt="RINEX"></p><h2 id="生成GPS仿真数据"><a href="#生成GPS仿真数据" class="headerlink" title="生成GPS仿真数据"></a>生成GPS仿真数据</h2><p><code>./gps-sdr-sim -e brdc2780.20n -l 0,0,100 -b 8·</code><br>指定星历文件，设置经纬度，必须指定采样精度为8。<br>默认情况下只生成300秒的仿真数据，因为生成的文件太大了，怕你硬盘塞不下去2333。</p><h2 id="发射仿真数据"><a href="#发射仿真数据" class="headerlink" title="发射仿真数据"></a>发射仿真数据</h2><p><code>hackrf_transfer -t gpssim.bin -f 1575420000 -s 2600000 -a 1 -x 0</code><br>-t 指定GPS数据<br>-f 指定频率为1575420000 即民用GPS L1波段频率。<br>-s 指定采样速率2.6Msps<br>-a 开启天线增益 1&#x3D;Enable, 0&#x3D;Disable<br>-x 指定TX VGA(IF)的增益，数据范围0-47dB <strong>(为了限制影响范围，最大为47慎用，小心查水表)</strong></p><p><strong>请尽量避免使用手机进行测试，使用其他GPS终端。</strong><br>因为手机会采用多重方法进行定位，比如基站，Wifi，GPS。这类多重定位的东西不好干扰。</p><h2 id="相关链接"><a href="#相关链接" class="headerlink" title="相关链接"></a>相关链接</h2><p><a href="http://www.hackrf.net/">HackRF首页</a><br><a href="https://github.com/mossmann/hackrf">Github上的HackRF</a></p><p><a href="hackrf/hackrf.7z">本文提到的资源整合</a></p>]]></content>
      
      
      <categories>
          
          <category> 学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hackrf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Edgeless</title>
      <link href="/blog/edgeless/"/>
      <url>/blog/edgeless/</url>
      
        <content type="html"><![CDATA[<h1 id="Edgeless介绍"><a href="#Edgeless介绍" class="headerlink" title="Edgeless介绍"></a>Edgeless介绍</h1><blockquote><p>强大而优雅的PE工具<br>有活跃的社区和强大的插件，可以媲美WTG。<br>edgeless不仅仅是传统的PE，还有强大的插件扩展，甚至可以让你能在PE中运行Office<br>可扩展性高，可以自己做各种奇奇怪怪的插件</p></blockquote><h1 id="插件包"><a href="#插件包" class="headerlink" title="插件包"></a>插件包</h1><p>插件包大概是Edgeless最大的特色了！<br>在启动盘指定目录放置7z插件包即可应用插件<br>无需专用软件，支持全平台管理插件包<br>制作插件包也非常方便！</p><p>上至Photoshop2020、Office2010、WPS、Pycharm、VSCode生产力软件</p><p>下至Dism++、Diksgenius、分区精灵等PE都有的软件</p><p>什 么 都 能 装</p><p>甚至有腾讯QQ、TIM、Telegram、微信、钉钉等IM——</p><p>妈妈再也不用担心我装坏系统没法写作业听网课了！（？）</p><p>（不过貌似顺便也能用网易云听听音乐摸鱼？）</p><div class="admonition warning"><p class="admonition-title">**！！！值得注意的是每次重启会还原更改！！！**</p></div><p>启动界面、桌面图标、系统图标、鼠标指针、桌面壁纸、开始菜单样式均可实现修改</p><p><strong>无广告 无收费 无劫持——</strong></p><p>还有就是其他一些特点啦——</p><p>其他U盘管理<br>自定义启动分辨率和壁纸！<br>资源管理器缩略图！<br>内置插件包下载器！<br>关联wim&#x2F;esd<br>虚拟光驱<br>自动生成镜像快捷方式！<br>MTP、USB共享网络！（可以在学校搞事情了？）<br>支持部分msi安装包！<br>PE的OTA更新！</p><h1 id="链接"><a href="#链接" class="headerlink" title="链接"></a>链接</h1><p>Edgeless官网：<a href="https://home.edgeless.top/">https://home.edgeless.top/</a><br>Edgeless用户手册：<a href="https://www.kancloud.cn/cnotech/edgeless">https://www.kancloud.cn/cnotech/edgeless</a></p>]]></content>
      
      
      <categories>
          
          <category> 踩坑记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Edgeless </tag>
            
            <tag> PE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>c++ 操作mysql数据库</title>
      <link href="/blog/cpp-opt-mysql/"/>
      <url>/blog/cpp-opt-mysql/</url>
      
        <content type="html"><![CDATA[<h1 id="mysql5-安装"><a href="#mysql5-安装" class="headerlink" title="mysql5 安装"></a>mysql5 安装</h1><p>用<strong>管理员</strong>命令行进&#x2F;bin目录，输入<code>mysqld.exe --install&amp;&amp;net start mysql</code></p><h2 id="修改密码"><a href="#修改密码" class="headerlink" title="修改密码"></a>修改密码</h2><p>首次修改输入<code>mysqladmin -u root password &quot;new_password&quot;</code>。<br>修改旧密码输入<code>首次修改输入</code>mysqladmin -u root -p password “new_password”&#96;，然后输入原有旧密码。</p><h1 id="IDE设置"><a href="#IDE设置" class="headerlink" title="IDE设置"></a>IDE设置</h1><p>首先需要在include目录中加上<code>mysql5\include</code><br>lib目录中加上<code>mysql5\lib\opt</code><br>（可选）在链接器的链接的lib文件中，添加<code>libmysql.lib</code>。<br><strong>如果你找不到怎么添加libmysql.lib，可以跳过这一步</strong></p><h1 id="使用C-代码链接并操作数据库"><a href="#使用C-代码链接并操作数据库" class="headerlink" title="使用C++代码链接并操作数据库"></a>使用C++代码链接并操作数据库</h1><h2 id="需要的头文件"><a href="#需要的头文件" class="headerlink" title="需要的头文件"></a>需要的头文件</h2><p>首先需要包含以下头文件</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;winsock2.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;mysql.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">pragma</span> comment(lib,<span class="hljs-string">&quot;libmysql.lib&quot;</span>) <span class="hljs-comment">//如果你在IDE中设置了加入libmysql.lib,就可以不需要这一行，但是你加上去也没事</span></span><br></code></pre></td></tr></table></figure><h2 id="链接数据库"><a href="#链接数据库" class="headerlink" title="链接数据库"></a>链接数据库</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs cpp">MYSQL mysqlconn;<br><span class="hljs-built_in">mysql_init</span>(&amp;mysqlconn);<br><span class="hljs-type">char</span> * host=<span class="hljs-string">&quot;127.0.0.1&quot;</span>;        <span class="hljs-comment">//服务器地址</span><br><span class="hljs-type">int</span> port=<span class="hljs-number">3306</span>;                  <span class="hljs-comment">//端口</span><br><span class="hljs-type">char</span> * username=<span class="hljs-string">&quot;root&quot;</span>;         <span class="hljs-comment">//用户名</span><br><span class="hljs-type">char</span> * password=<span class="hljs-string">&quot;1234567890&quot;</span>;   <span class="hljs-comment">//密码</span><br><span class="hljs-type">char</span> * dbname=<span class="hljs-string">&quot;virus&quot;</span>;          <span class="hljs-comment">//数据库名</span><br><br>(<span class="hljs-built_in">mysql_real_connect</span>(&amp;mysqlconn,host,username,password,dbname,port,<span class="hljs-literal">NULL</span>,CLIENT_FOUND_ROWS) != <span class="hljs-literal">NULL</span>)?cout&lt;&lt;<span class="hljs-string">&quot;success&quot;</span>&lt;&lt;endl:cout&lt;&lt;<span class="hljs-string">&quot;fail&quot;</span>&lt;&lt;endl;<br><br><span class="hljs-built_in">mysql_query</span>(&amp;mysqlconn,<span class="hljs-string">&quot;set names gbk&quot;</span>);    <span class="hljs-comment">//链接完之后设置编码为GBK</span><br></code></pre></td></tr></table></figure><h2 id="读取数据库数据"><a href="#读取数据库数据" class="headerlink" title="读取数据库数据"></a>读取数据库数据</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">getdata</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    MYSQL_RES *     mysql_res;<br>    MYSQL_FIELD *   mysql_field;<br>    MYSQL_ROW       mysql_row;<br>    <span class="hljs-type">char</span> * sql=<span class="hljs-string">&quot;select * from virus_data where city_deadCount&gt;50&quot;</span>;<br><br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">mysql_query</span>(&amp;mysqlconn,sql)==<span class="hljs-number">0</span>)<br>    &#123;<br>        cout&lt;&lt;<span class="hljs-string">&quot;get data success&quot;</span>&lt;&lt;endl;<br>        mysql_res=<span class="hljs-built_in">mysql_store_result</span>(&amp;mysqlconn);<br>        <span class="hljs-keyword">if</span>(mysql_res)<br>        &#123;<br>            <span class="hljs-type">int</span> fiendcount=<span class="hljs-built_in">mysql_num_fields</span>(mysql_res);<br>            <span class="hljs-type">int</span> rowcount=<span class="hljs-built_in">mysql_num_rows</span>(mysql_res);<br>            cout&lt;&lt;fiendcount&lt;&lt;endl;<br>            cout&lt;&lt;rowcount&lt;&lt;endl;<br><br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;fiendcount;i++)<br>            &#123;<br>                mysql_field=<span class="hljs-built_in">mysql_fetch_field</span>(mysql_res);<br>                cout&lt;&lt;mysql_field-&gt;name&lt;&lt;<span class="hljs-string">&quot; &quot;</span>;<br>            &#125;<br>            cout&lt;&lt;endl;<br><br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;rowcount;i++)<br>            &#123;<br>                mysql_row=<span class="hljs-built_in">mysql_fetch_row</span>(mysql_res);<br>                <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> ja=<span class="hljs-number">0</span>;ja&lt;fiendcount;ja++)<br>                &#123;<br>                    cout&lt;&lt;mysql_row[ja]&lt;&lt;<span class="hljs-string">&quot; &quot;</span>;<br>                &#125;<br>                cout&lt;&lt;endl;<br>            &#125;<br>        &#125;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        cout&lt;&lt;<span class="hljs-string">&quot;get data fail&quot;</span>&lt;&lt;endl;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="修改数据库数据"><a href="#修改数据库数据" class="headerlink" title="修改数据库数据"></a>修改数据库数据</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs cpp">string sql;<br>sqla = <span class="hljs-string">&quot;update item set qty=&quot;</span> + tmp + <span class="hljs-string">&quot; where itemid=&#x27;&quot;</span> + itemid + <span class="hljs-string">&quot;&#x27;&quot;</span>;   <span class="hljs-comment">//修改</span><br>sqlb = <span class="hljs-string">&quot;delete from user where userid=&#x27;&quot;</span> + userid + <span class="hljs-string">&quot;&#x27;&quot;</span>;<span class="hljs-comment">//删除</span><br>sqlc = <span class="hljs-string">&quot;insert into datemax(date,value) values(&#x27;&quot;</span> + date + <span class="hljs-string">&quot;&#x27;,&#x27;&quot;</span> + <span class="hljs-string">&quot;1&quot;</span> + <span class="hljs-string">&quot;&#x27;);&quot;</span>;     <span class="hljs-comment">//插入</span><br><span class="hljs-built_in">mysql_query</span>(&amp;mysqlconn, sql);<br></code></pre></td></tr></table></figure><h1 id="项目实例"><a href="#项目实例" class="headerlink" title="项目实例"></a>项目实例</h1><p><a href="https://github.com/Tokisaki-Galaxy/LEARN-C">Github</a></p>]]></content>
      
      
      <categories>
          
          <category> 编程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vector 用法</title>
      <link href="/blog/cpp-vector/"/>
      <url>/blog/cpp-vector/</url>
      
        <content type="html"><![CDATA[<h1 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h1><p>在c++中，vector像是一种动态数组，可以自由更改大小，有时候也被称为容器。<br>使用vector前需要包含<code>#include &lt;vector&gt;</code>头文件</p><h1 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h1><h2 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h2><p>int是指容器的类型，abc是容器的名称。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp">vector&lt;<span class="hljs-type">int</span>&gt;abc;<br></code></pre></td></tr></table></figure><h2 id="常用内置函数"><a href="#常用内置函数" class="headerlink" title="常用内置函数"></a>常用内置函数</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">//b为向量，将b的0-2个元素赋值给向量a</span><br>a.<span class="hljs-built_in">assign</span>(b.<span class="hljs-built_in">begin</span>(),b.<span class="hljs-built_in">begin</span>()<span class="hljs-number">+3</span>);<br><span class="hljs-comment">//a含有4个值为2的元素</span><br>a.<span class="hljs-built_in">assign</span>(<span class="hljs-number">4</span>,<span class="hljs-number">2</span>);<br><span class="hljs-comment">//返回a的最后一个元素</span><br>a.<span class="hljs-built_in">back</span>();<br><span class="hljs-comment">//返回a的第一个元素</span><br>a.<span class="hljs-built_in">front</span>();<br><span class="hljs-comment">//返回a的第i元素,当且仅当a存在</span><br>a[i];<br><span class="hljs-comment">//清空a中的元素</span><br>a.<span class="hljs-built_in">clear</span>();<br><span class="hljs-comment">//判断a是否为空，空则返回true，非空则返回false</span><br>a.<span class="hljs-built_in">empty</span>();<br><span class="hljs-comment">//删除a向量的最后一个元素</span><br>a.<span class="hljs-built_in">pop_back</span>();<br><span class="hljs-comment">//删除a中第一个（从第0个算起）到第二个元素，也就是说删除的元素从a.begin()+1算起（包括它）一直到a.begin()+3（不包括它）结束</span><br>a.<span class="hljs-built_in">erase</span>(a.<span class="hljs-built_in">begin</span>()<span class="hljs-number">+1</span>,a.<span class="hljs-built_in">begin</span>()<span class="hljs-number">+3</span>);<br><span class="hljs-comment">//在a的末尾插入一个元素，其值为i</span><br>a.<span class="hljs-built_in">push_back</span>(i);<br><span class="hljs-comment">//在a的第一个元素（从第0个算起）位置插入数值5,</span><br>a.<span class="hljs-built_in">insert</span>(a.<span class="hljs-built_in">begin</span>()<span class="hljs-number">+1</span>,<span class="hljs-number">5</span>);<br><span class="hljs-comment">//在a的第一个元素（从第0个算起）位置插入3个数，其值都为5</span><br>a.<span class="hljs-built_in">insert</span>(a.<span class="hljs-built_in">begin</span>()<span class="hljs-number">+1</span>,<span class="hljs-number">3</span>,<span class="hljs-number">5</span>);<br><span class="hljs-comment">//b为数组，在a的第一个元素（从第0个元素算起）的位置插入b的第三个元素到第5个元素（不包括b+6）</span><br>a.<span class="hljs-built_in">insert</span>(a.<span class="hljs-built_in">begin</span>()<span class="hljs-number">+1</span>,b<span class="hljs-number">+3</span>,b<span class="hljs-number">+6</span>);<br><span class="hljs-comment">//返回a中元素的个数</span><br>a.<span class="hljs-built_in">size</span>();<br><span class="hljs-comment">//返回a在内存中总共可以容纳的元素个数</span><br>a.<span class="hljs-built_in">capacity</span>();<br><span class="hljs-comment">//将a的现有元素个数调整至10个，多则删，少则补，其值随机</span><br>a.<span class="hljs-built_in">resize</span>(<span class="hljs-number">10</span>);<br><span class="hljs-comment">//将a的现有元素个数调整至10个，多则删，少则补，其值为2</span><br>a.<span class="hljs-built_in">resize</span>(<span class="hljs-number">10</span>,<span class="hljs-number">2</span>);<br><span class="hljs-comment">//将a的容量扩充至100，</span><br>a.<span class="hljs-built_in">reserve</span>(<span class="hljs-number">100</span>);<br><span class="hljs-comment">//b为向量，将a中的元素和b中的元素整体交换</span><br>a.<span class="hljs-built_in">swap</span>(b);<br><span class="hljs-comment">//b为向量，向量的比较操作还有 != &gt;= &gt; &lt;= &lt;</span><br>a==b;<br></code></pre></td></tr></table></figure><h2 id="常用算法"><a href="#常用算法" class="headerlink" title="常用算法"></a>常用算法</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;algorithm&gt;</span></span><br><span class="hljs-comment">//对a中的从a.begin()（包括它）到a.end()（不包括它）的元素进行从小到大排列</span><br><span class="hljs-built_in">sort</span>(a.<span class="hljs-built_in">begin</span>(),a.<span class="hljs-built_in">end</span>());<br><span class="hljs-comment">//对a中的从a.begin()（包括它）到a.end()（不包括它）的元素倒置，但不排列，如a中元素为1,3,2,4,倒置后为4,2,3,1</span><br><span class="hljs-built_in">reverse</span>(a.<span class="hljs-built_in">begin</span>(),a.<span class="hljs-built_in">end</span>());<br> <span class="hljs-comment">//把a中的从a.begin()（包括它）到a.end()（不包括它）的元素复制到b中，从b.begin()+1的位置（包括它）开始复制，覆盖掉原有元素</span><br><span class="hljs-built_in">copy</span>(a.<span class="hljs-built_in">begin</span>(),a.<span class="hljs-built_in">end</span>(),b.<span class="hljs-built_in">begin</span>()<span class="hljs-number">+1</span>);<br><span class="hljs-comment">//在a中的从a.begin()（包括它）到a.end()（不包括它）的元素中查找10，若存在返回其在向量中的位置</span><br> <span class="hljs-built_in">find</span>(a.<span class="hljs-built_in">begin</span>(),a.<span class="hljs-built_in">end</span>(),<span class="hljs-number">10</span>);<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 编程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>strtok_s()函数用法</title>
      <link href="/blog/cpp-strtok-s/"/>
      <url>/blog/cpp-strtok-s/</url>
      
        <content type="html"><![CDATA[<blockquote><p>当您需要性能优化时，请考虑 C printf和sprintf，它们快速且易于使用。 但是，它们不能扩展或免受漏洞的攻击。 （存在安全版本，但它们会受到轻微的性能损失。 有关详细信息，请参阅printf_s、_printf_s_l、wprintf_s、_wprintf_s_l和sprintf_s、_sprintf_s_l、swprintf_s、_swprintf_s_l。<br>by MSDN，某些旧函数，包括<code>strtok()</code>似乎有一些安全性的问题，被<code>strtok_s()</code>代替，新函数新加入了一个参数，感觉新函数比以前那个更好用。使用示例如下</p></blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-type">char</span> c_string[] =<br><span class="hljs-string">&quot;1 2 3 4 5&quot;</span>;<br><span class="hljs-type">char</span> sepa[] = <span class="hljs-string">&quot; &quot;</span>;<br><span class="hljs-type">char</span> *token = <span class="hljs-literal">NULL</span>;<br><span class="hljs-type">char</span> *next_token = <span class="hljs-literal">NULL</span>;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-comment">// Establish string and get the first token:</span><br>    token = <span class="hljs-built_in">strtok_s</span>(c_string, sepa, &amp;next_token);<br><br>    <span class="hljs-comment">// While there are tokens in &quot;string1&quot; or &quot;string2&quot;</span><br>    <span class="hljs-keyword">while</span> (token != <span class="hljs-literal">NULL</span>)<br>    &#123;<br>        <span class="hljs-comment">// Get next token:</span><br>        <span class="hljs-keyword">if</span> (token != <span class="hljs-literal">NULL</span>)<br>        &#123;<br>            <span class="hljs-built_in">printf_s</span>(<span class="hljs-string">&quot; %s\n&quot;</span>, token);<br>            token = <span class="hljs-built_in">strtok_s</span>(<span class="hljs-literal">NULL</span>, sepa, &amp;next_token);<br>        &#125;<br>    &#125;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;remain:\n&quot;</span>);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d&quot;</span>, token);<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 编程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>平均数及方差计算器</title>
      <link href="/blog/cpp-project-calc-for-average/"/>
      <url>/blog/cpp-project-calc-for-average/</url>
      
        <content type="html"><![CDATA[<h2 id="Calc-for-Average"><a href="#Calc-for-Average" class="headerlink" title="Calc-for-Average"></a>Calc-for-Average</h2><p>用于计算多个数字总和，平均值，方差的MFC程序</p><h2 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h2><p>把数据输入到框里，允许小数输入，使用空格分开</p><h2 id="源码及下载"><a href="#源码及下载" class="headerlink" title="源码及下载"></a>源码及下载</h2><p>项目<a href="https://github.com/Tokisaki-Galaxy/Calc-for-Average">Github地址</a>。<br>核心代码如下</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-built_in">UpdateData</span>(TRUE);<br>string stringdata = <span class="hljs-built_in">CT2A</span>(m_input.<span class="hljs-built_in">GetBuffer</span>());<br><span class="hljs-type">char</span>* strdata=(<span class="hljs-type">char</span>*)stringdata.<span class="hljs-built_in">c_str</span>();<br><span class="hljs-type">char</span>* token, * next_token = <span class="hljs-literal">NULL</span>;<br><span class="hljs-type">char</span> seps[] = <span class="hljs-string">&quot; &quot;</span>;<br><span class="hljs-type">long</span> <span class="hljs-type">double</span> sum=<span class="hljs-number">0</span>,e=<span class="hljs-number">0</span>,s=<span class="hljs-number">0</span>;<br>vector&lt;<span class="hljs-type">long</span> <span class="hljs-type">double</span>&gt; data;<br><br>token = <span class="hljs-built_in">strtok_s</span>(strdata, seps, &amp;next_token);<br><br><span class="hljs-keyword">while</span> (token != <span class="hljs-literal">NULL</span>) &#123;<br><span class="hljs-keyword">if</span> (token != <span class="hljs-literal">NULL</span>)<br>&#123;<br>data.<span class="hljs-built_in">push_back</span>(<span class="hljs-built_in">stold</span>(token));<br>token = <span class="hljs-built_in">strtok_s</span>(<span class="hljs-literal">NULL</span>, seps, &amp;next_token);<br>&#125;<br>&#125;<br><br><span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt;= data.<span class="hljs-built_in">size</span>(); i++) <span class="hljs-comment">//求和</span><br>sum += data[i];<br>    e = sum / data.<span class="hljs-built_in">size</span>(); <span class="hljs-comment">//求平均值</span><br><br><span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt;= data.<span class="hljs-built_in">size</span>(); i++) &#123; <span class="hljs-comment">//求方差</span><br><span class="hljs-keyword">if</span> (i != data.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>)<br>s += (data[i] - e) * (data[i] - e);<br>&#125;<br>s = s / data.<span class="hljs-built_in">size</span>();<br><br>string sum_ret = <span class="hljs-built_in">to_string</span>(sum);<br>string e_ret = <span class="hljs-built_in">to_string</span>(e);<br>string s_ret = <span class="hljs-built_in">to_string</span>(s);<br><br>m_sum = sum_ret.<span class="hljs-built_in">c_str</span>();<br>m_avg = e_ret.<span class="hljs-built_in">c_str</span>();<br>m_var = s_ret.<span class="hljs-built_in">c_str</span>();<br><br><span class="hljs-built_in">UpdateData</span>(FALSE);<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 编程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
            <tag> 小型项目 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>中国移动宽带配置ipv6与IPTV</title>
      <link href="/blog/config-ipv6-and-iptv/"/>
      <url>/blog/config-ipv6-and-iptv/</url>
      
        <content type="html"><![CDATA[<h2 id="登录光猫管理页面"><a href="#登录光猫管理页面" class="headerlink" title="登录光猫管理页面"></a>登录光猫管理页面</h2><p>移动光猫的管理地址一般在192.168.1.1，普通用户名与密码光猫盒子最下面有写（不过那个账户就是看个笑话）。<br><strong>超级管理员账号：<code>CMCCAdmin</code>，密码<code>aDm8H%MdA</code>。</strong><br>超级管理员比普通用户有更大权限，更多可设置内容。<br>（弱智移动超管账户密码都设成全国统一2333）</p><h2 id="设置桥接"><a href="#设置桥接" class="headerlink" title="设置桥接"></a>设置桥接</h2><p>用超级管理员登录，点最上面绿色那里的网<br><img src="https://files.catbox.moe/wpfgis.jpg" alt="1"></p><p>点连接名称，右边那个下拉菜单点新建<br>新建一个，端口选LAN3，改为桥模式。<br>然后在物理上把网线从LAN1拔下来，插到LAN3上。<br>PS:为什么我要用LAN3，不直接改LAN1，因为如果搞砸了还能改回去。</p><h2 id="路由器设置"><a href="#路由器设置" class="headerlink" title="路由器设置"></a>路由器设置</h2><p>改为拨号，输入账号密码完事。<br><strong>如果你不知道宽带的密码（像我一样，可以用开户的手机发短信<code>CZKDMM</code>到10086，会重置一个新随机密码给你</strong></p><h2 id="IPTV"><a href="#IPTV" class="headerlink" title="IPTV"></a>IPTV</h2><p>原来移动的IPTV是用网线连在光猫上的，我想把iptv盒子换到房间里，懒得拉这么长的线，所以用无线连接。<br>登录光猫管理地址，用超管登录，还是设置桥接的那个界面，找到<code>6_OTHER_B_VID_48</code>那一栏，端口绑定应该只有LAN2被勾上了，把下面SSID1勾上，就可以用无线连接iptv了。</p>]]></content>
      
      
      <categories>
          
          <category> 踩坑记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 中国移动 </tag>
            
            <tag> IPTV </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>高中数学</title>
      <link href="/blog/project-sh-math/"/>
      <url>/blog/project-sh-math/</url>
      
        <content type="html"><![CDATA[<p>如果没有加载出来就多等等，或者刷新一下试试。SVG文件挺大的，加载比较慢。</p><h1 id="…"><a href="#…" class="headerlink" title="…"></a>…</h1><p>计划施工完成日期：2022年中</p><h1 id="部分初中"><a href="#部分初中" class="headerlink" title="部分初中"></a>部分初中</h1><h2 id="数与式"><a href="#数与式" class="headerlink" title="数与式"></a>数与式</h2><p><img src="https://tokisaki.top/blog/project-sh-math/%E6%95%B0%E4%B8%8E%E5%BC%8F-%E6%95%B0.svg" alt="数与式-数"><br><img src="https://tokisaki.top/blog/project-sh-math/%E6%95%B0%E4%B8%8E%E5%BC%8F-%E5%BC%8F.svg" alt="数与式-式"></p><h2 id="方程与不等式"><a href="#方程与不等式" class="headerlink" title="方程与不等式"></a>方程与不等式</h2><h1 id="高中一年级"><a href="#高中一年级" class="headerlink" title="高中一年级"></a>高中一年级</h1><h2 id="1-1-集合"><a href="#1-1-集合" class="headerlink" title="1.1 集合"></a>1.1 集合</h2><h1 id="计算器"><a href="#计算器" class="headerlink" title="计算器"></a>计算器</h1><script src="https://www.geogebra.org/apps/deployggb.js"></script><div id="ggb-element"></div> <script>      var ggbApp = new GGBApplet({"appName": "graphing", "width": 800, "height": 600, "showToolBar": true, "showAlgebraInput": true, "showMenuBar": true }, true);    window.addEventListener("load", function() {         ggbApp.inject('ggb-element');    });</script>]]></content>
      
      
      <categories>
          
          <category> 学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数学 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ARKNIGHT 5-1限定</title>
      <link href="/blog/arknight-w/"/>
      <url>/blog/arknight-w/</url>
      
        <content type="html"><![CDATA[<p>5-1劳动节快乐！</p><p><strong>yj天下第一！！！</strong></p><p><img src="https://s1.ax1x.com/2020/05/01/JXOnZn.png" alt="JXOnZn.png"></p><p><img src="https://s1.ax1x.com/2020/05/01/JXOKI0.png" alt="JXOKI0.png"></p><p><img src="https://s1.ax1x.com/2020/05/01/JXOlGT.png" alt="JXOlGT.png"></p>]]></content>
      
      
      <categories>
          
          <category> 游戏 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Arknight </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>搭建博客</title>
      <link href="/blog/make-blog/"/>
      <url>/blog/make-blog/</url>
      
        <content type="html"><![CDATA[<h2 id="第一部分"><a href="#第一部分" class="headerlink" title="第一部分"></a>第一部分</h2><h3 id="HEXO简介"><a href="#HEXO简介" class="headerlink" title="HEXO简介"></a>HEXO简介</h3><blockquote><p>Hexo 是一个快速、简洁且高效的博客框架。Hexo 使用 <a href="http://daringfireball.net/projects/markdown/">Markdown</a>（或其他渲染引擎）解析文章，在几秒内，即可利用靓丽的主题生成静态网页。</p></blockquote><p>原来我是用jekyll的，但是无奈支持的东西比较少，生成速度慢，所以改HEXO。</p><h4 id="1-安装HEXO"><a href="#1-安装HEXO" class="headerlink" title="1. 安装HEXO"></a>1. 安装HEXO</h4><p><a href="https://hexo.io/zh-cn/docs/index.html">HEXO中文文档</a>上都有</p><h4 id="2-新建存储库"><a href="#2-新建存储库" class="headerlink" title="2.新建存储库"></a>2.新建存储库</h4><p><strong>如果你是把整个HEXO文件夹上传！！一定要设成私有！！</strong></p><p><strong>如果你用deploy部署，那随便你设不设私有</strong></p><p> 去Github上新建一个存储库，名字随便，记得<strong>设置私有</strong>。保证只有你和vercel上的机器人看得到。</p><p>至于为什么把整个HEXO上传，原因是如果你换一台电脑不是还可以接写博客吗。</p><h4 id="3-初始化HEXO"><a href="#3-初始化HEXO" class="headerlink" title="3.初始化HEXO"></a>3.初始化HEXO</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">hexo init<br></code></pre></td></tr></table></figure><p>关联Github</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">cd hexo<br>echo &quot;# Blog&quot; &gt;&gt; README.md<br>git init<br>git add README.md<br>git commit -m &quot;first commit&quot;<br>git branch -M main<br>git remote add origin git@github.com:Tokisaki-Galaxy/blog.git   #这里的路径换成你自己的存储库地址<br>git push -u origin main<br></code></pre></td></tr></table></figure><h4 id="3-下载主题，设置submodule"><a href="#3-下载主题，设置submodule" class="headerlink" title="3.下载主题，设置submodule"></a>3.下载主题，设置submodule</h4><p>直接把模板clone下来之后后继更新非常麻烦，所以使用submodule。</p><p>推荐模板<a href="https://github.com/blinkfox/hexo-theme-matery">hexo-theme-matery</a>（当然你用别的也行）。</p><p>先在网页上fork到自己的存储库里，然后在根目录中执行<code>git submodule add https://github.com/blinkfox/hexo-theme-matery/ themes\hexo-theme-matery</code>，作为子模块clone到themes目录中的hexo-theme-matery。</p><p>接着试着用github desktop或者git进行push，如果没问题就往下看。</p><p>当然有些教程会说设置deploy，直接上传源目录和上传public目录效果完全一致，区别只是在vercel上的部署有一点点不同。但是我更喜欢这种方法。（毕竟可以直接在github上写博客嘛）</p><h4 id="4-本地预览"><a href="#4-本地预览" class="headerlink" title="4.本地预览"></a>4.本地预览</h4><p>随便打开个什么cmd或者powershell，进入上一步的那个文件夹，输入<code>hexo s</code>之后，等一会，直到你看到出现了<code>Hexo is running at http://localhost:4000</code>之后在浏览器里打开<a href="http://localhost:4000/">这个网址</a>。</p><p>看完了按Ctrl+C就可以关掉本地预览。</p><p>啊对了，第一次操作会让你安装依赖包，跟着他提示操作就行了。</p><h4 id="5-使用zeit托管"><a href="#5-使用zeit托管" class="headerlink" title="5.使用zeit托管"></a>5.使用zeit托管</h4><h5 id="为什么使用zeit托管"><a href="#为什么使用zeit托管" class="headerlink" title="为什么使用zeit托管"></a>为什么使用zeit托管</h5><ul><li><p>百度收录</p></li><li><p>免费</p><blockquote><p>Vercel is the easiest way to deploy websites. Host your web projects with zero configuration, automatic SSL, and global CDN.</p></blockquote><hr></li></ul><p>同类产品有<a href="https://app.netlify.com/">netlify</a>，其实这个也不错，我不用他是因为我不挂梯子打不开他的页面。<br>其实我原来用Github Pages，但是那玩意域名我觉得不好看（xxx.github.io），并且不能被百度爬，所以最后放弃了。<br>当然你也可以用coding对国内进行分流，来实现让百度爬你的目的，但是太麻烦了。<br><del>并且coding的服务不太稳定。</del>(2021coding更新了，我没试过，不好评论)<br>另一个是gitee，那个各方面都挺不错的，除了<strong>不支持自定义域名</strong>。。</p><h5 id="1-注册zeit"><a href="#1-注册zeit" class="headerlink" title="1.注册zeit"></a>1.<a href="https://zeit.co/login">注册zeit</a></h5><h5 id="2-导入"><a href="#2-导入" class="headerlink" title="2.导入"></a>2.导入</h5><p>  主页点击 “Import Project”，然后 “Import Project From Git Repo”，选择 GitHub。进行一下授权，然后选择你在一开始新建的存储库导入。</p><p>  注意如果你用我的方法，将整个hexo文件夹同步到云端，你会看到你的类型是HEXO，如果你用的是deploy，这里显示是other。</p><p>  最后你就可以访问一个类似于xxxx.now.sh的网址来访问你的博客了（是不是比github那个xxx.github.io好看多了？）。</p><p>  并且如果你是将整个HEXO文件夹同步到github，你会发现</p><h5 id="3-搞一个域名"><a href="#3-搞一个域名" class="headerlink" title="3.搞一个域名"></a>3.搞一个域名</h5><p>  可能有人会问，zeit给的now.sh不好吗，搞什么自己域名？当然可以啦，只不过访问速度慢死而已，有了自己的域名就可以用cloudflare加速！</p><p>  域名随便你去哪弄，可以去买腾讯云的域名，首年才1块钱得一个xyz，而且附带可以用域名邮箱。</p><p>  当然你想白嫖可以，去<a href="https://www.freenom.com/zh/index.html?lang=zh">freenom</a>注册个免费域名，然后把<strong>NS服务商改成cloudflare</strong>的就行了。</p><p>  （但是freenom上的域名<strong>好像</strong>不能注册腾讯的企业邮箱）</p><h5 id="4-注册cloudflare"><a href="#4-注册cloudflare" class="headerlink" title="4.注册cloudflare"></a>4.注册<a href="https://www.cloudflare.com/">cloudflare</a></h5><p>  刚刚说过了，now.sh在国内访问速度不（惨）太（不）好（忍）看（睹），用cloudflare可以大大提升访问速度。</p><p>  去<a href="https://www.cloudflare.com/">cloudflare</a>注册一个账户，然后按照提示一步一步操作，将NS记录（域名服务器记录）改成cloudflare为你提供的。</p><p>  <strong>之后你所有DNS更改都需要在cloudflare上操作，否则无效</strong></p><h5 id="5-增加指向vercel的记录"><a href="#5-增加指向vercel的记录" class="headerlink" title="5.增加指向vercel的记录"></a>5.增加指向vercel的记录</h5><p>  去vercel，在项目里找到”view domains”，将你想用的域名输进去（就是前缀+””.”+之前搞到的域名）</p><p>  然后按照他的提示去cloudflare增加一条CNAME。</p><p>  当然我其实想设置CNAME记录的，但是如果设置CNAME的话，总是出现一些奇奇怪怪的问题，所以只好设置成A记录。</p><p>  <img src="https://s1.ax1x.com/2020/04/22/JUuG1H.png" alt="DNS-CONFIG"></p><p>  <strong>无论如何，请一定确认时候一定要确认代理状态为黄色（已代理）</strong></p><p>  <strong>无论如何，请一定确认时候一定要确认代理状态为黄色（已代理）</strong></p><p>  <strong>无论如何，请一定确认时候一定要确认代理状态为黄色（已代理）</strong></p><h5 id="6-添加404页面"><a href="#6-添加404页面" class="headerlink" title="6.添加404页面"></a>6.添加404页面</h5><p>在根目录下面新建now.json，里面如下。</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;version&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;routes&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>    <span class="hljs-punctuation">&#123;</span> <span class="hljs-attr">&quot;handle&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;filesystem&quot;</span> <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-punctuation">&#123;</span> <span class="hljs-attr">&quot;src&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;/(.*)&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;status&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">404</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;dest&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;/404.html&quot;</span> <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">]</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><h5 id="可能会有的一些坑"><a href="#可能会有的一些坑" class="headerlink" title="可能会有的一些坑"></a>可能会有的一些坑</h5><h6 id="1-访问博客出现525错误，如下图"><a href="#1-访问博客出现525错误，如下图" class="headerlink" title="1.访问博客出现525错误，如下图"></a>1.访问博客出现525错误，如下图</h6><p>  <img src="https://i.loli.net/2020/04/22/y7upcTkeHxlNJPw.png" alt="site-error-525"></p><p>  这个问题原因我也不太清楚，但是可以通过设置cloudflare里面SSL&#x2F;TLS规则来消除</p><p>  <img src="https://s1.ax1x.com/2020/04/22/JUu2Bq.png" alt="cloudflare-ssl-config"></p><p>  如上图，先设置成关闭，然后访问你的博客直到可以正常访问，再设置成完全。</p><h2 id="第二部分"><a href="#第二部分" class="headerlink" title="第二部分"></a>第二部分</h2><p>大概就是讲博客的自定义配置，懒得写了。</p><p>等以后有空或者有人看再写吧。</p><h3 id="接入评论"><a href="#接入评论" class="headerlink" title="接入评论"></a>接入评论</h3><p>Gitalk</p><h2 id="附件"><a href="#附件" class="headerlink" title="附件"></a>附件</h2><p><code> !update.bat</code></p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs perl"><span class="hljs-variable">@echo</span> off<br>git add -A<br>git commit -m <span class="hljs-string">&quot;Updated: <span class="hljs-variable">%date</span>:~0,4<span class="hljs-variable">%/</span><span class="hljs-variable">%date</span>:~5,2<span class="hljs-variable">%/</span><span class="hljs-variable">%date</span>:~8,2% %time%&quot;</span><br>git <span class="hljs-keyword">push</span>||git <span class="hljs-keyword">push</span>||git <span class="hljs-keyword">push</span><br></code></pre></td></tr></table></figure><p><code>!preview.bat</code></p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">hexo s</span><br></code></pre></td></tr></table></figure><h2 id="第三部分"><a href="#第三部分" class="headerlink" title="第三部分"></a>第三部分</h2><p>自带的节点已经足够好了！！！几乎可以不用自定义节点了</p><p>自定义节点可能还会减速！！！</p>]]></content>
      
      
      <categories>
          
          <category> blog </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Github </tag>
            
            <tag> Hexo </tag>
            
            <tag> vercel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RPi连接GPS模块</title>
      <link href="/blog/rpi-gps/"/>
      <url>/blog/rpi-gps/</url>
      
        <content type="html"><![CDATA[<h1 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h1><p>RPi GPS Add-on V2.0模块,采用的是UART接口通信,需要先启用uart接口,否则无法收到任何数据</p><p><code>sudo raspi-config</code></p><p>5 Interfacing Options -&gt; P6 Serial 两个全部禁用(这个操作将禁用串口!)</p><p><code>sudo nano /boot/config.txt</code></p><p>拉到最下面,将<code>enable_uart=0</code>改成<code>enable_uart=1</code></p><p>再加一行<code>dtoverlay=pi3-miniuart-bt</code></p><p>重启后</p><p><code>ls /dev -la |grep serial</code></p><blockquote><p>pi@RAAZ:~ $ ls &#x2F;dev -la | grep serial</p></blockquote><blockquote><p>lrwxrwxrwx  1 root root           7 Feb 12 16:19 serial1 -&gt; ttyAMA0</p></blockquote><p>找到自己GPS模块在哪里,<strong>我这里是&#x2F;dev&#x2F;ttyAMA0,你可能需要修改</strong></p><p>然后<code>cat /dev/ttyAMA0</code></p><p>然后应该能看到一大堆数据,按<code>Ctrl+C</code>停止.</p><p><strong>没有任何输出可能是操作有误,或模块损坏</strong></p><h1 id="GPSD"><a href="#GPSD" class="headerlink" title="GPSD"></a>GPSD</h1><h2 id="安装GPSD"><a href="#安装GPSD" class="headerlink" title="安装GPSD"></a>安装GPSD</h2><p><code>sudo apt-get install gpsd gpsd-clients python-gps</code></p><h2 id="修改端口"><a href="#修改端口" class="headerlink" title="修改端口"></a>修改端口</h2><p><code>sudo nano /etc/default/gpsd</code></p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">USBAUTO</span>=<span class="hljs-string">&quot;false&quot;</span><br><span class="hljs-attr">DEVICES</span>=<span class="hljs-string">&quot;/dev/ttyAMA0&quot;</span><br><span class="hljs-attr">GPSD_OPTIONS</span>=<span class="hljs-string">&quot;-n&quot;</span><br></code></pre></td></tr></table></figure><p>按照上述改完之后,重启系统</p><blockquote><p>cgps</p></blockquote><blockquote><p>cgps is a client resembling xgps, but without the pictorial satellite display and able to run on a serial terminal or terminal emulator.</p></blockquote><blockquote><p>The -s option prevents cgps from displaying the data coming from the daemon. This display can also be toggled with the s command.</p></blockquote><blockquote><p>The -m option will display your magnetic heading (as opposed to your true heading). This is a calculated value, not a measured value, and is subject to a potential error of up to two degrees in the areas for which the calculation is valid (currently Western Europe, Alaska, and Lower 48 in the USA). The formulas used are those found in the Aviation Formulary v1.43.</p></blockquote><blockquote><p>cgps terminates when you send it a SIGHUP or SIGINT; given default terminal settings this will happen when you type Ctrl-C at it. It will also terminate on ‘q’</p></blockquote><p>输入<code>cgps -s</code></p><p><strong>!如果你用的是图形界面,不是命令行,那试试xgps!</strong></p><p>应该就可以看到结果了</p><p><strong>冷启动要等挺久的</strong></p><p><strong>如果NO FIX那一行后面的数字没有跳动,请检查&#x2F;dev&#x2F;ttyAMA0是否有输出</strong></p><p><strong>如果等很久还没定位,可能是GPS信号差</strong></p>]]></content>
      
      
      <categories>
          
          <category> 软件安装与配置 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RPi </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CMD script</title>
      <link href="/blog/cmd-script/"/>
      <url>/blog/cmd-script/</url>
      
        <content type="html"><![CDATA[<p><code>FOR /L %variable IN (start,step,end) DO command [command-parameters]</code></p><blockquote><p>该集表示以增量形式从开始到结束的一个数字序列。因此，(1,1,5)将产生序列<br>1 2 3 4 5，(5,-1,1)将产生序列(5 4 3 2 1)</p></blockquote><p>对二进制文件连接用copy &#x2F;b 1.txt+2.txt 1.txt</p><p>例如1.txt是abc,2.txt是def,运行完之后,1.txt里面内容就是abcdef</p><p><code>for /l %i in (1,1,36) do (copy /b a.ts+seg-%i-v1-a1.ts&gt;&gt; a.ts)</code></p>]]></content>
      
      
      <categories>
          
          <category> 编程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CMD </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ThrottleStop教程</title>
      <link href="/blog/throttlestop/"/>
      <url>/blog/throttlestop/</url>
      
        <content type="html"><![CDATA[<p>官网下载地址：<br><a href="https://www.techpowerup.com/download/techpowerup-throttlestop/">ThrottleStop</a></p><h2 id="ThrottleStop是什么"><a href="#ThrottleStop是什么" class="headerlink" title="ThrottleStop是什么"></a>ThrottleStop是什么</h2><p>ThrottleStop最初的设计目的是为了对付笔记本电脑中的温度墙，以及调整CPU时钟速度。</p><p>但是它不仅仅可以作为解除温度墙的工具，也可以用来给CPU打鸡血（老电脑狂喜）和给CPU放血（降频。</p><p>为什么要给CPU降频？cpu降频之后，可以让续航时间加倍。比如之前网课的时候，我这电脑不用TS续航大概两个小时，用了之后锁到1Ghz。虽然低，但是网课也够用了，续航时间能达到4-5个小时</p><h2 id="ThrottleStop配置"><a href="#ThrottleStop配置" class="headerlink" title="ThrottleStop配置"></a>ThrottleStop配置</h2><p><img src="https://s2.ax1x.com/2020/02/09/1h5Vqs.png" alt="主界面"></p><p>左上第一个红框是选择配置文件,软件默认有4个配置文件</p><ol><li>Performance</li><li>Game</li><li>Internet</li><li>Battery</li></ol><p><strong>用法就像名字一样(废话)</strong></p><hr><p>左下那个红框,<em>先介绍第一列的功能</em></p><p><strong>Clock Modulation和Chipset Clock Modulation</strong> 这两个选项对一些有点岁数的CPU 会有用，我们用不着..<br><strong>不需要勾选!</strong></p><p><strong>Set Multiplier</strong> 设置倍频，设到默认+1就行了<br><strong>不设也行</strong></p><p><strong>Speed Shift EPP</strong> <strong>非常有用!</strong><br>看到左边的数字了吗,那里是可以编辑的!(想不到吧)<br><strong>值取一个0-255的数字,越接近0 性能越高,越接近255越节能(性能越低)</strong></p><p><strong>Power Saver</strong> 需要勾选 Disable Turbo 才能使用，该选项确保待机频率最低以降低功耗，对较新的处理器来说用处不大，因为现代处理器有新技术降低待机功耗。比酷睿 2 更新的处理器不建议使用这个。<br><strong>看着办,一般不勾</strong></p><p><strong>Disable Turbo</strong> 关闭睿频。没啥可说<br><strong>现在处理器最好别勾</strong>(你基础频率才2G+)</p><p><strong>BD PROCHOT</strong> <strong>非常,非常重要和有用</strong><br>在温度达到某一值的时候降低功率,俗称温度墙,就是这东西.(默认打开)<br><strong>有需要就关上,但并不建议关</strong><br>!!!关了如果<strong>没有其他措施</strong>会导致cpu无法自动降频,直到100度<strong>强制断电</strong>!!!</p><p>Taskbar 最小化到任务栏<br><strong>给我关上!!!烦死了</strong></p><p>Log File 启用日志<br><strong>一般不勾(大佬勾)</strong></p><p>Stop&#x2F;Start Data 停止或开启右侧表格记录数据更新。</p><p>SpeedStep 也是个老古董,没必要勾,已被Shift EPP替代(除非你也是古董)<br><strong>如果没有Speed Shift EPP就勾</strong></p><p>C1E 玄学选项,默认勾选<br><strong>既然默认勾就别动了</strong></p><p>On Top 使得 ThrottleStop 置顶（不会被其他窗口遮挡）。<br><strong>调试的时候才勾</strong></p><p>More Data 加快右侧表格数据更新频率，从每秒更新 1 次加快到每秒更新 8 次。<br><strong>一般用不着</strong></p><p>Save 将当前设置存入 ini 文件。<br><strong>修改完记得按一下</strong></p><hr><p>右上红框是你CPU的数据</p><ol><li>VID是当前电压</li><li>倍数x基础频率</li><li><strong>你当前cpu频率</strong>(就是第二行的结果)</li></ol><hr><p>自己理解那个表格</p><hr><p>右下没被框的区域<br>Pkg&#x2F;Min&#x2F;Max Power 当前&#x2F;最小&#x2F;最大记录到的功率。</p><p>Limits 可以显示 Core&#x2F;GPU&#x2F;Ring 降频的原因</p><p>FIVR 和 TPL 一会用得到</p><p>BCLK 重新读取校准基频读数</p><p>C7s C-STATE</p><p>DTS&#x2F;Temp 切换温度显示方式<br><strong>DTS是距离到达CPUTJMAX的温度,TEMP是现在的温度(CPUTJMAX-DTS)</strong></p><p>CLR 清空数据</p><hr><h3 id="Options"><a href="#Options" class="headerlink" title="Options"></a>Options</h3><p><strong>打开下面 Options 按钮</strong></p><p><img src="https://s2.ax1x.com/2020/02/09/1hqlkj.png" alt="1hqlkj.png"></p><p>Profile Names 起名字</p><p>Notification Area 设置托盘处显示的信息<br><em>这里建议勾上CPU Temp</em></p><p>Alarm 设置温度警报,DTS和TEMP上面讲过了</p><p>AC profile 插电时配置</p><p>Battery profile 用电池时配置。</p><p>Low Battery% 电池剩余电量百分比</p><p>Low Battery profile 到了上面的百分比,你用哪个配置</p><p>Do Not reset FID&#x2F;VID on exit，退出不TS恢复设置<br><strong>建议勾上</strong></p><p>Battery Monitoring 在主界面上显示电池剩余电量</p><p>AC-On，Battery-Off 字面意思</p><p>Start Minimized 启动时最小化<br><strong>建议勾上</strong></p><p>Minimize on Close<br><strong>建议勾上</strong></p><p>Add Limits Reason to Log File 在日志中记录限制原因</p><p>Table Grid Lines 主界面数据表格线显示</p><p>MHz Min 数据显示最小的单位为 MHz。</p><p>Nvidia GPU&#x2F;AMD GPU 你用哪个勾哪个</p><p>Start dual IDA 老技术,不勾</p><p>DC exit time使用电池后几秒自动关闭TS</p><p>Timer Resolution计时器间隔。</p><p>AC Timer Res AC 计时器间隔。</p><p>Power Save C0% 调整 Power Saver 选项的敏感度</p><p>Force TDP&#x2F;TDC <strong>不明</strong><br>如果有人知道请评论区告诉我,谢谢</p><p>Run Program After Profile Change 指定切换为某个模式前或后所运行的第三方程序</p><p>Log Folder 日志文件路径</p><p>Hotkeys 设置各种快捷键，例如切换配置文件等</p><p>Defaults 还原默认设置</p><hr><h3 id="FIVR-最重要的部分"><a href="#FIVR-最重要的部分" class="headerlink" title="FIVR(最重要的部分)"></a>FIVR(最重要的部分)</h3><p><img src="https://s2.ax1x.com/2020/02/09/1hLqR1.png" alt="1hLqR1.png"></p><p>直接说中间那行,左边不说了.</p><p>上面FIVR CONTROL很好理解,就是指选择哪个组件,然后通过下面的XXX Voltage来调整</p><p>XXX Voltage是重点,这里为了防止你瞎改,还特意有一个”Unlock Adjustable Voltage”,必须先点了这个才能修改下面的设置</p><p><strong>注意不要碰到那个STATIC!</strong></p><p>不要碰那个Voltage</p><p>看Offset Voltage,Range是控制你调整范围,左边是降低电压,右边升高电压</p><p>IccMax <strong>不明</strong><br>如果有人知道请评论区告诉我,谢谢</p><p>右边那行,最上面的表格应该都懂</p><p>Memory那行的Disable and Lock Tur bo Power Limits,要安装另外一个东西才能用,降压用不着</p><p>Cache Radio 设置缓存的倍频范围。</p><p>PowerCut 类似于 BIOS 里修改 IMON Slope&#x2F;offset 通过虚假的功耗读数来超出某些处理器的功耗限制。</p><p>VR Faults&#x2F;VR Efficiency Mode 自己查(懒得写)(反正降压用不着)</p><p>Save Voltages Changes to ThrottleStop.INI 选项一，不保存电压设置。选项二，关闭时保存。选项三，立即保存。</p><hr><h3 id="TPL"><a href="#TPL" class="headerlink" title="TPL"></a>TPL</h3><p><img src="https://s2.ax1x.com/2020/02/09/1hvVL6.png" alt="1hvVL6.png"></p><p>Tur bo Boost Long Power Max 最大长时功率</p><p>Tur bo Boost Short Power Max 最大短时功率</p><p>Lock 是说在寄存器中锁定这两项,避免软件或系统对其进行修改,如果日后要解锁需要按照上边卸载和重置的流程来做<br>Clamp 勾选代表任何时候都遵循此设置,不勾选时仅在睿频时起效.例如 CPU 默频 3.4G，但是在 3.4G 时仍然超过所给功率限制（例如做密集 AVX 运算），勾选 Clamp 的情况会强制 CPU 继续降频直到满足功耗限制，不勾选的话则不会。</p><p>PP0 就是PL4 设置</p><hr><h3 id="C7s"><a href="#C7s" class="headerlink" title="C7s"></a>C7s</h3><p><img src="https://s2.ax1x.com/2020/02/09/1hvVL6.png" alt="1hvVL6.png"></p><p>C10 分别设置 1-4 四种配置的 C-states，C0 为最高性能状态，基本上后边的数字越大越省电，相应的恢复到 C0 需要的时间也就越长。调整这里的选项可以省电降低待机温度或者相反的提高待机温度费电以获得更高的性能。</p>]]></content>
      
      
      <categories>
          
          <category> 电脑硬件 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CPU超频 </tag>
            
            <tag> CPU降频 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CPU升(降)压教程</title>
      <link href="/blog/cpu-adjust/"/>
      <url>/blog/cpu-adjust/</url>
      
        <content type="html"><![CDATA[<blockquote><ul><li>ThrottleStop</li><li>Process Lasso</li></ul></blockquote><p>下载地址:<br><a href="https://www.techpowerup.com/download/techpowerup-throttlestop/">ThrottleStop</a><br><a href="https://dl.bitsum.com/files/processlassosetup64.exe">Process Lasso</a></p><hr><h3 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项:"></a>注意事项:</h3><p>XTU和TS不需要用在一起</p><hr><h2 id="ThrottleStop"><a href="#ThrottleStop" class="headerlink" title="ThrottleStop"></a>ThrottleStop</h2><p>下载后解压到固定位置(<strong>不要轻易更改的路径</strong>)(<em>例如”C:\Program File\ThrottleStop”</em>)</p><p>然后点开ThrottleStop.exe</p><p><img src="https://s2.ax1x.com/2020/02/09/1h5Vqs.png" alt="主界面"></p><p>左上第一个红框是选择配置文件,软件默认有4个配置文件</p><ol><li>Performance</li><li>Game</li><li>Internet</li><li>Battery</li></ol><p><strong>用法就像名字一样(废话)</strong></p><p>把你的每个选项里的Speed Shift - EPP都勾上,从左到右分别设成0&#x2F;30&#x2F;128&#x2F;255</p><hr><p>左下那个红框,<em>先介绍第一列的功能</em></p><p><strong>Clock Modulation和Chipset Clock Modulation</strong><br><strong>不需要勾选!</strong></p><p><strong>Set Multiplier</strong><br><strong>不设也行</strong></p><p><strong>Speed Shift EPP</strong> <strong>非常有用!</strong><br>看到左边的数字了吗,那里是可以编辑的!(想不到吧)<br><strong>值取一个0-255的数字,越接近0 性能越高,越接近255越节能(性能越低)</strong></p><p><strong>Power Saver</strong> 需要勾选 Disable Turbo 才能使用，该选项确保待机频率最低以降低功耗，对较新的处理器来说用处不大，因为现代处理器有新技术降低待机功耗。比酷睿 2 更新的处理器不建议使用这个。<br><strong>看着办,一般不勾</strong></p><p><strong>Disable Turbo</strong> 关闭睿频.没啥可说<br><strong>现在处理器最好别勾</strong>(你基础频率才2G+)</p><p><strong>BD PROCHOT</strong> <strong>非常,非常重要和有用</strong><br>在温度达到某一值的时候降低功率,俗称温度墙,就是这东西.(默认打开)<br><strong>有需要就关上,但并不建议关</strong><br>!!!关了如果<strong>没有其他措施</strong>会导致cpu无法自动降频,直到100度<strong>强制断电</strong>!!!</p><p>Save 将当前设置存入 ini 文件。<br><strong>修改完记得按一下</strong></p><hr><p><strong>打开下面 Options 按钮</strong></p><p><img src="https://s2.ax1x.com/2020/02/09/1hqlkj.png" alt="1hqlkj.png"></p><p>Do Not reset FID&#x2F;VID on exit，退出不TS恢复设置<br><strong>建议勾上</strong></p><p>Start Minimized 启动时最小化<br><strong>建议勾上</strong></p><p>Minimize on Close<br><strong>建议勾上</strong></p><p>Nvidia GPU&#x2F;AMD GPU 你用哪个勾哪个<br><strong>可以不勾</strong></p><hr><h3 id="FIVR-最重要的部分"><a href="#FIVR-最重要的部分" class="headerlink" title="FIVR(最重要的部分)"></a>FIVR(最重要的部分)</h3><p><img src="https://s2.ax1x.com/2020/02/09/1hLqR1.png" alt="1hLqR1.png"></p><p>直接说中间那行,左边不说了.</p><p>上面FIVR CONTROL很好理解,就是指选择哪个组件,然后通过下面的XXX Voltage来调整</p><p>XXX Voltage是重点,这里为了防止你瞎改,还特意有一个”Unlock Adjustable Voltage”,必须先点了这个才能修改下面的设置</p><p><strong>注意不要碰到那个STATIC!</strong></p><p>不要碰那个Voltage</p><p>看Offset Voltage,Range是控制你调整范围,左边是降低电压,右边升高电压</p><p>IccMax <strong>不明</strong><br>如果有人知道请评论区告诉我,谢谢</p><p><strong>这里需要你自己调出最适合你电脑的OFFSET VOLTAGE</strong><br><strong>每个CPU的质量不一样,没有统一数据</strong></p><p>Save Voltages Changes to ThrottleStop.INI 选项一，不保存电压设置。选项二，关闭时保存。选项三，立即保存。</p><hr><h3 id="设置开机自启动"><a href="#设置开机自启动" class="headerlink" title="设置开机自启动"></a>设置开机自启动</h3><p>按一下windows(或者按搜索)输入任务计划程序</p><p><img src="https://s2.ax1x.com/2020/02/09/1hxD4e.png" alt="1hxD4e.png"></p><p>任务计划程序 - 创建基本任务</p><p>设置名称 - 下一步</p><p>希望何时开始？当用户登录时</p><p>希望执行什么操作？启动程序</p><p>程序或脚本：填入ThrottleStop.exe 的完整路径</p><p>勾选“当单击完成时，打开任务属性对话框”</p><p>勾选“使用最高权限运行”</p><p>条件选项卡：取消所有的勾选项，有些灰色的勾选项可以先勾选他的上层将其取消之后再取消勾选他的上层。总之不要有任何的勾选项，灰色的也不要有。</p><p>设置选项卡：勾选允许按需运行任务。其余全部取消勾选。</p><p>确定。</p><hr><h2 id="Process-Lasso"><a href="#Process-Lasso" class="headerlink" title="Process Lasso"></a>Process Lasso</h2><p>施工中…..</p>]]></content>
      
      
      <categories>
          
          <category> 电脑硬件 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CPU超频 </tag>
            
            <tag> CPU降频 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RPi使用Screen</title>
      <link href="/blog/rpi-screen/"/>
      <url>/blog/rpi-screen/</url>
      
        <content type="html"><![CDATA[<blockquote><ul><li>在使用ssh时虚拟一个终端,实现不间断操作</li></ul></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> apt install screen<br></code></pre></td></tr></table></figure><blockquote><p>常用命令</p></blockquote><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs gauss"><span class="hljs-keyword">screen</span> -S 新建终端<br><span class="hljs-keyword">screen</span> -r 进入已创建终端<br><span class="hljs-keyword">screen</span> -ls 列出已创建终端<br></code></pre></td></tr></table></figure><blockquote><p>快捷键</p></blockquote><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs css">Ctrl+<span class="hljs-selector-tag">A</span>+D 保存并退出<br>Ctrl+<span class="hljs-selector-tag">A</span>+K 杀死当前终端<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 软件安装与配置 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RPi </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux新建服务</title>
      <link href="/blog/linux-new-service/"/>
      <url>/blog/linux-new-service/</url>
      
        <content type="html"><![CDATA[<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">sudo nano <span class="hljs-regexp">/lib/</span>systemd<span class="hljs-regexp">/system/</span>xxx.service<br></code></pre></td></tr></table></figure><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-section">[Unit]</span><br><span class="hljs-attr">Description</span>=Your Service Name<br><span class="hljs-attr">After</span>=network.target syslog.target<br><span class="hljs-attr">Wants</span>=network.target<br><br><span class="hljs-section">[Service]</span><br><span class="hljs-attr">Type</span>=simple<br><span class="hljs-attr">ExecStart</span>=Your File Path<br><br><span class="hljs-section">[Install]</span><br><span class="hljs-attr">WantedBy</span>=multi-user.target<br></code></pre></td></tr></table></figure><figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs nsis"><span class="hljs-params">system</span>ctl daemon-reload<br><span class="hljs-params">system</span>ctl start xxx.service<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> service </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RPi搭建DNS服务器</title>
      <link href="/blog/rpi-make-dns/"/>
      <url>/blog/rpi-make-dns/</url>
      
        <content type="html"><![CDATA[<blockquote><ul><li>安装</li><li>配置dnscrypt-proxy</li><li>将路由器默认DNS更改为RPi</li><li>配置失败自动重启</li></ul></blockquote><hr><blockquote><p>安装</p></blockquote><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">sudo apt-<span class="hljs-built_in">get</span> install dnscrypt-proxy<br>sudo apt-<span class="hljs-built_in">get</span> install dnsutils #包含了dig什么的命令,最好装上<br></code></pre></td></tr></table></figure><blockquote><p>配置dnscrypt-proxy</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> nano /etc/dnscrypt-proxy/dnscrypt-proxy.toml<br>listen_addresses = [<span class="hljs-string">&#x27;127.0.0.1:53&#x27;</span>, <span class="hljs-string">&#x27;192.168.0.150:53&#x27;</span>] <span class="hljs-comment">#按照你自己的IP改</span><br>server_names = [<span class="hljs-string">&#x27;cloudflare&#x27;</span>,<span class="hljs-string">&#x27;cloudflare-ipv6&#x27;</span>]<br></code></pre></td></tr></table></figure><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">dnscrypt-proxy -<span class="hljs-built_in">resolve</span> cloudflare-dns.<span class="hljs-keyword">com</span><br></code></pre></td></tr></table></figure><p>试试行不行,没问题再做下一步安装服务</p><p><strong>非常重要,不然启动服务时会绑定端口失败</strong></p><figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs nsis">sudo nano /lib/<span class="hljs-params">system</span>d/<span class="hljs-params">system</span>/dnscrypt-proxy.service <span class="hljs-comment">#更改dnscrypt-proxy服务设置</span><br><span class="hljs-comment">#User=_dnscrypt-proxy #注释掉源文件这一行</span><br><span class="hljs-literal">User</span>=root <span class="hljs-comment">#新加这一行,让它以root身份运行(好像不怎么安全..哈哈不管了)</span><br></code></pre></td></tr></table></figure><p>启动服务试试吧!</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> systemctl <span class="hljs-built_in">enable</span> dnscrypt-proxy<br><span class="hljs-built_in">sudo</span> systemctl start dnscrypt-proxy<br><span class="hljs-built_in">sudo</span> systemctl status dnscrypt-proxy<br></code></pre></td></tr></table></figure><blockquote><p>将路由器默认DNS更改为RPi</p></blockquote><p>略略略!!!</p><p><strong>自己百度,只有一点要注意,就是要改的地方是DHCP的,不是WAN口DNS!!!</strong></p><h1 id="参考网址"><a href="#参考网址" class="headerlink" title="参考网址"></a>参考网址</h1><p><a href="https://developers.cloudflare.com/1.1.1.1/dns-over-https/cloudflared-proxy/">couldflare</a><br><a href="https://github.com/DNSCrypt/dnscrypt-proxy/wiki/installation#setting-up-dnscrypt-proxy">DNScrypt-proxy</a></p>]]></content>
      
      
      <categories>
          
          <category> 软件安装与配置 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RPi </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C++数组元素个数计算</title>
      <link href="/blog/cpp-array-element-count/"/>
      <url>/blog/cpp-array-element-count/</url>
      
        <content type="html"><![CDATA[<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">i_max</span><span class="hljs-params">(<span class="hljs-type">int</span> a[])</span> </span>&#123;<br><span class="hljs-type">int</span> tmp=a[<span class="hljs-number">0</span>];<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-built_in">sizeof</span>(a) / <span class="hljs-built_in">sizeof</span>(a[<span class="hljs-number">0</span>]); i++)<br><span class="hljs-keyword">if</span> (tmp &lt; a[i])<br>tmp = a[i];<br><span class="hljs-comment">//tmp &lt; a[i] ? tmp = a[i] : tmp = tmp;</span><br><br><span class="hljs-keyword">return</span> tmp;<br>&#125;<br></code></pre></td></tr></table></figure><p>关键代码</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-built_in">sizeof</span>(a) / <span class="hljs-built_in">sizeof</span>(a[<span class="hljs-number">0</span>])<br></code></pre></td></tr></table></figure><p>这一段是网上流行(?)计算数组元素个数的代码</p><p>但是在数组为指针的时候,经常会出错(C6384)</p><blockquote><p>解决方法:</p></blockquote><p>使用结构(struct)传递</p><pre><code class="language-cpp">struct a{int b[5]}xxx(struct a){sizeof(a.b);}</code></pre><p>似乎是因为在传递的时候,数组变成了一个指针…</p>]]></content>
      
      
      <categories>
          
          <category> 编程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RPi配置watchdog和硬盘自动休眠</title>
      <link href="/blog/rpi-watchdog-config/"/>
      <url>/blog/rpi-watchdog-config/</url>
      
        <content type="html"><![CDATA[<blockquote><ul><li>rpi 3b watchdog</li><li>硬盘闲置自动休眠</li></ul></blockquote><h1 id="请依据CPU型号修改watchdog设备"><a href="#请依据CPU型号修改watchdog设备" class="headerlink" title="请依据CPU型号修改watchdog设备"></a>请依据CPU型号修改watchdog设备</h1><hr><h1 id="hdparm"><a href="#hdparm" class="headerlink" title="hdparm"></a>hdparm</h1><hr><blockquote><p>安装hdparm（略）</p></blockquote><blockquote><p>测试hdparm</p></blockquote><p><a href="http://www.linux-magazine.com/Online/Features/Tune-Your-Hard-Disk-with-hdparm">hdparm链接</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> hdparm -y /dev/sda1<br></code></pre></td></tr></table></figure><p><strong>如果没有报错就支持</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> hdparm -I /dev/sda1|grep cache<br></code></pre></td></tr></table></figure><p><strong>如果看到有”*“就支持缓存</strong></p><blockquote><p>编辑hdparm</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> nano /etc/hdparm.conf<br></code></pre></td></tr></table></figure><p>加入</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs abnf">/dev/sda1 &#123;<br>write_cache <span class="hljs-operator">=</span> on<br>spindown_time <span class="hljs-operator">=</span> <span class="hljs-number">120</span><br>&#125;<br></code></pre></td></tr></table></figure><p><em>如果不支持缓存就不要加入write_cache那行</em></p><p><em>下面延时计算是 无操作休眠时间(分钟)*60&#x2F;5</em></p><h1 id="watchdog"><a href="#watchdog" class="headerlink" title="watchdog"></a>watchdog</h1><hr><blockquote><p>安装watchdog（略）</p></blockquote><blockquote><p>载入watchdog</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> modprobe bcm2835_wdt<br><span class="hljs-built_in">sudo</span> nano /etc/modules<br>bcm2835_wdt<br></code></pre></td></tr></table></figure><blockquote><p>编辑配置</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> /etc/watchdog.conf<br></code></pre></td></tr></table></figure><blockquote><p>修改</p></blockquote><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">max-load-1</span><span class="hljs-operator">=</span><span class="hljs-number">24</span><br><span class="hljs-attribute">watchdog-device</span> <span class="hljs-operator">=</span> /dev/watchdog<br><span class="hljs-attribute">watchdog-timeout</span><span class="hljs-operator">=</span><span class="hljs-number">20</span><br><span class="hljs-attribute">temperature-sensor</span>      <span class="hljs-operator">=</span> /sys/class/thermal/thermal_zone0/temp<br><span class="hljs-attribute">max-temperature</span> <span class="hljs-operator">=</span> <span class="hljs-number">85000</span><br></code></pre></td></tr></table></figure><blockquote><p>启动</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> systemctl <span class="hljs-built_in">enable</span> watchdog.service<br><span class="hljs-built_in">sudo</span> chkconfig watchdog on<br></code></pre></td></tr></table></figure><h2 id="附赠一个fork-bomb"><a href="#附赠一个fork-bomb" class="headerlink" title="附赠一个fork bomb"></a>附赠一个fork bomb</h2><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc"><span class="hljs-meta">:()&#123; :|:</span> &amp; &#125;;:<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 软件安装与配置 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RPi </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RPi搭建NAS</title>
      <link href="/blog/rpi-nas/"/>
      <url>/blog/rpi-nas/</url>
      
        <content type="html"><![CDATA[<blockquote><p>安装</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> apt install aria2<br><span class="hljs-built_in">sudo</span> apt install nginx<br><span class="hljs-built_in">sudo</span> apt install ntfs-3g<br><span class="hljs-built_in">sudo</span> apt install samba<br>````<br><br>&gt; aria2<br><br>配置<br><br>把页面最下面那个配置文件复制到/etc/aria2/aria2.conf<br><br>创建aria2用户<br><br></code></pre></td></tr></table></figure><p>sudo useradd -M -s &#x2F;usr&#x2F;sbin&#x2F;nologin aria2</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs"><br>创建下载会话保存文件<br><br></code></pre></td></tr></table></figure><p>sudo touch &#x2F;etc&#x2F;aria2&#x2F;aria2.session<br>sudo chown aria2 &#x2F;etc&#x2F;aria2 &#x2F;etc&#x2F;aria2&#x2F;aria2.session</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs"><br>测试一下能不能启动<br><br></code></pre></td></tr></table></figure><p>aria2c –conf-path&#x3D;&#x2F;etc&#x2F;aria2&#x2F;aria2.conf</p><figure class="highlight node-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs node-repl"><br><span class="hljs-meta prompt_">&gt;</span> <span class="language-javascript">设置服务</span><br><br></code></pre></td></tr></table></figure><p>sudo nano &#x2F;lib&#x2F;systemd&#x2F;system&#x2F;aria2.service</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs"><br></code></pre></td></tr></table></figure><p>[Unit]<br>Description&#x3D;Aria2 Service<br>After&#x3D;network.target</p><p>[Service]<br>Type&#x3D;simple<br>User&#x3D;aria2<br>ExecStart&#x3D;aria2c –conf-path&#x3D;&#x2F;etc&#x2F;aria2&#x2F;aria2.conf</p><p>[Install]<br>WantedBy&#x3D;multi-user.target</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs"><br></code></pre></td></tr></table></figure><p>sudo systemctl start aria2.service<br>sudo systemctl enable aria2.service</p><figure class="highlight node-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs node-repl"><br><span class="hljs-meta prompt_">&gt;</span> <span class="language-javascript"><span class="hljs-title class_">AriaNg</span></span><br><br></code></pre></td></tr></table></figure><p>cd &#x2F;var&#x2F;www<br>sudo rm -rf html<br>sudo mkdir html<br>cd html<br>sudo wget <a href="https://github.com/mayswind/AriaNg/releases/download/1.1.4/AriaNg-1.1.4.zip">https://github.com/mayswind/AriaNg/releases/download/1.1.4/AriaNg-1.1.4.zip</a><br>sudo unzip AriaNg-1.1.4.zip<br>sudo rm AriaNg-1.1.4.zip</p><figure class="highlight node-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs node-repl"><br><span class="hljs-meta prompt_">&gt;</span> <span class="language-javascript">挂载<span class="hljs-variable constant_">NTFS</span>硬盘</span><br><br></code></pre></td></tr></table></figure><p>sudo apt-get install exfat-*</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs"><br></code></pre></td></tr></table></figure><p>sudo fdisk -l#看一下你的硬盘在哪<br>sudo mkdir &#x2F;media&#x2F;HDD#挂载点<br>sudo mount &#x2F;dev&#x2F;sda1 &#x2F;media&#x2F;HDD<br>sudo nano &#x2F;etc&#x2F;fstab#设置开机自动挂在</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">加一行<br></code></pre></td></tr></table></figure><p>&#x2F;dev&#x2F;sda1 &#x2F;media&#x2F;HDD auto rw,defaults 0 0</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs markdown"><span class="hljs-emphasis">*注意最好用auto，不指定文件系统。如果指定之后，以后转换为ext4分区的时候忘记改了，那就很好玩了*</span><br><br><span class="hljs-quote">&gt; samba</span><br><br></code></pre></td></tr></table></figure><p>sudo nano &#x2F;etc&#x2F;samba&#x2F;smb.conf</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">加入<br></code></pre></td></tr></table></figure><p>[share]<br>   comment &#x3D; NAS<br>   path &#x3D; &#x2F;media&#x2F;HDD<br>   read only &#x3D; no<br>   writable &#x3D; yes<br>   create mask &#x3D; 0777<br>   directory mask &#x3D; 0777<br>   guest ok &#x3D; yes<br>   browseable &#x3D; yes</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs markdown"><br>-----<br><br><span class="hljs-quote">&gt; aria2.conf</span><br><br></code></pre></td></tr></table></figure><p>check-intergrity&#x3D;true<br>#允许rpc<br>enable-rpc&#x3D;true<br>#允许所有来源, web界面跨域权限需要<br>rpc-allow-origin-all&#x3D;true<br>#允许非外部访问<br>rpc-listen-all&#x3D;true<br>#RPC端口, 仅当默认端口被占用时修改<br>#rpc-listen-port&#x3D;6800</p><h1 id="token验证"><a href="#token验证" class="headerlink" title="token验证"></a>token验证</h1><p>rpc-secret&#x3D;****<br>#rpc-user&#x3D;****<br>#rpc-passwd&#x3D;****<br>#最大同时下载数(任务数), 路由建议值: 3<br>max-concurrent-downloads&#x3D;3<br>#断点续传<br>continue&#x3D;true<br>#同服务器连接数<br>max-connection-per-server&#x3D;6<br>#最小文件分片大小, 下载线程数上限取决于能分出多少片, 对于小文件重要<br>min-split-size&#x3D;10M<br>#单文件最大线程数, 路由建议值: 5<br>split&#x3D;6<br>#下载速度限制<br>max-overall-download-limit&#x3D;0<br>#单文件速度限制<br>max-download-limit&#x3D;0<br>#上传速度限制<br>max-overall-upload-limit&#x3D;0<br>#单文件速度限制<br>max-upload-limit&#x3D;0</p><p>input-file&#x3D;&#x2F;etc&#x2F;aria2&#x2F;aria2.session<br>save-session&#x3D;&#x2F;etc&#x2F;aria2&#x2F;aria2.session<br>#定时保存会话，需要1.16.1之后的release版<br>save-session-interval&#x3D;60</p><p>#文件保存路径, 默认为当前启动位置<br>dir&#x3D;&#x2F;media&#x2F;HDD&#x2F;Download<br>#文件缓存, 使用内置的文件缓存, 如果你不相信Linux内核文件缓存和磁盘内置缓存时使用, 需要1.16及以上版本<br>#disk-cache&#x3D;0<br>#另一种Linux文件缓存方式, 使用前确保您使用的内核支持此选项, 需要1.15及以上版本(?)<br>#enable-mmap&#x3D;true<br>#文件预分配, 能有效降低文件碎片, 提高磁盘性能. 缺点是预分配时间较长<br>#所需时间 none &lt; falloc ? trunc &lt;&lt; prealloc, falloc和trunc需要文件系统和内核支持<br>#file-allocation&#x3D;falloc</p><p>#启用本地节点查找<br>bt-enable-lpd&#x3D;true<br>#添加额外的tracker<br>#bt-tracker&#x3D;<URI>,<br>#单种子最大连接数<br>#bt-max-peers&#x3D;55<br>#强制加密, 防迅雷必备<br>bt-require-crypto&#x3D;true<br>#当下载的文件是一个种子(以.torrent结尾)时, 自动下载BT<br>follow-torrent&#x3D;true<br>#BT监听端口, 当端口屏蔽时使用<br>listen-port&#x3D;6881-6999</URI></p><p>#不确定是否需要，为保险起见，need more test<br>enable-dht&#x3D;false<br>bt-enable-lpd&#x3D;false<br>enable-peer-exchange&#x3D;false<br>#修改特征<br>user-agent&#x3D;uTorrent&#x2F;2210(25130)<br>peer-id-prefix&#x3D;-UT2210-<br>#修改做种设置, 允许做种<br>seed-ratio&#x3D;0<br>#保存会话<br>#force-save&#x3D;true<br>bt-hash-check-seed&#x3D;true<br>bt-seed-unverified&#x3D;true<br>bt-save-metadata&#x3D;true</p><pre><code class="hljs"></code></pre>]]></content>
      
      
      <categories>
          
          <category> 软件安装与配置 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RPi </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RPi配置国内软件源</title>
      <link href="/blog/rpi-apt-config/"/>
      <url>/blog/rpi-apt-config/</url>
      
        <content type="html"><![CDATA[<h2 id="先使用官方源进行一次update"><a href="#先使用官方源进行一次update" class="headerlink" title="先使用官方源进行一次update"></a>先使用官方源进行一次update</h2><h2 id="查看系统版本-非常重要"><a href="#查看系统版本-非常重要" class="headerlink" title="查看系统版本(非常重要)"></a>查看系统版本(非常重要)</h2><p>注意不要使用不是你系统版本的软件源</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">lsb_release -c<br></code></pre></td></tr></table></figure><h2 id="换源"><a href="#换源" class="headerlink" title="换源"></a>换源</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo nano /etc/apt/sources.list<br>deb https://mirrors.ustc.edu.cn/raspbian/raspbian/ buster main contrib non-free<br>deb-src https://mirrors.ustc.edu.cn/raspbian/raspbian/ buster main contrib non-free<br><span class="hljs-meta prompt_">#</span><span class="language-bash">deb http://raspbian.raspberrypi.org/raspbian/ buster main contrib non-free rpi</span><br>sudo nano /etc/apt/sources.list.d/raspi.list<br>deb http://mirrors.ustc.edu.cn/archive.raspberrypi.org/debian/ buster main ui<br>deb https://mirrors.tuna.tsinghua.edu.cn/raspberrypi/ buster main ui<br><span class="hljs-meta prompt_">#</span><span class="language-bash">deb http://archive.raspberrypi.org/debian/ buster main</span><br></code></pre></td></tr></table></figure><h2 id="更新"><a href="#更新" class="headerlink" title="更新"></a>更新</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo apt update<br>sudo apt upgrade<br>sudo apt dist-upgrade<br></code></pre></td></tr></table></figure><h3 id="加个新架构"><a href="#加个新架构" class="headerlink" title="加个新架构"></a>加个新架构</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">dpkg --add-architecture arm<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 软件安装与配置 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RPi </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>制作VS-C++便携版(基于VSCode)</title>
      <link href="/blog/vscode-portable/"/>
      <url>/blog/vscode-portable/</url>
      
        <content type="html"><![CDATA[<h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p><a href="https://eyun.baidu.com/s/3jJhjRmA">不想动手可以直接下载的懒人版,密码QRSJ</a></p><blockquote><ul><li>VSCode</li><li>LLVM</li><li>mingw64</li></ul></blockquote><p><a href="https://code.visualstudio.com/Download">下载VSCode</a></p><p><strong>注意选择下载压缩包格式。</strong></p><hr><p><a href="http://releases.llvm.org/download.html">下载LLVM</a></p><p>不需要选sig文件</p><p><strong>注意选择”Pre-Built Binaries”,系统位数要对应你上面选的！</strong></p><hr><p><a href="https://sourceforge.net/projects/mingw-w64/files/">下载MinGW-W64</a></p><p><strong>如果你系统版本是x64,下载x86_64-posix-seh。</strong></p><p><strong>如果你系统版本是x32,下载x86_64-win32-seh。</strong></p><hr><p>1.解压VSCode到某个地方,再把MinGW解压到VSCode的目录里</p><p>我做这几部只是为了得到LLVM目录,卸载掉它只是因为不想让程序列表里太多<strong>非强迫症可以忽略2-4步,直接选择安装目录到第一步文件夹里</strong></p><p>2.安装LLVM,先<strong>随便</strong>安装到一个位置</p><p>3.把LLVM目录整个拷到第1步里的目录里</p><p>4.卸载掉你系统里的LLVM</p><p>5.将附件中!start.vbs和start.bat复制到第一步的文件夹中</p><p>6.注释掉start.bat最后一行<strong>就是在最后一行前面加::</strong></p><p>7.**!!这一步做完不要关!!**在cmd(或者power shell)中输入.\start.bat运行脚本,然后输入clang和gcc.<strong>如果出现xxx不是内部或外部命令,就说明你start.bat配置有问题</strong> 。</p><p>8.在你第1步的文件夹中新建以下名字的<strong>文件夹</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">Users<br>Users\AppData<br>Users\AppData\Local<br>Users\AppData\Roaming<br>Users\AppData\Desktop<br><br>extensions<br></code></pre></td></tr></table></figure><p>9.安装扩展</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">Chinese(简中语言包)<br>C/C++<br>vscode-clangd<br>Code Runner<br>Bracket Pair Colorizer 2<br>One Dark Pro(主题包,可选)<br></code></pre></td></tr></table></figure><p>10.在第7步中的cmd(或power shell)中输入.\code.exe进入VSCode</p><p>11.在文件浏览器中新建一个目录(<strong>我就直接在第1步的目录中新建了一个!Code</strong>),然后在VSCode中打开它,然后选择将工作区另存为</p><p>需要注意的是这里你把每个语言的工作目录放到单独的文件夹中,比如c放到c中,c++放到c++中</p><p>12.在!Code中又新建一个名叫C++的文件夹**(具体参照自身情况)**</p><p>13.在C++目录中新建一个.vscode的文件夹,然后在里面把附件中的launch.json,tasks.json,settings.json,compile_flags.txt复制进去</p><p>14.取消第6步中的注释,关掉这个VSCode.运行!start.vbs</p><p>15.新建一个文件,输入点什么测试代码</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br>using namespace <span class="hljs-built_in">std</span>;<br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span> <span class="hljs-params">()</span>&#123;<br>    <span class="hljs-built_in">string</span> a=<span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;Input:&quot;</span> &lt;&lt; <span class="hljs-built_in">endl</span>;<br>    <span class="hljs-built_in">cin</span> &gt;&gt; a;<br>    <span class="hljs-built_in">cout</span> &lt;&lt; a;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>16.点击右上箭头,看看控制台是不是输出了Input:.然后输入随便什么东西,看看它会不会原封不动的显示出来</p><p>17.没了</p><h2 id="附件"><a href="#附件" class="headerlink" title="附件"></a>附件</h2><hr><h3 id="start-bat"><a href="#start-bat" class="headerlink" title="start.bat"></a>start.bat</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">set</span> ThisDir=%~dp0<br><span class="hljs-built_in">set</span> USERPROFILE=%ThisDir%Users<br><span class="hljs-built_in">set</span> APPDATA=%USERPROFILE%\AppData\Roaming<br><span class="hljs-built_in">set</span> path=%ThisDir%LLVM\bin;%ThisDir%mingw64\bin;%path%<br>REM Code.exe --extensions-dir <span class="hljs-string">&quot;extensions&quot;</span><br>Code.exe !Code\C++\code.code-workspace<br></code></pre></td></tr></table></figure><h3 id="start-vbs"><a href="#start-vbs" class="headerlink" title="!start.vbs"></a>!start.vbs</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">set</span> ws=createobject(<span class="hljs-string">&quot;wscript.shell&quot;</span>)<br>ws.run <span class="hljs-string">&quot;start.bat&quot;</span>,0<br></code></pre></td></tr></table></figure><h3 id="launch-json"><a href="#launch-json" class="headerlink" title="launch.json"></a>launch.json</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;version&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;0.2.0&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;configurations&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>        <span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;(gdb) Launch&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;cppdbg&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;request&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;launch&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;program&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;$&#123;fileDirname&#125;/$&#123;fileBasenameNoExtension&#125;.exe&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;args&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;stopAtEntry&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;cwd&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;$&#123;workspaceFolder&#125;&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;environment&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;externalConsole&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;internalConsoleOptions&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;neverOpen&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;MIMode&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;gdb&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;miDebuggerPath&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;gdb.exe&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;setupCommands&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>                <span class="hljs-punctuation">&#123;</span><br>                    <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Enable pretty-printing for gdb&quot;</span><span class="hljs-punctuation">,</span><br>                    <span class="hljs-attr">&quot;text&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;-enable-pretty-printing&quot;</span><span class="hljs-punctuation">,</span><br>                    <span class="hljs-attr">&quot;ignoreFailures&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><br>                <span class="hljs-punctuation">&#125;</span><br>            <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;preLaunchTask&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Compile&quot;</span><br>        <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">]</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><h3 id="tasks-json"><a href="#tasks-json" class="headerlink" title="tasks.json"></a>tasks.json</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;version&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2.0.0&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;tasks&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>        <span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;label&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Compile&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;command&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;clang++&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">//如果你是用c语言,改成clang</span><br>            <span class="hljs-attr">&quot;args&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>                <span class="hljs-string">&quot;$&#123;file&#125;&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-string">&quot;-o&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-string">&quot;$&#123;fileDirname&#125;/$&#123;fileBasenameNoExtension&#125;.exe&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-string">&quot;-g&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-string">&quot;-Wall&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-string">&quot;-static-libgcc&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-string">&quot;--target=x86_64-w64-mingw&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;process&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;group&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;kind&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;build&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;isDefault&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><br>            <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;presentation&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;echo&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;reveal&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;always&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;focus&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;panel&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;shared&quot;</span><br>            <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">]</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><h3 id="settings-json"><a href="#settings-json" class="headerlink" title="settings.json"></a>settings.json</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;files.defaultLanguage&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;c&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;editor.formatOnType&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;editor.suggest.snippetsPreventQuickSuggestions&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;editor.acceptSuggestionOnEnter&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;off&quot;</span><span class="hljs-punctuation">,</span><br><br>    <span class="hljs-attr">&quot;code-runner.runInTerminal&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;code-runner.executorMap&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;c&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;cd $dir &amp;&amp; clang &#x27;$fileName&#x27; -o &#x27;$fileNameWithoutExt.exe&#x27; -Wall -g -O2 -static-libgcc --target=x86_64-w64-mingw -std=c11 &amp;&amp; &amp;&#x27;$dir$fileNameWithoutExt&#x27;&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;cpp&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;cd $dir &amp;&amp; clang++ &#x27;$fileName&#x27; -o &#x27;$fileNameWithoutExt.exe&#x27; -Wall -g -O2 -static-libgcc --target=x86_64-w64-mingw -std=c++17 &amp;&amp; &amp;&#x27;$dir$fileNameWithoutExt&#x27;&quot;</span><br>    <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;code-runner.saveFileBeforeRun&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;code-runner.preserveFocus&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;code-runner.clearPreviousOutput&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;code-runner.ignoreSelection&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br><br>    <span class="hljs-attr">&quot;C_Cpp.clang_format_sortIncludes&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;C_Cpp.errorSquiggles&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Disabled&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;C_Cpp.autocomplete&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Disabled&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;C_Cpp.suggestSnippets&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><h3 id="compile-flags-txt"><a href="#compile-flags-txt" class="headerlink" title="compile_flags.txt"></a>compile_flags.txt</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">-Wall<br>--target=x86_64-w64-mingw<br>-std=c++17<br><span class="hljs-comment">#写的语言是C,注释掉上面那行</span><br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 软件安装与配置 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> VSCode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DEMO_Markdown</title>
      <link href="/blog/edit/"/>
      <url>/blog/edit/</url>
      
        <content type="html"><![CDATA[<h1 id="欢迎使用-Cmd-Markdown-编辑阅读器"><a href="#欢迎使用-Cmd-Markdown-编辑阅读器" class="headerlink" title="欢迎使用 Cmd Markdown 编辑阅读器"></a>欢迎使用 Cmd Markdown 编辑阅读器</h1><hr><p>我们理解您需要更便捷更高效的工具记录思想，整理笔记、知识，并将其中承载的价值传播给他人，<strong>Cmd Markdown</strong> 是我们给出的答案 —— 我们为记录思想和分享知识提供更专业的工具。 您可以使用 Cmd Markdown：</p><blockquote><ul><li>整理知识，学习笔记</li><li>发布日记，杂文，所见所想</li><li>撰写发布技术文稿（代码支持）</li><li>撰写发布学术论文（LaTeX 公式支持）</li></ul></blockquote><p><img src="https://www.zybuluo.com/static/img/logo.png" alt="cmd-markdown-logo"></p><p>除了您现在看到的这个 Cmd Markdown 在线版本，您还可以前往以下网址下载：</p><h3 id="Windows-Mac-Linux-全平台客户端"><a href="#Windows-Mac-Linux-全平台客户端" class="headerlink" title="Windows&#x2F;Mac&#x2F;Linux 全平台客户端"></a><a href="https://www.zybuluo.com/cmd/">Windows&#x2F;Mac&#x2F;Linux 全平台客户端</a></h3><blockquote><p>请保留此份 Cmd Markdown 的欢迎稿兼使用说明，如需撰写新稿件，点击顶部工具栏右侧的 <i class="icon-file"></i> <strong>新文稿</strong> 或者使用快捷键 <code>Ctrl+Alt+N</code>。</p></blockquote><hr><h2 id="什么是-Markdown"><a href="#什么是-Markdown" class="headerlink" title="什么是 Markdown"></a>什么是 Markdown</h2><p>Markdown 是一种方便记忆、书写的纯文本标记语言，用户可以使用这些标记符号以最小的输入代价生成极富表现力的文档：譬如您正在阅读的这份文档。它使用简单的符号标记不同的标题，分割不同的段落，<strong>粗体</strong> 或者 <em>斜体</em> 某些文字，更棒的是，它还可以</p><h3 id="1-制作一份待办事宜-Todo-列表"><a href="#1-制作一份待办事宜-Todo-列表" class="headerlink" title="1. 制作一份待办事宜 Todo 列表"></a>1. 制作一份待办事宜 <a href="https://www.zybuluo.com/mdeditor?url=https://www.zybuluo.com/static/editor/md-help.markdown#13-%E5%BE%85%E5%8A%9E%E4%BA%8B%E5%AE%9C-todo-%E5%88%97%E8%A1%A8">Todo 列表</a></h3><ul><li><input disabled type="checkbox"> 支持以 PDF 格式导出文稿</li><li><input disabled type="checkbox"> 改进 Cmd 渲染算法，使用局部渲染技术提高渲染效率</li><li><input checked disabled type="checkbox"> 新增 Todo 列表功能</li><li><input checked disabled type="checkbox"> 修复 LaTex 公式渲染问题</li><li><input checked disabled type="checkbox"> 新增 LaTex 公式编号功能</li></ul><h3 id="2-书写一个质能守恒公式-LaTeX"><a href="#2-书写一个质能守恒公式-LaTeX" class="headerlink" title="2. 书写一个质能守恒公式[^LaTeX]"></a>2. 书写一个质能守恒公式[^LaTeX]</h3><p>$$E&#x3D;mc^2$$</p><h3 id="3-高亮一段代码-code"><a href="#3-高亮一段代码-code" class="headerlink" title="3. 高亮一段代码[^code]"></a>3. 高亮一段代码[^code]</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">@requires_authorization</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">SomeClass</span>:<br>    <span class="hljs-keyword">pass</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    <span class="hljs-comment"># A comment</span><br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;hello world&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="4-高效绘制-流程图"><a href="#4-高效绘制-流程图" class="headerlink" title="4. 高效绘制 流程图"></a>4. 高效绘制 <a href="https://www.zybuluo.com/mdeditor?url=https://www.zybuluo.com/static/editor/md-help.markdown#7-%E6%B5%81%E7%A8%8B%E5%9B%BE">流程图</a></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs flow">st=&gt;start: Start<br>op=&gt;operation: Your Operation<br>cond=&gt;condition: Yes or No?<br>e=&gt;end<br><br>st-&gt;op-&gt;cond<br>cond(yes)-&gt;e<br>cond(no)-&gt;op<br></code></pre></td></tr></table></figure><h3 id="5-高效绘制-序列图"><a href="#5-高效绘制-序列图" class="headerlink" title="5. 高效绘制 序列图"></a>5. 高效绘制 <a href="https://www.zybuluo.com/mdeditor?url=https://www.zybuluo.com/static/editor/md-help.markdown#8-%E5%BA%8F%E5%88%97%E5%9B%BE">序列图</a></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs seq">Alice-&gt;Bob: Hello Bob, how are you?<br>Note right of Bob: Bob thinks<br>Bob--&gt;Alice: I am good thanks!<br></code></pre></td></tr></table></figure><h3 id="6-高效绘制-甘特图"><a href="#6-高效绘制-甘特图" class="headerlink" title="6. 高效绘制 甘特图"></a>6. 高效绘制 <a href="https://www.zybuluo.com/mdeditor?url=https://www.zybuluo.com/static/editor/md-help.markdown#9-%E7%94%98%E7%89%B9%E5%9B%BE">甘特图</a></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs gantt">title 项目开发流程<br>section 项目确定<br>    需求分析       :a1, 2016-06-22, 3d<br>    可行性报告     :after a1, 5d<br>    概念验证       : 5d<br>section 项目实施<br>    概要设计      :2016-07-05  , 5d<br>    详细设计      :2016-07-08, 10d<br>    编码          :2016-07-15, 10d<br>    测试          :2016-07-22, 5d<br>section 发布验收<br>    发布: 2d<br>    验收: 3d<br></code></pre></td></tr></table></figure><h3 id="7-绘制表格"><a href="#7-绘制表格" class="headerlink" title="7. 绘制表格"></a>7. 绘制表格</h3><table><thead><tr><th>项目</th><th align="right">价格</th><th align="center">数量</th></tr></thead><tbody><tr><td>计算机</td><td align="right">$1600</td><td align="center">5</td></tr><tr><td>手机</td><td align="right">$12</td><td align="center">12</td></tr><tr><td>管线</td><td align="right">$1</td><td align="center">234</td></tr></tbody></table><h3 id="8-更详细语法说明"><a href="#8-更详细语法说明" class="headerlink" title="8. 更详细语法说明"></a>8. 更详细语法说明</h3><p>想要查看更详细的语法说明，可以参考我们准备的 <a href="https://www.zybuluo.com/mdeditor?url=https://www.zybuluo.com/static/editor/md-help.markdown">Cmd Markdown 简明语法手册</a>，进阶用户可以参考 <a href="https://www.zybuluo.com/mdeditor?url=https://www.zybuluo.com/static/editor/md-help.markdown#cmd-markdown-%E9%AB%98%E9%98%B6%E8%AF%AD%E6%B3%95%E6%89%8B%E5%86%8C">Cmd Markdown 高阶语法手册</a> 了解更多高级功能。</p><p>总而言之，不同于其它 <em>所见即所得</em> 的编辑器：你只需使用键盘专注于书写文本内容，就可以生成印刷级的排版格式，省却在键盘和工具栏之间来回切换，调整内容和格式的麻烦。<strong>Markdown 在流畅的书写和印刷级的阅读体验之间找到了平衡。</strong> 目前它已经成为世界上最大的技术分享网站 GitHub 和 技术问答网站 StackOverFlow 的御用书写格式。</p><hr><h2 id="什么是-Cmd-Markdown"><a href="#什么是-Cmd-Markdown" class="headerlink" title="什么是 Cmd Markdown"></a>什么是 Cmd Markdown</h2><p>您可以使用很多工具书写 Markdown，但是 Cmd Markdown 是这个星球上我们已知的、最好的 Markdown 工具——没有之一 ：）因为深信文字的力量，所以我们和你一样，对流畅书写，分享思想和知识，以及阅读体验有极致的追求，我们把对于这些诉求的回应整合在 Cmd Markdown，并且一次，两次，三次，乃至无数次地提升这个工具的体验，最终将它演化成一个 <strong>编辑&#x2F;发布&#x2F;阅读</strong> Markdown 的在线平台——您可以在任何地方，任何系统&#x2F;设备上管理这里的文字。</p><h3 id="1-实时同步预览"><a href="#1-实时同步预览" class="headerlink" title="1. 实时同步预览"></a>1. 实时同步预览</h3><p>我们将 Cmd Markdown 的主界面一分为二，左边为<strong>编辑区</strong>，右边为<strong>预览区</strong>，在编辑区的操作会实时地渲染到预览区方便查看最终的版面效果，并且如果你在其中一个区拖动滚动条，我们有一个巧妙的算法把另一个区的滚动条同步到等价的位置，超酷！</p><h3 id="2-编辑工具栏"><a href="#2-编辑工具栏" class="headerlink" title="2. 编辑工具栏"></a>2. 编辑工具栏</h3><p>也许您还是一个 Markdown 语法的新手，在您完全熟悉它之前，我们在 <strong>编辑区</strong> 的顶部放置了一个如下图所示的工具栏，您可以使用鼠标在工具栏上调整格式，不过我们仍旧鼓励你使用键盘标记格式，提高书写的流畅度。</p><p><img src="https://www.zybuluo.com/static/img/toolbar-editor.png" alt="tool-editor"></p><h3 id="3-编辑模式"><a href="#3-编辑模式" class="headerlink" title="3. 编辑模式"></a>3. 编辑模式</h3><p>完全心无旁骛的方式编辑文字：点击 <strong>编辑工具栏</strong> 最右侧的拉伸按钮或者按下 <code>Ctrl + M</code>，将 Cmd Markdown 切换到独立的编辑模式，这是一个极度简洁的写作环境，所有可能会引起分心的元素都已经被挪除，超清爽！</p><h3 id="4-实时的云端文稿"><a href="#4-实时的云端文稿" class="headerlink" title="4. 实时的云端文稿"></a>4. 实时的云端文稿</h3><p>为了保障数据安全，Cmd Markdown 会将您每一次击键的内容保存至云端，同时在 <strong>编辑工具栏</strong> 的最右侧提示 <code>已保存</code> 的字样。无需担心浏览器崩溃，机器掉电或者地震，海啸——在编辑的过程中随时关闭浏览器或者机器，下一次回到 Cmd Markdown 的时候继续写作。</p><h3 id="5-离线模式"><a href="#5-离线模式" class="headerlink" title="5. 离线模式"></a>5. 离线模式</h3><p>在网络环境不稳定的情况下记录文字一样很安全！在您写作的时候，如果电脑突然失去网络连接，Cmd Markdown 会智能切换至离线模式，将您后续键入的文字保存在本地，直到网络恢复再将他们传送至云端，即使在网络恢复前关闭浏览器或者电脑，一样没有问题，等到下次开启 Cmd Markdown 的时候，她会提醒您将离线保存的文字传送至云端。简而言之，我们尽最大的努力保障您文字的安全。</p><h3 id="6-管理工具栏"><a href="#6-管理工具栏" class="headerlink" title="6. 管理工具栏"></a>6. 管理工具栏</h3><p>为了便于管理您的文稿，在 <strong>预览区</strong> 的顶部放置了如下所示的 <strong>管理工具栏</strong>：</p><p><img src="https://www.zybuluo.com/static/img/toolbar-manager.jpg" alt="tool-manager"></p><p>通过管理工具栏可以：</p><p><i class="icon-share"></i> 发布：将当前的文稿生成固定链接，在网络上发布，分享<br><i class="icon-file"></i> 新建：开始撰写一篇新的文稿<br><i class="icon-trash"></i> 删除：删除当前的文稿<br><i class="icon-cloud"></i> 导出：将当前的文稿转化为 Markdown 文本或者 Html 格式，并导出到本地<br><i class="icon-reorder"></i> 列表：所有新增和过往的文稿都可以在这里查看、操作<br><i class="icon-pencil"></i> 模式：切换 普通&#x2F;Vim&#x2F;Emacs 编辑模式</p><h3 id="7-阅读工具栏"><a href="#7-阅读工具栏" class="headerlink" title="7. 阅读工具栏"></a>7. 阅读工具栏</h3><p><img src="https://www.zybuluo.com/static/img/toolbar-reader.jpg" alt="tool-manager"></p><p>通过 <strong>预览区</strong> 右上角的 <strong>阅读工具栏</strong>，可以查看当前文稿的目录并增强阅读体验。</p><p>工具栏上的五个图标依次为：</p><p><i class="icon-list"></i> 目录：快速导航当前文稿的目录结构以跳转到感兴趣的段落<br><i class="icon-chevron-sign-left"></i> 视图：互换左边编辑区和右边预览区的位置<br><i class="icon-adjust"></i> 主题：内置了黑白两种模式的主题，试试 <strong>黑色主题</strong>，超炫！<br><i class="icon-desktop"></i> 阅读：心无旁骛的阅读模式提供超一流的阅读体验<br><i class="icon-fullscreen"></i> 全屏：简洁，简洁，再简洁，一个完全沉浸式的写作和阅读环境</p><h3 id="8-阅读模式"><a href="#8-阅读模式" class="headerlink" title="8. 阅读模式"></a>8. 阅读模式</h3><p>在 <strong>阅读工具栏</strong> 点击 <i class="icon-desktop"></i> 或者按下 <code>Ctrl+Alt+M</code> 随即进入独立的阅读模式界面，我们在版面渲染上的每一个细节：字体，字号，行间距，前背景色都倾注了大量的时间，努力提升阅读的体验和品质。</p><h3 id="9-标签、分类和搜索"><a href="#9-标签、分类和搜索" class="headerlink" title="9. 标签、分类和搜索"></a>9. 标签、分类和搜索</h3><p>在编辑区任意行首位置输入以下格式的文字可以标签当前文档：</p><p>标签： 未分类</p><p>标签以后的文稿在【文件列表】（Ctrl+Alt+F）里会按照标签分类，用户可以同时使用键盘或者鼠标浏览查看，或者在【文件列表】的搜索文本框内搜索标题关键字过滤文稿，如下图所示：</p><p><img src="https://www.zybuluo.com/static/img/file-list.png" alt="file-list"></p><h3 id="10-文稿发布和分享"><a href="#10-文稿发布和分享" class="headerlink" title="10. 文稿发布和分享"></a>10. 文稿发布和分享</h3><p>在您使用 Cmd Markdown 记录，创作，整理，阅读文稿的同时，我们不仅希望它是一个有力的工具，更希望您的思想和知识通过这个平台，连同优质的阅读体验，将他们分享给有相同志趣的人，进而鼓励更多的人来到这里记录分享他们的思想和知识，尝试点击 <i class="icon-share"></i> (Ctrl+Alt+P) 发布这份文档给好友吧！</p><hr><p>再一次感谢您花费时间阅读这份欢迎稿，点击 <i class="icon-file"></i> (Ctrl+Alt+N) 开始撰写新的文稿吧！祝您在这里记录、阅读、分享愉快！</p><p>作者 <a href="http://weibo.com/ghosert">@ghosert</a><br>2016 年 07月 07日    </p><p>[^LaTeX]: 支持 <strong>LaTeX</strong> 编辑显示支持，例如：$\sum_{i&#x3D;1}^n a_i&#x3D;0$， 访问 <a href="http://meta.math.stackexchange.com/questions/5020/mathjax-basic-tutorial-and-quick-reference">MathJax</a> 参考更多使用方法。</p><p>[^code]: 代码高亮功能支持包括 Java, Python, JavaScript 在内的，<strong>四十一</strong>种主流编程语言。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>测试页面</title>
      <link href="/blog/test-page/"/>
      <url>/blog/test-page/</url>
      
        <content type="html"><![CDATA[<style>a {text-decoration: none!important}#globalAd {max-width: 400px;flex-basis: 100%;margin: 0 auto;background: #fff;border-radius: 10px;box-shadow: 0 0 30px rgba(0, 0, 0, .3);-webkit-box-shadow: 0 0 30px rgba(0, 0, 0, .3);overflow: hidden;position: fixed;display: none;margin: 0 auto;z-index: 10001}.layer {width: 100%;height: 100%;position: fixed;top: 0;left: 0;filter: alpha(opacity=50);opacity: .5;background: #000;z-index: 1000;display: none}#globalAd #hero-img {width: 100%;height: 100px;background: #007bff}#globalAd #profile-img {width: 80px;height: 80px;margin: -80px auto 0;border: 6px solid #fff;border-radius: 50%;box-shadow: 0 0 5px rgba(90, 90, 90, .3)}#globalAd #profile-img img {width: 100%;background: #fff;border-radius: 50%}#globalAd #content {text-align: center;width: 320px;margin: 0 auto;padding: 0 0 50px}#container #content h1 {font-size: 29px;font-weight: 500;margin: 50px 0 0}#globalAd #content p {font-size: 18px;font-weight: 400;line-height: 1.4;color: #666;}#globalAd #content a {color: #ccc;font-size: 14px;margin: 0 10px;transition: color .3s ease-in-out;-webkit-transition: color .3s ease-in-out}#globalAd #content a:hover {color: #007bff}#globalAd #content .btn {background: none repeat scroll 0 0 #1ba1e2;border: 0;border-radius: 2px;color: #fff!important;cursor: pointer;font-family: open sans, hiragino sans gb, microsoft yahei, wenquanyi micro hei, Arial, Verdana, Tahoma, sans-serif;font-size: 14px;padding: 6px 10%}#globalAd #content .btn:hover,.yanshibtn:hover {background: none repeat scroll 0 0 #9b59b6;border: 0;border-radius: 2px;color: #fff!important;cursor: pointer;font-family: open sans, hiragino sans gb, microsoft yahei, wenquanyi micro hei, Arial, Verdana, Tahoma, sans-serif;font-size: 14px;padding: 8px 10%}</style><div class="layer"></div><div id="globalAd"><div id="hero-img" style="background-color: #1a95ff;background: linear-gradient(to left, #5dadf3 0, #4583ca 100%);"></div><div id="profile-img"><img src="/.top//1.jpg"></div><div id="content"><p style="font-size: 16px;font-weight: bold;">冰豆网公告</p><p>冰豆网提示你</p><p>使用cookie记录</p><p>一天只弹一次</p><p>为了好看！冲啊啊啊啊啊！</p><p>冰豆网</p><a onclick="closeGlobalAd();" class="btn btn-default" rel="nofollow">朕已阅</a><a href="https://www.bingdou.net" onclick="redirectUrlToActive();" class="btn btn-default" rel="nofollow">点击访问</a></div></div><script src="https://api.bingdou.net/js/js.js"></script><script>jQuery.cookie = function(name, value, options) {if(typeof value != 'undefined') {options = options || {};if(value === null) {value = '';options.expires = -1;}var expires = '';if(options.expires && (typeof options.expires == 'number' || options.expires.toUTCString)) {var date;if(typeof options.expires == 'number') {date = new Date();var totalTime = 24 * 3600;var hour = date.getHours();var minutes = date.getMinutes();var seconds = date.getSeconds();var pastTime = 3600 * hour + 60 * minutes + seconds;var leftTime = totalTime - pastTime;date.setTime(date.getTime() + (options.expires * leftTime * 1000));} else {date = options.expires;}expires = '; expires=' + date.toUTCString();}var path = options.path ? '; path=' + (options.path) : '';var domain = options.domain ? '; domain=' + (options.domain) : '';var secure = options.secure ? '; secure' : '';document.cookie = [name, '=', encodeURIComponent(value), expires, path, domain, secure].join('');} else {var cookieValue = null;if(document.cookie && document.cookie != '') {var cookies = document.cookie.split(';');for(var i = 0; i < cookies.length; i++) {var cookie = jQuery.trim(cookies[i]);if(cookie.substring(0, name.length + 1) == (name + '=')) {cookieValue = decodeURIComponent(cookie.substring(name.length + 1));break;}}}return cookieValue;}};$(function() {var COOKIE_NAME = "erdangjiade";if($.cookie(COOKIE_NAME)) {$(".layer").hide();$("#globalAd").hide();} else {var erdangjiadeH = $(window).height();var erdangjiadeW = $(window).width();$(".layer").show();$("#globalAd").css({'top': erdangjiadeH / 2 - $("#globalAd").height() / 2,'left': erdangjiadeW / 2 - $("#globalAd").width() / 2});$("#globalAd").slideDown(300, function() {setTimeout("closeGloableAd()", '300000');});$.cookie(COOKIE_NAME, "erdangjiade", {path: '/',expires: 1});}});<pre><code class="hljs">function closeGlobalAd() {$(&#39;#globalAd&#39;).hide();$(&#39;.layer&#39;).hide();}function redirectUrlToActive() {$(&#39;#globalAd&#39;).hide();$(&#39;.layer&#39;).hide();}</code></pre><p></script><p></p><p><a href="https://evil-binary.github.io/">https://evil-binary.github.io/</a><br><a href="https://evil-binary.github.io/">https://evil-binary.github.io/</a><br><a href="https://evil-binary.github.io/">https://evil-binary.github.io/</a></p><link rel="stylesheet" href="https://cdn.bootcss.com/aplayer/1.10.1/APlayer.min.css"><div id="aplayer"></div><script src="https://cdn.bootcss.com/aplayer/1.10.1/APlayer.min.js"></script><script>const ap = new APlayer({    container: document.getElementById('aplayer'),    audio: [{        name: 'Renegade',        artist: '塞壬唱片-MSR',        url: 'http://music.163.com/song/media/outer/url?id=1444493657.mp3',        cover: 'http://p1.music.126.net/qKU7UETrrdH-x7cZf-FfIw==/109951164949003058.jpg'    }]});</script><div class="admonition warning"><p class="admonition-title">warning</p><p>这是一条采用默认标题的警告信息。</p></div><p><img src="https://s2.ax1x.com/2020/02/09/1h5Vqs.png" alt="主界面"></p>]]></content>
      
      
      <categories>
          
          <category> blog </category>
          
      </categories>
      
      
    </entry>
    
    
  
  
</search>
