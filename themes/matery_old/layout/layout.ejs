<!DOCTYPE HTML>
<html lang="<%= config.language %>">
    <%- partial('_partial/head') %>

    <body>

        <%- partial('_partial/header') %>
        <%- body %>
        <%- partial('_partial/footer') %>

        <%- partial('_partial/search') %>
        <%- partial('_partial/back-top') %>

        <script src="<%- theme.libs.js.materialize %>"></script>
        <script src="<%- theme.libs.js.masonry %>"></script>
        <script src="<%- theme.libs.js.aos %>"></script>
        <script src="<%- theme.libs.js.scrollProgress %>"></script>

        <!--<script src="<%- theme.libs.js.fancybox %>"></script>-->
        <script src="<%- theme.libs.js.lightgallery %>"></script>

        <script src="<%- theme.libs.js.matery %>"></script>
        <!--与fancybox冲突，慎用<script src="<%- theme.libs.js.instantpage %>"></script>-->

        <%- partial('_partial/google-analytics') %>

        <%- partial('_partial/baidu-analytics') %>

        <% if (theme.clicklove.enable) { %>
            <script src="<%- theme.libs.js.clicklove %>"></script>
        <% } %>

        <% if (theme.busuanziStatistics && theme.busuanziStatistics.enable) { %>
            <script async src="<%- theme.libs.js.busuanzi %>"></script>
        <% } %>
        <script type="text/javascript">
            var OriginTitile = document.title,
                st;
            document.addEventListener("visibilitychange", function () {
                document.hidden ? (document.title = "看不见我~看不见我~", clearTimeout(st)) : (document.title =
                    "(๑•̀ㅂ•́) ✧被发现了～", st = setTimeout(function () {
                        document.title = OriginTitile
                    }, 3e3))
            })
        </script>
        <% if (theme.fireworks.enable) { %>
            <canvas class="fireworks" style="position: fixed; left: 0; top: 0; z-index: 1; pointer-events: none;"></canvas>
            <script type="text/javascript" src="<%- theme.libs.js.animejs %>"></script>
            <script type="text/javascript" src="<%- theme.libs.js.firework %>"></script>
        <% } %>
        <% if (theme.sakura.enable) { %>
            <script type="text/javascript">
            var windowWidth = $(window).width();
            if (windowWidth > 768) {
                document.write('<script type="text/javascript" src="<%- theme.libs.js.sakura %>"><\/script>');
            }
            </script>
        <% } %>

        <% if (theme.wenzi.enable) { %>
            <script src="<%- theme.libs.js.wenzi %>" type="text/javascript"></script>
        <% } %>

        <% if (theme.xuehuapiaoluo.enable) { %>
            <script type="text/javascript">
                var windowWidth = $(window).width();
                if (windowWidth > 768) {
                    document.write('<script type="text/javascript" src="<%- theme.libs.js.xuehuapiaoluo %>"><\/script>');
                }
            </script>
        <% } %>

        <% if (theme.tidio.enable) { %>
            <script src="//code.tidio.co/<%- theme.tidio.public_key %>.js"></script>
            <script> 
                $(document).ready(function () {

                    setInterval(change_Tidio, 50);  
                    function change_Tidio() { 

                        var tidio=$("#tidio-chat iframe");
                        if(tidio.css("display")=="block"&& $(window).width()>977 ){
                            document.getElementById("tidio-chat-iframe").style.bottom= ($("div#backTop.top-scroll").css("display")=="none" &&$(window).width()>977)>0? "-40px" : ($("div.toc-title").length&&$(window).width()>977)>0?"80px":"20px";   
                            document.getElementById("tidio-chat-iframe").style.right="-15px";   
                            document.getElementById("tidio-chat-iframe").style.height=parseInt(tidio.css("height"))>=520?"520px":tidio.css("height");
                            document.getElementById("tidio-chat-iframe").style.zIndex="997";
                        } 
                        else if(tidio.css("display")=="block"&&$(window).width()>601 &&$(window).width()<992 ){
                            document.getElementById("tidio-chat-iframe").style.bottom= ($("div#backTop.top-scroll").css("display")=="none" && 601< $(window).width()<992)>0? "-40px":"20px" ;   
                            document.getElementById("tidio-chat-iframe").style.right="-15px"; 
                            document.getElementById("tidio-chat-iframe").style.zIndex="997";
                        }
                        else if(tidio.css("display")=="block"&&$(window).width()<601 && parseInt(tidio.css("height"))<230){
                            document.getElementById("tidio-chat-iframe").style.bottom= ($("div#backTop.top-scroll").css("display")=="none" && $(window).width()<601)>0? "-10px":"45px" ;   
                            document.getElementById("tidio-chat-iframe").style.zIndex="997";
                        }

                        if( tidio.css("display")=="block"&&$(window).width()<601 && parseInt(tidio.css("height"))>=230){
                            document.getElementById("tidio-chat-iframe").style.zIndex="998";
                        }
                    } 
                }); 
            </script>
        <% } %>

        <% if (theme.canvas_nest.enable) { %>
            <script type="text/javascript">
            var windowWidth = $(window).width();
            if (windowWidth > 992) {
                document.write('<script type="text/javascript" color="<%- theme.canvas_nest.color %>" pointColor="<%- theme.canvas_nest.pointColor %>" opacity= "<%- theme.canvas_nest.opacity %>" zIndex="-<%- theme.canvas_nest.zIndex %>" count="<%- theme.canvas_nest.count %>"src="<%- theme.libs.js.canvas_nest %>"><\/script>');
            }
            </script>
        <% } %>

        <% if (theme.ribbon.enable) { %>
            <script type="text/javascript">
            var windowWidth = $(window).width();
            if (windowWidth > 992) {
                document.write('<script type="text/javascript" size="<%- theme.ribbon.size %>" alpha="<%- theme.ribbon.alpha %>" zIndex="<%- theme.ribbon.zIndex %>" src="<%- theme.libs.js.ribbon %>"><\/script>');
            }
            </script>
        <% } %>

        <% if (theme.ribbon_dynamic.enable) { %>
            <script type="text/javascript">
            var windowWidth = $(window).width();
            if (windowWidth > 992) {
                document.write('<script type="text/javascript" src="<%- theme.libs.js.ribbon_dynamic %>"><\/script>');
            }
            </script>

        <% } %>

    </body>
</html>